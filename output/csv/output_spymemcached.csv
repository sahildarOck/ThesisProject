revision_num,change_id,url,iteration_count,before_commit_id,after_commit_id,at_least_one_updated_java_file,T(created),T(merged),LOC changed,subject,message,cr_smell_lack_of_cr,cr_smell_ping_pong,cr_smell_sleeping_reviews,cr_smell_missing_context,cr_smell_large_changesets,cr_smell_review_buddies,at_least_one_cr_smell,code_smells_difference_count,is_increased,
25,I0d275a824017865714af23abbb0eb61418d5d116,http://review.couchbase.org/#/c/25,4,5d165c55aadfc3b05b374faf65f26edc361f9715,8779771d7e6a113573b491e4aaa5ea4cd2f2196c,1,07/05/10,27/05/10,102,Move continuous timeout counter to individual connections.,Move continuous timeout counter to individual connections.,0,1,1,1,0,0,1,1,1,
269,I68fc5e9dea99a25e708808f14c8d0a58bd314336,http://review.couchbase.org/#/c/269,1,8779771d7e6a113573b491e4aaa5ea4cd2f2196c,6ebf25ebf68ca8b325be29ea6a0ae862301863cb,1,02/06/10,02/06/10,3,"Use a private static final byte array for ""\r\n"" instead of always converting the string into a byte array.","Use a private static final byte array for ""\r\n"" instead of always
converting the string into a byte array.",0,0,0,1,0,0,1,0,0,
290,I214f4fe0edb07c821f139b61526a2547d9772324,http://review.couchbase.org/#/c/290,1,a8e35f9442b887e3277a85dd552fd8e59d89af70,1d95ff114cac9622765b64239097b3e38ab1ed91,1,03/06/10,03/06/10,1,No need to call MessageDigest#reset() on a brand new MessageDigest.,"No need to call MessageDigest#reset() on a brand new MessageDigest.

Change-Id: I214f4fe0edb07c821f139b61526a2547d9772324",0,0,0,1,0,0,1,0,0,
292,If72e112e93014631767ed68d758728f372e9a7d8,http://review.couchbase.org/#/c/292,2,1d95ff114cac9622765b64239097b3e38ab1ed91,e12f90f541b5ae34a9c49b40ab49ddca79b7b479,1,04/06/10,08/06/10,16,It is faster to clone an existing MD5 MessageDigest that has never been updated than it is to get a fresh one using MessageDigest.getInstance().,"It is faster to clone an existing MD5 MessageDigest that
has never been updated than it is to get a fresh one using
MessageDigest.getInstance().

Change-Id: If72e112e93014631767ed68d758728f372e9a7d8",0,0,1,1,0,0,1,0,0,
416,Ibdbbf79455c2e497ae7e121bd88a4f260e24fa54,http://review.couchbase.org/#/c/416,1,e12f90f541b5ae34a9c49b40ab49ddca79b7b479,0a4d82b2282937f1d116c7958afc52e90fe5dbed,1,12/06/10,12/06/10,4,Delete a duplicate unit test.,"Delete a duplicate unit test.

Change-Id: Ibdbbf79455c2e497ae7e121bd88a4f260e24fa54",0,0,0,1,0,0,1,0,0,
561,I34921695bec8bea5f4b8b0bace13951a41b3230a,http://review.couchbase.org/#/c/561,1,0a4d82b2282937f1d116c7958afc52e90fe5dbed,15251dcd9f2f7259bb64a7ccc1c3a2a7091ae726,1,15/06/10,15/06/10,4,Fix compilation with JDK 1.5.,"Fix compilation with JDK 1.5.

Don't use methods and enum's that only exist in JDK 1.6.

The changes successfully compile and the unit tests pass with JDK 1.6,
but with 1.5 I consistently get a unit test failure here:

    [junit] Testcase: testSimpleLoading took 0.265 sec
    [junit] 	      Caused an ERROR
    [junit] java.lang.RuntimeException: blah
    [junit] java.util.concurrent.ExecutionException: java.lang.RuntimeException: blah
    [junit] 					     at net.spy.memcached.internal.ImmediateFuture.<init>(ImmediateFuture.java:25)
    [junit] 					     at net.spy.memcached.util.CacheLoaderTest.testSimpleLoading(CacheLoaderTest.java:48)
    [junit] 					     at org.jmock.core.VerifyingTestCase.runBare(VerifyingTestCase.java:39)
    [junit] Caused by: java.lang.RuntimeException: blah
    [junit]
    [junit] TEST net.spy.memcached.util.CacheLoaderTest FAILED
    [junit] Tests FAILED
The following tests failed:
net.spy.memcached.util.CacheLoaderTest

Change-Id: I34921695bec8bea5f4b8b0bace13951a41b3230a",0,0,0,0,0,0,0,0,0,
563,I3bac849cee69fd6b57b20139832193b97975f6f6,http://review.couchbase.org/#/c/563,4,39578c6f0cf2348a8eea477c772e79836e17459e,94d3535364dd4303c8afbef4f4712e385ee30a65,1,15/06/10,16/06/10,180,support for getSome,support for getSome,0,1,0,1,0,0,1,0,0,
630,I54930eb03f5c07fc6966f8d4d5db42548c63f6bd,http://review.couchbase.org/#/c/630,5,365bd65f05617f5d3c502e864beff822ba8a5d76,09573f87f51ba0fdea112590da6618668d15beac,1,17/06/10,17/06/10,18,plug potential file descriptor leak,"plug potential file descriptor leak

There is a problem in open/connect sequence that may produce file descriptor leaks in some abnormal conditions:
First, SocketChannel.open() is called, then ch.connect(a.getSocketAddress()) is called and it may throw an IOException under certain conditions.
Then we catch exception and re-queue the node. This will produce a leak since the channel was not closed.
	The problem surfaced because of some faulty changes that I made and which I fixed. But it's nevertheless a problem.
This is the Sun  bug reference. http://bugs.sun.com/view_bug.do?bug_id=6548464
They fixed it in a helper method that opens/connects in a single call. But in our case the client needs to take care of it.

One more small unrelated change is to catch and unchecked exception and log an error:
it is a serious case because the node will be essentially lost and never re-queued.",0,1,0,0,0,0,1,1,1,
919,I7e0f74da72214cbe4c72cd693ee11461138f172b,http://review.couchbase.org/#/c/919,1,5f4ee1902db1e5996e114f79a6b2f9dbd3f2dd1e,ba4f9553ea0e60ac537ef3206135c5a57f9ca844,1,26/06/10,26/06/10,14,Some minor fixes to make eclipse happy with the code again.,"Some minor fixes to make eclipse happy with the code again.

- Removed @Override annotations where there are no overrides.
- Renamed a couple of variables that were shadowing fields.",1,0,0,0,0,0,1,0,0,
920,I28b58a9e1832abedfd8e4177bb38e5cdac158bcb,http://review.couchbase.org/#/c/920,1,ba4f9553ea0e60ac537ef3206135c5a57f9ca844,ba10e69e724263df62872bada39751650f3f42fb,1,26/06/10,26/06/10,39,Support daemon mode for TranscodeService threads.,"Support daemon mode for TranscodeService threads.

Change-Id: I28b58a9e1832abedfd8e4177bb38e5cdac158bcb",1,0,0,1,0,0,1,0,0,
935,Ica58e45f3e0e49a72c7a7a8743bf9180ea9cb7ed,http://review.couchbase.org/#/c/935,1,ba10e69e724263df62872bada39751650f3f42fb,2ebb064795f88f42f1dada9359bcf07ba4c2fd0a,1,28/06/10,30/06/10,67,Add an iterator that returns a single element forever.,"Add an iterator that returns a single element forever.

This iterator will be used to add a version of asyncGetBulk() that
allows per-key transcoders to be used.  To efficiently allow the
normal use of multiple keys with a single transcoder, instead of
creating an array or list of identical transcoders, other
asyncGetBulk() methods will create a SingleElementInfiniteIterator
instead.

Change-Id: Ica58e45f3e0e49a72c7a7a8743bf9180ea9cb7ed",0,0,0,0,0,0,0,0,0,
936,Ie4697bc3f9923e7c2ba981ca334b0df9d1ab7315,http://review.couchbase.org/#/c/936,1,2ebb064795f88f42f1dada9359bcf07ba4c2fd0a,c6889c15ae43a670a15661374277e79977ccc4ef,1,28/06/10,30/06/10,134,Allow per-key transcoders to be used with asyncGetBulk().,"Allow per-key transcoders to be used with asyncGetBulk().

This change allows the transcoder to save state for each key.  An
example is shown in the unit test that encodes into the byte array
sent to the memcached server the key along with the value.  Upon
decoding a value from memcached, the actual and expected keys are
compared.

Change-Id: Ie4697bc3f9923e7c2ba981ca334b0df9d1ab7315",0,0,0,0,0,0,0,1,1,
999,Ic0e3d14c8d7ff7001c3440683fa4274b119e4d31,http://review.couchbase.org/#/c/999,2,0f20e20f3a9c78ba6982502b283365a05754af7d,18f7c34606bfc33d7b61a3f9cb16f1b41b1f4436,1,01/07/10,18/07/10,57,support timeout based disconnects for bulk ops,"support timeout based disconnects for bulk ops

Refactored some repeating logic into helper methods,
track continuous timeouts from bulk operations,
log at warning.",0,0,1,0,0,0,1,-1,0,
3640,If1db3a8578e2d8603e0c6dbbe781ed7258908eee,http://review.couchbase.org/#/c/3640,1,3a1c031a9c8df1adb1997f4a92aa1749967c3e94,8177a4ffb94e0b934dfc0919ef279d90beb92093,1,12/11/10,07/01/11,2,Minor performance improvement for bulk gets.,"Minor performance improvement for bulk gets.

If the size of an ArrayList is known before construction, then pass
the size to the constructor.  This will either save a tiny bit of
memory or save reallocation's, depending upon the number of elements
that will be inserted into the ArrayList.

Change-Id: If1db3a8578e2d8603e0c6dbbe781ed7258908eee",0,0,0,0,0,0,0,0,0,
3641,Ibd3638e574f9bd0c0928af5bada53de72a59e9f1,http://review.couchbase.org/#/c/3641,2,472fd3866bcf82abea2a10f3e2769fdc6a549b8b,cefc42a8b440304d33f64ae3838c2259f7e5baf6,1,12/11/10,09/01/11,4,Tiny performance improvement.,"Tiny performance improvement.

It's OK to have the method return an interface, but use the concrete
class name in the method so it doesn't need to invoke the methods
through the interface.

Change-Id: Ibd3638e574f9bd0c0928af5bada53de72a59e9f1",0,0,0,0,0,0,0,0,0,
4204,I60228433bfa121ed031dd81fc05a9d65cae5bf20,http://review.couchbase.org/#/c/4204,6,51b6024f11295e47e79d8ddccab2e0f223b1df5b,0a48855ca547d9b57350c7a80f8ffe002b491210,1,03/01/11,10/01/11,107,Do not write timedout operations to the MemcachedNode.,"Do not write timedout operations to the MemcachedNode.

This commit and related ones add support to an operation to
have new methods and a state of TIMEDOUT.  The intent is to
keep track of when an operation is created and if it either
times out due to a latch timeout expiration or it is found
to be already too old when thinking about sending the op
to the network, just consider it timed out then and there.

Note, object creation time is actually possibly quite a bit
after when the request is made, depending on how that request
is made.  Any number of things could have happened in
between with GC, JIT, scheduling, etc.

Change-Id: I60228433bfa121ed031dd81fc05a9d65cae5bf20",0,1,1,0,0,1,1,2,1,
4206,Ic1344ef2df2ab0ba4c03b4e401a4f98436a39772,http://review.couchbase.org/#/c/4206,6,c2f67252f14cdcf7b8361ba904a220d3cb6f04f1,67221c24c5f95be63cbafb79db1dac00d5bf7a09,1,03/01/11,10/01/11,2,Recognize operation may be null at times.  e.g.: flush,"Recognize operation may be null at times.  e.g.: flush

Both the timeout changes from myself and some of the continuious timeout
changes from Boris assumed there would always be an operation.  In
some cases, like flush, that is not necessarily the case.

Looking at the existing code, there were lots of guards against null
access already, so I just continued that tradition.

The tradition may need to be broken though in the future.

Change-Id: Ic1344ef2df2ab0ba4c03b4e401a4f98436a39772",0,1,1,0,0,1,1,0,0,
4207,Ie53ca774458466d9a2e6f70e65ea6663699a9f6f,http://review.couchbase.org/#/c/4207,6,23069ca35238c9edd3495ae62e80fd452a66a41b,2bf29f376e1f16960fde84e63775935e55331b08,1,03/01/11,10/01/11,2,Increased default timeout to 2500ms.,"Increased default timeout to 2500ms.

The increase of the timeout to this seemingly high value is due to
a few findings.

First, by default, garbage collection times may easily go over 1sec.
Testing with simple toy tests shows this quite clearly, even on
systems with lots of CPUs and a decent amount of memory.  Of course,
much of this can be controlled with GC tuning on the JVM.  With the
hotspot JVM, look to this whitepaper:
http://java.sun.com/j2se/reference/whitepapers/memorymanagement_whitepaper.pdf

Testing showed the following to be particularly useful:
-XX:+UseConcMarkSweepGC -XX:MaxGCPauseMillis=850

There is a CPU time tradeoff for this.

Even with these, testing showed some 1 second timeouts when GCs near a
half a second.  To use this software though, we shouldn't expect people
to have to tune the GC, so raising the default seems like the
right thing to do.

Second, many systems use spymemcached on virtualized or cloud environments.
The processes running there do not have any guarantee of execution
time.  It'd be really unlikely for a thread to be starved for more than
a second, but it is possible and shouldn't make things stop.  Raising this
a bit will help.

Third, and perhaps most importantly, most people run applications on
networks that do not offer any guarantee around response time.  If
the network is oversubscribed or even minor blips occur on the network
can cause TCP retransmissions.  While many TCP implementations ignore
it, RFC 2988 specifies rounding up to 1sec when calculating
TCP retransmit timeouts.  Blips will occur, and rather than force
this seemingly synchronous get to timeout, it may be better to
just wait a bit longer by default.

Change-Id: Ie53ca774458466d9a2e6f70e65ea6663699a9f6f",0,1,1,0,0,1,1,0,0,
4208,I81530461187509026cc18e995b3ceddcc3c76afb,http://review.couchbase.org/#/c/4208,6,222724ac6ee2d4895ef603bb1c0aa690bbdf1d9a,9babe2c4153aba1c80721eb020a30a4cc5ac60b5,1,03/01/11,10/01/11,90,Test for timeout from operation epoch.,"Test for timeout from operation epoch.

Change-Id: I81530461187509026cc18e995b3ceddcc3c76afb",0,1,1,1,0,1,1,0,0,
4209,I4d9a13f55ec0c15ebb07c924584aa33492a57a12,http://review.couchbase.org/#/c/4209,6,ac16c99e48ed0dabed5875ddbdc7240eadeb44cb,7360f1931a9a023b6868e7be85311365c35964e7,0,03/01/11,10/01/11,16,Fix for stats sizes test.,"Fix for stats sizes test.

Change-Id: I4d9a13f55ec0c15ebb07c924584aa33492a57a12",0,1,1,1,0,1,1,NA,NA,
4210,I81473b25cfd4aa73c8c4473c1f337338162a0222,http://review.couchbase.org/#/c/4210,6,861602e1b009dfd30a540a92f9908172a3811c98,13c55ad3f5f87e76b10aa3361ce421e17fcdb452,1,03/01/11,10/01/11,4,Test fixes after adding new timeout logic.,"Test fixes after adding new timeout logic.

Several tests were expecting things to happen within 1ms,
which is too short.  The new timeout functionality made these
tests fail, where before they'd pass.

Change-Id: I81473b25cfd4aa73c8c4473c1f337338162a0222",0,1,1,0,0,1,1,0,0,
4211,If1fbe77aa02f7cacabca91915927bf7b5e086284,http://review.couchbase.org/#/c/4211,6,4aeca26039b54e80fcce0ba94d3b1eeb933d63b2,d2701b0ac6f0ef7ce4e9e0dc3da7f6b26641824c,0,03/01/11,10/01/11,49,Fixes to testSyncGetTimeouts.,"Fixes to testSyncGetTimeouts.

Previous to enforcing the timeouts at an operation level, this test
would pass.  In fact, Dustin said the test had never failed before.

However, it turns out that the really short default timeouts would
be too short and not waiting a bit after encountering a timeout would
still see timeouts.

Change-Id: If1fbe77aa02f7cacabca91915927bf7b5e086284",0,1,1,0,0,1,1,NA,NA,
4212,Ia02b5bf6a91cf987dae3fc9faf02a41751653773,http://review.couchbase.org/#/c/4212,6,ad4b220657561c6823960a6472c86b520e766748,0a8e4d646b2c0955ae97875ace314b0a5443d429,1,03/01/11,10/01/11,16,Add a TIMEDOUT state to ops and make callbacks correct.,"Add a TIMEDOUT state to ops and make callbacks correct.

There would be some situations where the latch would not expire
due to the callback not having been called.  Callbacks were
typically called on state transition for the operation, so I
thought it appropriate to add a TIMEDOUT state.

Change-Id: Ia02b5bf6a91cf987dae3fc9faf02a41751653773",0,1,1,0,0,1,1,0,0,
4231,I54bdc264566684208e5273ce51d56f38d14be852,http://review.couchbase.org/#/c/4231,1,5e9cd8d21565759b1c1fcf21e21fee0a9f648d8f,891e5e8a41d76ef9020399939b01dbb0ada2b2d6,1,10/01/11,11/01/11,5,Some import cleanups.,"Some import cleanups.

Change-Id: I54bdc264566684208e5273ce51d56f38d14be852",0,0,0,1,0,0,1,0,0,
4232,I2bedcea366bca83597cc9863da9c63a9966eeee9,http://review.couchbase.org/#/c/4232,1,891e5e8a41d76ef9020399939b01dbb0ada2b2d6,cc8742ed121af92acd9d226073975e0fd9b2d565,1,10/01/11,11/01/11,4,Avoid potential NPE as reported by eclipse.,"Avoid potential NPE as reported by eclipse.

Change-Id: I2bedcea366bca83597cc9863da9c63a9966eeee9",0,0,0,1,0,0,1,0,0,
4248,Ie64aa5bedcbe36b4717c17750a63a08a7de1f12e,http://review.couchbase.org/#/c/4248,1,cc8742ed121af92acd9d226073975e0fd9b2d565,dc7abe1f77e1e3843dc44136ab9dfbbf31b91ad3,0,12/01/11,12/01/11,8,Catch RuntimeException instead.,"Catch RuntimeException instead.

Timeouts from the get() without a time value specified will return
simply a RuntimeException, while those from calling the get() with
a time value can receive a TimeoutException.

This also removes some debugging traces that were left in
unfortunate places which could also cause test failures.

Change-Id: Ie64aa5bedcbe36b4717c17750a63a08a7de1f12e",0,0,0,0,0,1,1,NA,NA,
4612,Ia097e245b5be75926165c4e482a86c92a80b5fa0,http://review.couchbase.org/#/c/4612,3,dc7abe1f77e1e3843dc44136ab9dfbbf31b91ad3,a98e571a165a78b6d52cc733c41ed99ad8ae29b2,1,17/02/11,02/03/11,4,Changed transcoder logging to more appropriate defaults.,"Changed transcoder logging to more appropriate defaults.

Change-Id: Ia097e245b5be75926165c4e482a86c92a80b5fa0",0,0,0,1,0,1,1,0,0,
4752,Ib4051608631d976487ab8114083f6d32d35258a7,http://review.couchbase.org/#/c/4752,3,e42a4403e32637eb7a6e7670c718b61bd4044718,184d2cac5852e713e332031ecbf3c5b77ece7dfb,1,28/02/11,07/03/11,186,Added a Spring FactoryBean for simplifying MemcachedClient creation in a Spring applications. This is a patch for http://code.google.com/p/spymemcached/issues/detail?id=164,"Added a Spring FactoryBean for simplifying MemcachedClient creation in a Spring applications. This is a patch for http://code.google.com/p/spymemcached/issues/detail?id=164

Change-Id: Ib4051608631d976487ab8114083f6d32d35258a7",0,0,0,1,0,0,1,0,0,
5201,I7f4eece7d52638c92b305b0f2af35c458e57b0d3,http://review.couchbase.org/#/c/5201,2,b95a2f179f1bee0e497c7700b3e4fd4d1d5047ed,be17f8baf6f7feed30ecd7b0fdda342103247e81,1,04/04/11,19/04/11,2,Warn when redistribute cannot find another node.,"Warn when redistribute cannot find another node.

Change-Id: I7f4eece7d52638c92b305b0f2af35c458e57b0d3",0,0,1,1,0,0,1,0,0,
5202,Ie1b2deffd89e778f5ac0ec4762e73fe5b852f66a,http://review.couchbase.org/#/c/5202,2,4793b58f0c514c6c359294608ceb01f0bcac7eba,2d73dd15ca23fe2b325536ef6f3254af86dfdebf,1,04/04/11,19/04/11,2,Fixed small log typo.,"Fixed small log typo.

Change-Id: Ie1b2deffd89e778f5ac0ec4762e73fe5b852f66a",0,0,1,1,0,0,1,0,0,
5203,If32de603bdb597db993a22b47ffbe3367e566488,http://review.couchbase.org/#/c/5203,2,118acf5f03a14884d32bc68d16dc936b19240211,1c1dac6eb6fbf1a36b70c5774958d1a7ab8f22c5,1,04/04/11,19/04/11,18,Added ability to see if op unsent but timedout.,"Added ability to see if op unsent but timedout.

Change-Id: If32de603bdb597db993a22b47ffbe3367e566488",0,0,1,1,0,0,1,0,0,
5204,Ie7256580316f08f7bff676525cead3dd872878e1,http://review.couchbase.org/#/c/5204,2,f2727bf60114476d490332586db7d9752439a6b3,174c13226f98b223c3e5224f10e57300e6db6371,1,04/04/11,19/04/11,2,Fixed minor comment formatting.,"Fixed minor comment formatting.

Change-Id: Ie7256580316f08f7bff676525cead3dd872878e1",0,0,1,1,0,0,1,0,0,
5205,Ibac73fa9816855976b80fd7248b63f36eb2c1b44,http://review.couchbase.org/#/c/5205,2,13eeadd299cf777e5ae83cf33778bd987f1fdee0,e8b2ec7fe24fc5a95e1f72b9f169d44cd27472fd,1,04/04/11,19/04/11,16,Fixed cancellation issue.,"Fixed cancellation issue.

It was found that an operation which had been canceled would
block the rest of the queue from being processed.  This needs
to be removed from the queue so the other data may flow.

Change-Id: Ibac73fa9816855976b80fd7248b63f36eb2c1b44",0,0,1,0,0,0,1,0,0,
5206,I0c8102bf737226c054662b043661ec97907a283b,http://review.couchbase.org/#/c/5206,2,607d09a44323e713e17a93122c216af4377e3b7d,3c97a4a5ca9333d1d3e42145b1bfa199853611cd,1,04/04/11,22/04/11,214,Separate the KetamaIterator for future dynamic configuration.,"Separate the KetamaIterator for future dynamic configuration.

Some future implementations may want to have dynamic changes to
the nodes list, so the KetamaIterator has been refactored to its
own class so it can be replaced while a client is instantiated.

Change-Id: I0c8102bf737226c054662b043661ec97907a283b",0,0,1,0,0,1,1,0,0,
5207,I6fa52c0b02516b68ca8da26e4fd85bb1730b82b2,http://review.couchbase.org/#/c/5207,2,12c3c0b506d1915ef51da74dd9b9943615f7ddde,3f6d27c946077ee2c5e9882cfd0d2e2f13bae086,1,04/04/11,22/04/11,18,Search more with the KetamaIterator.,"Search more with the KetamaIterator.

The existing KetamaIterator implementation, with a small number
of nodes, may actually hit the same down node multiple times in
a row leading to failing to find a node when it should find
another one.

The original libketama[1] hashes each server to 160 numeric
values.  These are spread out in a 64-bit value.  The key is
then hashed to a numeric value within that 64-bit value and
walked forward until it finds a server.

Previously, this library's ketama implementation would only look
in the consistent hash for a number of iterations limited by the
number of servers.  With two servers (similar to flipping a
coin, you'd get heads twice in a row sometimes) you would have
a 1 in 4 chance of picking the same dead server twice.

The new implementation will iterate based on the number of
servers, but attempts to keep the probability of hitting the
same dead server to less than 1% for a two node configuration.
This will guarantee less than 1% possibility with two or more
servers.

Because we iterate by simply appending the number of tries on
the front of the key, we'll be quite random about where in
the continuium we hit.  Each selection is rather random, but
for a set of results already calculated, half of which are
alive and half of which are dead, we can say that in seven
iterations, there is only a 1/128 [1/(2^7)] chance that we
would not select once at least one alive server.  The
probability for any given test still 1/2, but we can describe
the probability of the iterations.  The key info on this came
from the ""gambler's fallacy""[2].

1. https://github.com/RJ/ketama/blob/master/libketama/ketama.c
2. http://en.wikipedia.org/wiki/Gambler's_fallacy

Other references:
http://answers.google.com/answers/threadview/id/568615.html
http://en.wikipedia.org/wiki/Combinations

Change-Id: I6fa52c0b02516b68ca8da26e4fd85bb1730b82b2",0,0,1,0,0,1,1,0,0,
5502,If1ba6292d78e389cdd83a191bb65c88e31e49886,http://review.couchbase.org/#/c/5502,1,3f6d27c946077ee2c5e9882cfd0d2e2f13bae086,451a40f83646f528859fb6f337359c8be50e4d2d,1,19/04/11,22/04/11,5,Increase the maximum size allowed.  Issue 106.,"Increase the maximum size allowed.  Issue 106.

Though memcached still has a 1MiB size by default (overridable
with a flag), other engines may have their own maximum.  Membase
for instance has a 20MiB maximum.

At least for the remainder of the 2.6 series, rather than do
deep surgery on this issue, just bump up the maximum.

Change-Id: If1ba6292d78e389cdd83a191bb65c88e31e49886",0,0,1,0,0,1,1,0,0,
6074,I3e7bb000b12a63b4a299cb8b79a3151fbfc91615,http://review.couchbase.org/#/c/6074,1,bd67045a9637e7cd92b58db2c2e90c7835aaacf9,475bb2c2df03976f5ba31fb79593f1839354e159,1,08/05/11,10/05/11,10,Increase the maximum size allowed.  Issue 106.,"Increase the maximum size allowed.  Issue 106.

Though memcached still has a 1MiB size by default (overridable
with a flag), other engines may have their own maximum.  Membase
for instance has a 20MiB maximum.

Note that the size enforced by the transcoder can be overridden
through it's ctor.  The reason for making this change is to
create a new, larger default.

At least for the remainder of the 2.6 series, rather than do
deep surgery on this issue, just bump up the maximum.

Change-Id: I3e7bb000b12a63b4a299cb8b79a3151fbfc91615",0,0,0,0,0,1,1,0,0,
6091,I2244a24a051b1b90e4142fa01785ae7e095ed87f,http://review.couchbase.org/#/c/6091,1,9c314aa490a5a0757977c8da878b53593b30d430,a2de928ef052d2bd262482bcdba6900b04c365d3,1,09/05/11,11/05/11,6,"Do not use generics with Spring Factory Bean, be 2.5 compatible.","Do not use generics with Spring Factory Bean, be 2.5 compatible.

To be backward compatible with Spring 2.5, the Factory Bean should
avoid the use of generics.

Change-Id: I2244a24a051b1b90e4142fa01785ae7e095ed87f",0,0,0,0,0,1,1,0,0,
6151,Ic3cddeedb76ce096569a34e3d8024be06bd4bd62,http://review.couchbase.org/#/c/6151,1,1f95ec65ee0de12acbaa61633ef2c0529b43077d,1a641e5bd992e8ce13fc724bde6ebe311d2c69e1,1,11/05/11,11/05/11,5,Compilation fix after spring de-generification.,"Compilation fix after spring de-generification.

Change-Id: Ic3cddeedb76ce096569a34e3d8024be06bd4bd62",0,0,0,1,0,0,1,0,0,
6152,I295d7b6b301217866f1074c526cdeba6d60420ab,http://review.couchbase.org/#/c/6152,1,1a641e5bd992e8ce13fc724bde6ebe311d2c69e1,2cab9455f2ff6e92220b6b0be3aecbcbb1641f95,1,11/05/11,11/05/11,9,Removed a bit of dead test code.,"Removed a bit of dead test code.

Change-Id: I295d7b6b301217866f1074c526cdeba6d60420ab",0,0,0,1,0,0,1,0,0,
6208,Iee37db23f4a5d02328f8dc62253a87895857f59d,http://review.couchbase.org/#/c/6208,1,2cab9455f2ff6e92220b6b0be3aecbcbb1641f95,43b0942736e54fb0fde25be5ccc6daf9291820db,0,13/05/11,18/05/11,10,Buildfile changes to support Maven 2 artifact upload.,"Buildfile changes to support Maven 2 artifact upload.

This build file change slightly redefines the artifacts from
memcached to spymemcached.  This feels right to me.

I've tested the resulting upload with both NetBeans and Eclipse
Maven support.  I can tell war stories later.

Change-Id: Iee37db23f4a5d02328f8dc62253a87895857f59d",0,0,1,0,0,0,1,NA,NA,
6671,I8771917e47fd146a371ba33bed7b0ca31cfcbff1,http://review.couchbase.org/#/c/6671,11,84c9cd7206f5fdcdb04205657f3fedacd97b4a1e,2b010d3c70f56dc5b20b893155bd541f53c26a8b,1,31/05/11,03/06/11,463,Integrated jvbucket,"Integrated jvbucket

Added jvbucket 1.0 classes to the project

Change-Id: I8771917e47fd146a371ba33bed7b0ca31cfcbff1",0,1,0,0,0,1,1,1,1,
6672,I478b274e7901e8c1729c20fcc29577b8aff651af,http://review.couchbase.org/#/c/6672,8,fceb3ad2dc7ae782c9a4aab2dbc7f26a183f8958,428a75fe29dc97e14372ff667838e9eb9027b916,1,31/05/11,08/06/11,518,Added vbucket configuration parser from JSON.,"Added vbucket configuration parser from JSON.

This parser from JSON has several methods for parsing JSON, beans to
store configuration settings and unit tests.

Change-Id: I478b274e7901e8c1729c20fcc29577b8aff651af",0,1,0,0,1,1,1,4,1,
6673,I2fabbb02c298fd3d9c3b32c71d9b69b2a0123c7a,http://review.couchbase.org/#/c/6673,5,9214a8180f7227be970049416c83f465aa75704c,c1da6bd4894d71d4f756a75df2e581807b4bc2f0,1,31/05/11,08/06/11,45,"If it is membase, do not test some things.","If it is membase, do not test some things.

Change-Id: I2fabbb02c298fd3d9c3b32c71d9b69b2a0123c7a",0,1,0,1,0,1,1,0,0,
6674,I92472a89f15b9fdbe9725f8a9a4abb2d645a591c,http://review.couchbase.org/#/c/6674,6,8402985bdf145c07edadb326256bb78cab117ecd,41467ce0eef34c62dcaef73a29428893871430b3,1,31/05/11,08/06/11,648,Added bucket monitor with response handler.,"Added bucket monitor with response handler.

This adds a Bucket monitor with a response handler based on the netty
framework to read bucket's streaming channel. It passes the received
configuration to registered observers.

Change-Id: I92472a89f15b9fdbe9725f8a9a4abb2d645a591c",0,1,0,0,1,1,1,0,0,
6751,I8099dd7c85a45c81667e3a566995995dd3780b32,http://review.couchbase.org/#/c/6751,1,121b82f99ed7aea7a4a6e5a0859fa84952a3f8c2,15a481cecd1ece34c78852d1b9b61263c73bf5fe,1,03/06/11,03/06/11,9,Added TEMP_FAIL handling to set operations,"Added TEMP_FAIL handling to set operations

TMP_FAIL is sent to the client when the server is out of memory.
The current way of handling this error is to reconnect, but this
is no the correct way to handle a this error since the server will
be available soon.

There are other commands that should handle this as well, but right
now I am only submitting a fix for the set operation since this is
the operration that causes this error most frequently. We plan on
adding support for all known Membase commands in a future release.

Change-Id: I8099dd7c85a45c81667e3a566995995dd3780b32",0,0,0,0,0,1,1,0,0,
6753,Iee3045bdb58142dd44c9e8c723dffe7abdbcb230,http://review.couchbase.org/#/c/6753,11,15a481cecd1ece34c78852d1b9b61263c73bf5fe,77eafa3094fc10b31e4508e1b4a63421dc53d6d3,1,03/06/11,04/06/11,120,Added touch operation,"Added touch operation

Added an operation to reset the expiration time of a key. I have
tested this code thoughly and will check in the unit tests in a
later commit.

Change-Id: Iee3045bdb58142dd44c9e8c723dffe7abdbcb230",0,1,0,0,0,1,1,0,0,
6760,I202aa38d5c600f1e40febca02f303398a4600977,http://review.couchbase.org/#/c/6760,6,ed3753fd330f842428d3f96d2cec17bf2c030e65,ab1d255915085960458575e191fa967d04938fd7,1,04/06/11,08/06/11,4757,Add a configuration provider for bucket updates.,"Add a configuration provider for bucket updates.

Change-Id: I202aa38d5c600f1e40febca02f303398a4600977",0,1,1,1,1,1,1,-1,0,
6778,I9859d8e3752c519bd0bcf67009a0a3999f5cbbf2,http://review.couchbase.org/#/c/6778,7,5f1d63d2c02ec8227a1ffc071fc0bef0d89dd9d2,02df870ac33062527330bf6accbfba7c40ddfb98,1,05/06/11,06/06/11,246,Added getl operation,"Added getl operation

Getl works with both ascii and binary. Unit test will be added in a future commit
but this code has been tested thoughly.

Change-Id: I9859d8e3752c519bd0bcf67009a0a3999f5cbbf2",0,1,0,0,0,1,1,0,0,
6813,I3c65741325aaf979fa55043fb1f0d114e75c1471,http://review.couchbase.org/#/c/6813,7,02df870ac33062527330bf6accbfba7c40ddfb98,93c456b791e3c3e3a7cbafb0d966d43ccc89d4d8,1,06/06/11,07/06/11,190,Added Gat Command,"Added Gat Command

The gat allows the user to get a keys value and reset its
expiration. Unit tests will come later.

Change-Id: I3c65741325aaf979fa55043fb1f0d114e75c1471",0,1,0,0,0,1,1,0,0,
6814,I2a64540f6baa711f80af6e2419c30829c6876af8,http://review.couchbase.org/#/c/6814,4,6b07cecb3680f0114fef1762f24bc61617a74256,9b475015ebecc989a93adf30a011c8a0fa2b27fe,1,06/06/11,08/06/11,214,"Added VbucketNodeLocator, keyed operation handling.","Added VbucketNodeLocator, keyed operation handling.

Change-Id: I2a64540f6baa711f80af6e2419c30829c6876af8",0,1,0,1,0,1,1,1,1,
6815,I745ed511aac4af5fbc40244aa5cb8e607cf05f91,http://review.couchbase.org/#/c/6815,5,fdacb1c7abd2389feb0003eef4cfcc800b8745fd,5c560de656e05fe384eeb55a8ea4537c7aa2d087,1,06/06/11,08/06/11,252,Allow MemcachedClient and connections to be reconfigurable.,"Allow MemcachedClient and connections to be reconfigurable.

Change-Id: I745ed511aac4af5fbc40244aa5cb8e607cf05f91",0,1,0,1,0,1,1,1,1,
6816,I572375de9f43de1da1a7681206decdf8fcc7f5fc,http://review.couchbase.org/#/c/6816,5,aecb7dc8da45595407c15125ad1597d75e65e0c9,762ecda8c201c6f9fc6ef154d72dadbc2a230a31,1,06/06/11,08/06/11,3,Set the status when receiving ERR_NOT_MY_VBUCKET.,"Set the status when receiving ERR_NOT_MY_VBUCKET.

Change-Id: I572375de9f43de1da1a7681206decdf8fcc7f5fc",0,1,0,1,0,1,1,0,0,
6853,Ic729a3a12b05657bf338cbca0f5a9e173e71ce77,http://review.couchbase.org/#/c/6853,1,9632693f512fd9771cd5b2bad45758c93ce6107d,df5a09f720602024a252ae89ff1cb9ac00c897f5,0,08/06/11,08/06/11,5,Fixed .classpath file to include all dependencies,"Fixed .classpath file to include all dependencies

Change-Id: Ic729a3a12b05657bf338cbca0f5a9e173e71ce77",0,0,0,1,0,1,1,NA,NA,
6854,I6c51f1407ebdd5858ffd9342113899c56473408e,http://review.couchbase.org/#/c/6854,1,df5a09f720602024a252ae89ff1cb9ac00c897f5,5dfc8a8b55c21587c9a0648c0613665bfd2ced67,1,08/06/11,08/06/11,237,Bugfixing of NOT_MY_VBUCKET handling,"Bugfixing of NOT_MY_VBUCKET handling

Added a collection of nodes that returned NOT_MY_VBUCKET to the operation.
Changed OperationFactory clone method to copy that collection.
Correct setting of NOT_MY_VBUCKET status for operation implementations.
Added getAlternative method in node locator to be called in Retry case.
Added unit test for getAlternative method

Change-Id: I6c51f1407ebdd5858ffd9342113899c56473408e",0,0,0,0,0,0,0,1,1,
6855,I0a1699e88f3ed6ec3d0dc8524ffb1d1c1853a86a,http://review.couchbase.org/#/c/6855,1,5dfc8a8b55c21587c9a0648c0613665bfd2ced67,dc54177b07d980fce144fa7081d851152b16f759,1,08/06/11,08/06/11,8,Bugfixing not_my_vbucket occurs on optimized set,"Bugfixing not_my_vbucket occurs on optimized set

Setting correct vbucket index to the optimized set operation
Added warn message if a not_my_vbucket occurs

Change-Id: I0a1699e88f3ed6ec3d0dc8524ffb1d1c1853a86a
Signed-off-by: Matt Ingenthron <ingenthr@cep.net>",0,0,0,0,0,0,0,0,0,
6856,I243ac1c2ff99bd81531fef5a46a2e94bd151dac7,http://review.couchbase.org/#/c/6856,1,dc54177b07d980fce144fa7081d851152b16f759,54244145d56bcfa837e61bc94a7036a43130bde1,1,08/06/11,08/06/11,164,Unit test and javadoc additions.,"Unit test and javadoc additions.

Added javadocs for complex classes
Added a test method to check the vbucket awareness

Change-Id: I243ac1c2ff99bd81531fef5a46a2e94bd151dac7",0,0,0,0,0,0,0,0,0,
6857,I390d889a67ac61523a0f5485f73cdeab0d768982,http://review.couchbase.org/#/c/6857,1,54244145d56bcfa837e61bc94a7036a43130bde1,51a669d53eeb0d7348e842f0147588f00045eb99,1,08/06/11,08/06/11,10,Add both hostnames and IPs to the nodes map.,"Add both hostnames and IPs to the nodes map.

Depending on the deployment environment and the configuration, we
may see either an IP or a hostname from the REST interface.  To ensure
we can look up the node later, simply add both to the internal Map.

Change-Id: I390d889a67ac61523a0f5485f73cdeab0d768982",1,0,0,0,0,0,1,0,0,
6858,I8b8485fe1a1be15d377d39b7b4301024e8d8fd38,http://review.couchbase.org/#/c/6858,1,51a669d53eeb0d7348e842f0147588f00045eb99,56018e7fb7a06a027d601ff6f4d0cb3fc3748c71,1,08/06/11,08/06/11,4,Assert the node must exist when finding primary.,"Assert the node must exist when finding primary.

Not everyone will have assertions on, but if they do the underlying
cause of the confusing hostname or IP address lookup would have
been caught here, rather than in a more confusing place.

Change-Id: I8b8485fe1a1be15d377d39b7b4301024e8d8fd38",1,0,0,0,0,0,1,0,0,
6859,Ifbd8d7863adc55f7c6cf31355c87df9a34f75389,http://review.couchbase.org/#/c/6859,1,56018e7fb7a06a027d601ff6f4d0cb3fc3748c71,8c85391424a323ca317f3d5d99773ccf50be5e62,1,08/06/11,08/06/11,32,Added check for moxi when testing.,"Added check for moxi when testing.

Change-Id: Ifbd8d7863adc55f7c6cf31355c87df9a34f75389
Signed-off-by: Matt Ingenthron <ingenthr@cep.net>",1,0,0,1,0,0,1,0,0,
6860,Ie39c9799fe548c9ab5b01a7d278edab1b5d23aeb,http://review.couchbase.org/#/c/6860,1,8c85391424a323ca317f3d5d99773ccf50be5e62,4e918c7ae264b7950f9a159737e3579ec77c06fc,1,08/06/11,08/06/11,33,"Refactor: not a collection of vbuckets, more of a configuration.","Refactor: not a collection of vbuckets, more of a configuration.

Change-Id: Ie39c9799fe548c9ab5b01a7d278edab1b5d23aeb",1,0,0,1,0,0,1,0,0,
6861,I450402e9d56768378353ebcf77f7ad313093fddf,http://review.couchbase.org/#/c/6861,1,4e918c7ae264b7950f9a159737e3579ec77c06fc,d79038041354cf977e8e4c60992b3a0e89faab7f,1,08/06/11,08/06/11,23,Add a ConfigType via an enum.,"Add a ConfigType via an enum.

Change-Id: I450402e9d56768378353ebcf77f7ad313093fddf
Signed-off-by: Matt Ingenthron <ingenthr@cep.net>",1,0,0,1,0,0,1,0,0,
6862,I245d89b98279a431008c47ac410c1f63d2ca2aac,http://review.couchbase.org/#/c/6862,1,d79038041354cf977e8e4c60992b3a0e89faab7f,e11924cddcccd9e5a1808469066e7300f96e52b5,1,08/06/11,08/06/11,272,Allow config to handle cache as well.,"Allow config to handle cache as well.

Change-Id: I245d89b98279a431008c47ac410c1f63d2ca2aac",1,0,0,1,0,0,1,0,0,
6863,I640fefc37bc863bf5991aa84c6f9fc7e181f5660,http://review.couchbase.org/#/c/6863,1,e11924cddcccd9e5a1808469066e7300f96e52b5,8a16f3982d93469171c6cc2654e07f7c8140cbbc,1,08/06/11,08/06/11,94,Change client ctor to detect vbucket usage from server.,"Change client ctor to detect vbucket usage from server.

The question about whether or not to use vbuckets is really a
funciton of the type of configuration the server will hand out.
There should be no reason to give a URI, bucket name and whether
or not it's vbucket capable.  That should be discernable from the
configuration supplied by the server.

This is believed to be compatible with how moxi detects cache
buckets from membase buckets.

Change-Id: I640fefc37bc863bf5991aa84c6f9fc7e181f5660",1,0,0,0,0,0,1,1,1,
6864,I530cd25641cfebbb0aebfe13fd250c19a851f8be,http://review.couchbase.org/#/c/6864,1,8a16f3982d93469171c6cc2654e07f7c8140cbbc,652a38bacc85d81a5669cb9e84738b00fa8ed82a,1,08/06/11,08/06/11,48,Extracted HTTP auth header to common place.,"Extracted HTTP auth header to common place.

Change-Id: I530cd25641cfebbb0aebfe13fd250c19a851f8be
Signed-off-by: Matt Ingenthron <ingenthr@cep.net>",1,0,0,1,0,0,1,0,0,
6865,I6bfce8ba7b51b76c8b99149405b0caadbe60816e,http://review.couchbase.org/#/c/6865,1,652a38bacc85d81a5669cb9e84738b00fa8ed82a,ae1648f42297230aab25ef028e573f8371d1b476,1,08/06/11,08/06/11,61,Remove standard Authenticator and replace with simple auth header.,"Remove standard Authenticator and replace with simple auth header.

It was found that the Authenticator was caching within the process
in some cases and in others just plain wasn't working.  Since
nothing more than HTTP Basic is required at the moment, just add
our own header.

Change-Id: I6bfce8ba7b51b76c8b99149405b0caadbe60816e
Signed-off-by: Matt Ingenthron <ingenthr@cep.net>",1,0,0,0,0,0,1,0,0,
6866,Ia70079265863f17acdb93cc0115e8d43a8930e13,http://review.couchbase.org/#/c/6866,1,ae1648f42297230aab25ef028e573f8371d1b476,15bc1b58f9339cd1ea7568ec1e6cb134849940b8,1,08/06/11,08/06/11,16,Added logging for manipulation of nodesMap in VBucketLocator.,"Added logging for manipulation of nodesMap in VBucketLocator.

Some situations have come up which are unexepctedly causing the
nodesMap to return a null when identifying the primary for a given
key.  We will now debug log how we build that map and look at the
insides of the nodesMap if this situation occurs.

Change-Id: Ia70079265863f17acdb93cc0115e8d43a8930e13
Signed-off-by: Matt Ingenthron <ingenthr@cep.net>",1,0,0,0,0,0,1,0,0,
6867,Icace3e363bdab30b15df7e0f9946a8355fa02cc4,http://review.couchbase.org/#/c/6867,1,15bc1b58f9339cd1ea7568ec1e6cb134849940b8,677194fb6fb9d1b27340323bc3e62cbfcaa98dad,1,08/06/11,08/06/11,265,Change ConfigType enum for clarity.,"Change ConfigType enum for clarity.

The word CACHE is a bit too overloaded, even here.  Going to
MEMCACHE will make things clearer, and so will more docs.

Change-Id: Icace3e363bdab30b15df7e0f9946a8355fa02cc4",1,0,0,0,0,0,1,-1,0,
6868,I3d505cd6f16bf2b18571f36960f957acea31dabc,http://review.couchbase.org/#/c/6868,1,677194fb6fb9d1b27340323bc3e62cbfcaa98dad,0c678cdeb70a53333fb8d76e231624a913683482,0,08/06/11,08/06/11,2,Change a Bucket instance variable to final.,"Change a Bucket instance variable to final.

Change-Id: I3d505cd6f16bf2b18571f36960f957acea31dabc",1,0,0,1,0,0,1,NA,NA,
6873,I214d39b2c16ea68867f42a3c75aac565d36e8c21,http://review.couchbase.org/#/c/6873,14,0c678cdeb70a53333fb8d76e231624a913683482,d890bc583669b69d283c476e02add77985a4c8cc,1,08/06/11,09/07/11,2102,Added tap client,"Added tap client

The tap client currently supports doing tap backfill as well as
being able to specify custom tap streams. Unit tests are included
to test backfill functionality.

Change-Id: I214d39b2c16ea68867f42a3c75aac565d36e8c21",0,1,0,0,1,1,1,6,1,
6904,I00f51964918c2f18726debec26b816849100e447,http://review.couchbase.org/#/c/6904,2,cb1691aa71adbc79244d9802d3342f83a17e3f61,ff6337fa0bcf614e5bc7a79f2de6c9c1ea6b017f,0,09/06/11,09/06/11,17,Ascii unsupported ops give error message,"Ascii unsupported ops give error message

Ascii operations that are not supported currently don't all
give a reason why they are unsupported. This change add reasons
to these exceptions.

Change-Id: I00f51964918c2f18726debec26b816849100e447",0,0,0,0,0,1,1,NA,NA,
6905,Ibe1cf3ea83e4a26fdccea125fef605b6dc63c8dd,http://review.couchbase.org/#/c/6905,2,ea61c420fac615dc7af89a39a5c49fba8559d4df,5d17f8bbfa6f9529d827f513b661e2f1a60ee65c,1,09/06/11,10/06/11,13,Added unit tests for get and touch,"Added unit tests for get and touch

Due to dependency issues when I submited the code for get and
touch I couldn't submit unit tests for it. Here is a unit test
that covers all of the cases for this operation I can think of.

Change-Id: Ibe1cf3ea83e4a26fdccea125fef605b6dc63c8dd",0,0,0,0,0,1,1,0,0,
6906,Icbffd0be4419fe57a3d4cd8fef879be810a79c30,http://review.couchbase.org/#/c/6906,3,442be863f081a866ffe1bd61c48587400db495d4,e49496770c45ec760c978f0a57c85597a7783adb,1,09/06/11,16/06/11,12,Added unit tests for touch,"Added unit tests for touch

Added a unit test for touch. Due to dependency issues the unit
tests for the touch operation could not be checked in with the
code for the operation.

Change-Id: Icbffd0be4419fe57a3d4cd8fef879be810a79c30",0,0,1,0,0,1,1,0,0,
6920,If3f9542e371eaeddf2bdea05b14b6d7263803e6a,http://review.couchbase.org/#/c/6920,1,f1b5b3e9efaffdefdaf82345a15a3efc003ffc94,bce3a7e704f466ff985594ea00b790f61f907370,1,09/06/11,12/06/11,4,Make sure a selector isn't canceled before reading it,"Make sure a selector isn't canceled before reading it

If a selector is canceled then isReadable will throw an exception.
To avoid this exception and do the right thing make sure that the
selector is valid before checking if it is readable.

Change-Id: If3f9542e371eaeddf2bdea05b14b6d7263803e6a",0,0,1,0,0,1,1,0,0,
6949,Ida71e6557f45c73287f12ba44040553024b7a4a1,http://review.couchbase.org/#/c/6949,2,bce3a7e704f466ff985594ea00b790f61f907370,f2152add8dbe27efd2d313326dc86313f96f2774,0,12/06/11,15/06/11,5,Getl no longer removes the key from binary message.,"Getl no longer removes the key from binary message.

Due to MB-3689 in Membase server we were required to provide a hack
in spymemcached that striped the key out of the body field of a
binary response message.

Change-Id: Ida71e6557f45c73287f12ba44040553024b7a4a1",0,0,1,0,0,1,1,NA,NA,
6950,Ida6d144411c5c9257358a92fb2eaadc2527a94f7,http://review.couchbase.org/#/c/6950,1,7f0b28796d5f9bbd031e4685d1201627b6cc9c2f,0d3520c1f714037702d28cfd4c5dd5d38028d7d1,1,13/06/11,13/06/11,36,Changed all binary command opcode values to hexadecimal.,"Changed all binary command opcode values to hexadecimal.

We intermixed hexidecimal and base 10 values throughout the code
for any given binary operation. This commit changes all the base
10 values to hexadecimal. This way the opcode definitions match
up better with the code in the memcached project.

Change-Id: Ida6d144411c5c9257358a92fb2eaadc2527a94f7",0,0,0,0,0,1,1,0,0,
6952,I1bcbe5d0dfb253256242818f05f6ab72440c20c6,http://review.couchbase.org/#/c/6952,3,dc0c0371d1601550d41f29a924c4515a17be9cee,288b9cdf8cc71e67700516dd6ea1690b426c6efa,0,13/06/11,15/06/11,9,Getl no longer users flags field for request messages,"Getl no longer users flags field for request messages

Bug MB-3960 in Membase server has been fixed. As a result the flags
field is no longer used in getl messages since it makes it more
consistent with other get operations.

Change-Id: I1bcbe5d0dfb253256242818f05f6ab72440c20c6",0,0,0,0,0,1,1,NA,NA,
6982,I72a670d61a7fa776facf11e2630332facdf4277a,http://review.couchbase.org/#/c/6982,2,81f690ceaf564528ca96a365ea79ef909ee10dd4,dbb7eb18659a0ad1346b453a5061a8fa813d4c8a,1,15/06/11,17/06/11,23,"Add touch, get and touch, and get and lock to MemcachedClientIF","Add touch, get and touch, and get and lock to MemcachedClientIF

These operations were not added to the MemcachedClientIF interface
in the original commit.

Change-Id: I72a670d61a7fa776facf11e2630332facdf4277a",0,0,0,0,0,1,1,0,0,
7006,I9317eccd688b6fa1e7113847cd7c7ef160a6624f,http://review.couchbase.org/#/c/7006,4,f6a9efe446242c9e37b37f9936d5d8b9d5a3067b,1259b9f39452dd710526019bcb6fdccf382df4b1,1,15/06/11,21/06/11,245,Added all memcached error codes to spymemcached,"Added all memcached error codes to spymemcached

Previously we only checked a subset of the error codes that
memcached can send back to a client. This created an issue because
if a user recieves an error code that it doesn't expect it resets
the connection. This commit adds all error codes.

Change-Id: I9317eccd688b6fa1e7113847cd7c7ef160a6624f",0,1,1,0,0,1,1,0,0,
7007,I96dd2bae2153021ee6f140910ca7f472514245f6,http://review.couchbase.org/#/c/7007,1,6e748238466c038d3b5511c8ea8b1d500f174b7e,e96704742934535922b2e6d9efe765b1cf83d525,1,15/06/11,16/06/11,1,Removed unused import from GetAndTouchOperationImpl,"Removed unused import from GetAndTouchOperationImpl

Change-Id: I96dd2bae2153021ee6f140910ca7f472514245f6",0,0,0,1,0,1,1,0,0,
7009,I01ca86771041b13e63f5073193eb3c49ed2947c9,http://review.couchbase.org/#/c/7009,2,977f75866809502c4ad8dd3ebae9a882fbf5af2f,75a85874e142fad7763ef3fe0d5aba057cfde686,1,15/06/11,18/06/11,9,Fixed broken get and touch test,"Fixed broken get and touch test

I was testing these throuh eclipse before and I didn't have
assertions turned on so I falsely verifed the last commit that I
checked in.

Change-Id: I01ca86771041b13e63f5073193eb3c49ed2947c9",0,0,1,0,0,1,1,0,0,
7040,Ia84df9398e258ae1edba7a11dee55a4c265414d9,http://review.couchbase.org/#/c/7040,2,3f9b5d8cb0d0c98c14b353db9c98ee8cc5b34462,6dbc80a90e82043b9f610f3e321eed308025b6f8,1,16/06/11,20/06/11,11,ASCII get operations now return a false operation status on failure,"ASCII get operations now return a false operation status on failure

get in ASCII always returns END at the end of the result from
memcached. In the current implementation of spy seeing END caused
spy to return operation success. We now check to see if a value
is returned before END and if one if not we return a failure
for OperationStatus of NOT_FOUND.

Change-Id: Ia84df9398e258ae1edba7a11dee55a4c265414d9",0,0,1,0,0,1,1,0,0,
7044,I62af7450cf6cd1c9d1bf171e5063b3d8a1c919ce,http://review.couchbase.org/#/c/7044,4,7650168a75b7ae55087d78c5912c8187d0146ab2,7316b6d19a18dd043e43cd72d9ad0d94412d6c21,1,16/06/11,21/06/11,218,Add visibility into operations (status),"Add visibility into operations (status)

This commit allows the functionality for users to issue requests
and then check to see whether or not they succeeded. They can also
now access the error message that the server sends back to them
so they can see why the server rejected their request. Operation
status's also take into account operation timeouts and exceptions
so if an operation times out the operation says so. Also if an
exception is thrown while processing the operation the operation
status reports the message from that exception.

Change-Id: I62af7450cf6cd1c9d1bf171e5063b3d8a1c919ce",0,1,1,0,0,1,1,0,0,
7045,I2db360abbc0e4577526ac057a4945eb55d0dbd10,http://review.couchbase.org/#/c/7045,8,3277a20dbf197dc8e88778390097b9246070340f,f8e310ddf7dba65f2df4f3fac8d8d8966cfa0522,1,16/06/11,21/06/11,38,Add visibility into operations (key),"Add visibility into operations (key)

This commit adds the ability for the user to be able access
the key that the operation asked for if one is present. This allows
users to be able to easily resend an operaiton on a given key since
they will no longer have to keep key-operation data structures
around in the case of failures.

Change-Id: I2db360abbc0e4577526ac057a4945eb55d0dbd10",0,1,1,0,0,1,1,0,0,
7104,I2f7eb419790f3d44d0471efcdac818f17171ebe2,http://review.couchbase.org/#/c/7104,1,66fa0d2fcbca16cd0cd375f1085c6886d6ac3cdf,11a3bd7c2fb5c9278245156ba23d09ece7b0b59e,0,21/06/11,23/06/11,1,Removed unused import from ConfigurationProviderHTTP,"Removed unused import from ConfigurationProviderHTTP

Change-Id: I2f7eb419790f3d44d0471efcdac818f17171ebe2",0,0,0,1,0,1,1,NA,NA,
7105,Ic3036e6c7929221768bae4069cfcae23b7bedf7f,http://review.couchbase.org/#/c/7105,2,7598374bafac290408f01281a030b05c64481b4e,7c5e768950bcb3d054f3f69aadeda9cb6e45391a,1,21/06/11,29/06/11,2,Added generic to SingleElementFiniteIterator in MemcachedClient,"Added generic to SingleElementFiniteIterator in MemcachedClient

Change-Id: Ic3036e6c7929221768bae4069cfcae23b7bedf7f",0,0,1,1,0,1,1,0,0,
7107,I8f8696e694eb10c6d327c67197bbccacabb35959,http://review.couchbase.org/#/c/7107,3,9d13177b88708ab0b55f0d10ed0cfe1b671479f1,587b88bd5c0e03944e31f779ea1a184b52d73e05,1,21/06/11,25/06/11,16,Added serial ID's to execeptions x,"Added serial ID's to execeptions
x

Change-Id: I8f8696e694eb10c6d327c67197bbccacabb35959",0,0,1,1,0,1,1,0,0,
7108,Id44167d6f669e656a7b0333289e782c835b32c93,http://review.couchbase.org/#/c/7108,1,3ee53fc9bdc2f3b95bc2cea5f5e847307acff0c4,61b800abf84dd4ea6bb29cf533f500e396c5a038,1,21/06/11,25/06/11,4,Removed unused imports in VBucketCacheNodeLocatorTest,"Removed unused imports in VBucketCacheNodeLocatorTest

Change-Id: Id44167d6f669e656a7b0333289e782c835b32c93",0,0,1,1,0,1,1,0,0,
7575,I7f82596156c697b57b061bf066686aded16b772a,http://review.couchbase.org/#/c/7575,2,dde42eddf4115e5bdcf64e0fe86ae2e6bd24e062,9bd2f726adf9de4fc6b098571aed8e496d1d8531,0,25/06/11,25/06/11,4,Fixed issue regarding connecting to a non-existent bucket,"Fixed issue regarding connecting to a non-existent bucket

Connecting to a Membase server correctly, but specifying a
bucket that doesn't exist causes the BufferedReader in the
readToString function to be null. This causes a NPE when we
appemtp to close the reader.

Change-Id: I7f82596156c697b57b061bf066686aded16b772a",0,0,0,0,0,1,1,NA,NA,
7576,If8cf813fae0e04a138f0eccd908373ccf4331ccb,http://review.couchbase.org/#/c/7576,1,8be08139b1c6871051ab73dbefb42ec318250035,8224858d5e464d7466b469aa65bee915fbf2d551,0,25/06/11,05/07/11,48,Added source folder for manuel tests to Eclipse config file,"Added source folder for manuel tests to Eclipse config file

Change-Id: If8cf813fae0e04a138f0eccd908373ccf4331ccb",0,0,0,1,0,1,1,NA,NA,
7587,I89e021d74048c7364ed209838eb5533c8a40ae86,http://review.couchbase.org/#/c/7587,1,6ef33387354d7f218505a15a131d70bc0e882c9a,3cd72128185d1fea1323cc82582ab9e755854f2a,0,27/06/11,27/06/11,1,Adding the repository needed to download netty.,"Adding the repository needed to download netty.

Change-Id: I89e021d74048c7364ed209838eb5533c8a40ae86",0,0,0,1,0,0,1,NA,NA,
7626,I01653385c1d125ad868e9e018db311597b6ce725,http://review.couchbase.org/#/c/7626,6,3cd72128185d1fea1323cc82582ab9e755854f2a,1c03fdfde66d3bf28a85eb6cfffdab25a32ff4e8,1,28/06/11,29/06/11,69,Added constructor to MemcachedClient that takes a ConnectionFactory,"Added constructor to MemcachedClient that takes a ConnectionFactory

Previously users of the vBucket Aware MemcachedClient of smart client
were unable to specify specific values for how connections are
createded. This commit allows uses to pass a ConnectionFactory into
a vBucket Aware constructor in the MemcachedClient object.

Change-Id: I01653385c1d125ad868e9e018db311597b6ce725",0,1,0,0,0,1,1,0,0,
7641,Ie418e1e7ba59a21240b1c59f5b3bc25ce0a21539,http://review.couchbase.org/#/c/7641,3,1c03fdfde66d3bf28a85eb6cfffdab25a32ff4e8,706073481a066129ea999566e31d684bc0bb6305,1,29/06/11,29/06/11,4,Compiler warning pointed out dumb code.,"Compiler warning pointed out dumb code.

Change-Id: Ie418e1e7ba59a21240b1c59f5b3bc25ce0a21539",0,0,0,1,0,0,1,0,0,
7642,I187088c114ec00ee2d561a47ae4381e3646aada8,http://review.couchbase.org/#/c/7642,1,977ea9e25eebd0c4bc62196a91dd64aa59a2e89d,1eff6a1f0b14fb5e630363e7cc1341070e396259,1,29/06/11,29/06/11,22,Fixed some shadowing parameter warnings.,"Fixed some shadowing parameter warnings.

Change-Id: I187088c114ec00ee2d561a47ae4381e3646aada8",0,0,0,1,0,0,1,0,0,
7643,I8247911a9e766cfdee615c2c97e9d75a11ee4f52,http://review.couchbase.org/#/c/7643,1,1eff6a1f0b14fb5e630363e7cc1341070e396259,64f7abdce219c7b01800de3d63b3cd86142ea502,1,29/06/11,29/06/11,5,Compiler pointed out ignored exception. :(,"Compiler pointed out ignored exception. :(

Change-Id: I8247911a9e766cfdee615c2c97e9d75a11ee4f52",0,0,0,1,0,0,1,0,0,
7646,Ic085218bcd6fa53348f70eae13e219a9882b6442,http://review.couchbase.org/#/c/7646,2,5eade023e58c9c1f578cadad5d6eef4f2d64c71e,c94a2ef8b8c5fde32a962ba2eca1dcf42a9c6bcc,0,30/06/11,05/07/11,17,Made SyncGetTest failures less sporadic,"Made SyncGetTest failures less sporadic

Moved the code that sets the items for this test so that it could
use a MemcachedClient that had a regular timeout. This allows us to
avoid a possible failure resulting from using the connection that
has a short timeout. Now only the get (which is surposed to fail)
uses this short timeout connection.

Change-Id: Ic085218bcd6fa53348f70eae13e219a9882b6442",0,0,0,0,0,1,1,NA,NA,
7647,I94c7d61bfb6dd76abf4afccd0796dca99fd4bd0a,http://review.couchbase.org/#/c/7647,1,c94a2ef8b8c5fde32a962ba2eca1dcf42a9c6bcc,91f9be6327331ae1fd54283b4b474d653ec4cd22,1,30/06/11,05/07/11,2,Changed the value size of items used in LongClientTest,"Changed the value size of items used in LongClientTest

The 32k value used previously worked fine when we were only testing
clients against localhost, but in the future we want to be able to
test spymemcached against servers on the network. This high value
along with the large number of multi-gets done in this test causes
failures due to not being able to read and write data fast enough.
As a result timeouts were caused.

The value has been lowered to something more reasonable for now, but
in the future we should devise a test that will be able to test spy's
ability to handle multi-gets with large values over a network.

Change-Id: I94c7d61bfb6dd76abf4afccd0796dca99fd4bd0a",0,0,0,0,0,1,1,0,0,
7649,I8760f888138667f42027222ac569bda9bff50c40,http://review.couchbase.org/#/c/7649,1,248c472f8b6b6b2cd609f62d2a2f4a47262d787b,18d3d4b6d11f59538bd3648a464791397f03ad52,1,30/06/11,05/07/11,2,Made operation timeout longer for QueueOverflowTest,"Made operation timeout longer for QueueOverflowTest

In order to support being able to test spymemcached against servers
residing on the network we need to increase the timeout of this test

Change-Id: I8760f888138667f42027222ac569bda9bff50c40",0,0,0,0,0,1,1,0,0,
7650,If32bc87f381276bee3f9531090ed9c129369ca4e,http://review.couchbase.org/#/c/7650,9,18d3d4b6d11f59538bd3648a464791397f03ad52,0ad3854a69431cfe297719bb43dee9bbe1b0389f,1,30/06/11,18/07/11,132,Added the ability to specify the ip address of the testing server,"Added the ability to specify the ip address of the testing server

We now have the ability to specify the ip address of the server we
want to test against on the command line. If none is specified then
the tests will run against localhost. The command line parameter to
specify the testing server is 'server' and can be used as follows.

server=10.2.1.58

Change-Id: If32bc87f381276bee3f9531090ed9c129369ca4e",0,1,0,0,0,1,1,0,0,
7651,I8d4750053cf52734c703bfe80d8c2d42ca353bb0,http://review.couchbase.org/#/c/7651,3,d7038fddf9d393bddcb6b301d42a7e719fad61fb,fe09d38cea1c05ea570d1d3be9c8736c8370d57d,1,30/06/11,11/07/11,83,Added a command line parameter for specifying server type,"Added a command line parameter for specifying server type

The user naow has the ability to specify the server type that
they are testing against by adding the parameter 'type' to
the command line. The default type is memcached and there are
three valid types, memcached, membase, and couchbase. An example
of how to use the parameter is below.

type=membase

Change-Id: I8d4750053cf52734c703bfe80d8c2d42ca353bb0",0,0,0,0,0,1,1,0,0,
7672,Id9f7154bc40df5e9a6b05a4d52422bd893952d2f,http://review.couchbase.org/#/c/7672,1,c05751b0bfd339b1f7e912d7f24c5b8d6fbf9987,b3f2a55125063f92436391954b4d8525180acd14,1,30/06/11,10/07/11,8,Removed unused variables in testcases.,"Removed unused variables in testcases.

Change-Id: Id9f7154bc40df5e9a6b05a4d52422bd893952d2f",0,0,0,1,0,1,1,0,0,
7801,Ic7d002ec8e77e2fccc31987fcb1cba1ca14715da,http://review.couchbase.org/#/c/7801,4,56c79dbe152df8caa08e4cc160fafeeedf8abdbb,3ffad69619e121ec9cd42c3472e3c0c5c2c1df3d,1,08/07/11,11/07/11,269,Refactored Operations to improve correctness of vbucket aware ops,"Refactored Operations to improve correctness of vbucket aware ops

Previously we had operations that implemented classes that they
should not have been implemented. For example, there were ASCII
operations that implementing the VBucketAware interface. Since
ASCII operations must go through moxi and don't contain vbucket
numbers there is no reason for them to implement this interface.

This commit also contains the addition of SingleKeyOperationImpl
and MultiKeyOperationImpl which subclass OperationImpl and are
superclasses to binary operations that contain one or more keys
correspondingly. This abstraction allows these type of operations
to deal with vBucket awareness and the amount of keys the operation
contains in different ways.

Change-Id: Ic7d002ec8e77e2fccc31987fcb1cba1ca14715da",0,1,1,0,0,1,1,1,1,
7802,I68fd4bb331fecf89655904396e825b0f42d7a17c,http://review.couchbase.org/#/c/7802,4,d068a3102db6884d80950ad90376382a3306eeea,22b07b8e6563d0b8382db3d0af71e4dff0012903,1,08/07/11,11/07/11,2,Made and addOperation function private in MemcachedConnection,"Made and addOperation function private in MemcachedConnection

This function isn't used outside of MemcachedConnection and it is
the only one that doesn't put vbucket information into operations.
It is a helper function of the addOperation(String, Operation) call
so it doesn't need to add vbucket data but calling it from outside
the MemcachedClient scope could cause issues.

Change-Id: I68fd4bb331fecf89655904396e825b0f42d7a17c",0,1,1,0,0,1,1,1,1,
7803,Iee8bea445fe45ef3d822e0f2d0fb9cb8eb20f536,http://review.couchbase.org/#/c/7803,4,b99980224945a9d9687d33c4dbb6f37a27aa3b2d,86c9ac5379b1e68483d0bcea17aa9e48f988131f,1,08/07/11,11/07/11,12,Fixed an bug where multi-gets didn't work with vb aware constructor,"Fixed an bug where multi-gets didn't work with vb aware constructor

This fix adds vbucket information to multiget operations.

Change-Id: Iee8bea445fe45ef3d822e0f2d0fb9cb8eb20f536",0,1,1,0,0,1,1,1,1,
7846,Iaa56af63d4ac1182235bf8727296198d1b687688,http://review.couchbase.org/#/c/7846,1,30dba5849042626aeb57ed09ff92980ea7900f5f,96f460c988f450d5d695da4a19e6b69e191c1337,0,09/07/11,09/07/11,2,Adding a warmup state for nodes.,"Adding a warmup state for nodes.

At some point, the REST interface added warmup as a possible state
for a node alongside healthy and unhealthy.  This will allow the
config to understand that state.

Change-Id: Iaa56af63d4ac1182235bf8727296198d1b687688",0,0,0,0,0,1,1,NA,NA,
7877,I4ca0da4f9638f7fe3a69bbe55dfb3edf30ae13cc,http://review.couchbase.org/#/c/7877,7,d32872903e82465ff15c0889e9f08158e16ba7f4,a7be482cdc446d01b72b2e99ee300f198f0bcc8a,1,11/07/11,11/07/11,162,Issue 96: ClassPathException fix,"Issue 96: ClassPathException fix

The issue here was that we were combinding multiple types of
get operations in the same class, but each operation would
have a different Claaback type. When we would go to optimize
get operations it would optimize get, getl, gat, and gets
operations and since they have different callback types we
would throw an exception.

Each operation now has its own class.

Change-Id: I4ca0da4f9638f7fe3a69bbe55dfb3edf30ae13cc",0,1,0,0,0,1,1,0,0,
7890,I4e884755321e68da099be6a9a1a1d22305931e26,http://review.couchbase.org/#/c/7890,1,3370e51992f98a833926661eb5bb870a8a56f7a2,a51589fd2943a84923dba97f8c2502d37ef43744,1,11/07/11,14/07/11,32,TapOperation's shouldn't be KeyedOperations.,"TapOperation's shouldn't be KeyedOperations.

Change-Id: I4e884755321e68da099be6a9a1a1d22305931e26",0,0,1,1,0,1,1,0,0,
7898,I8d761b5cd1e0d5a44c1db5cbd62c74167ff51a64,http://review.couchbase.org/#/c/7898,4,a51589fd2943a84923dba97f8c2502d37ef43744,d1f9e289188182c705ad7a2dc7eb2cf91509635b,1,12/07/11,19/07/11,128,WIP: Added ability to do tap dump,"WIP: Added ability to do tap dump

Waiting on server fix from Chiyoung.

Change-Id: I8d761b5cd1e0d5a44c1db5cbd62c74167ff51a64",0,1,1,0,0,1,1,0,0,
7936,Ia5d1d943a59d91ec59419643e9c0af10ae5166ba,http://review.couchbase.org/#/c/7936,3,4ffa38f2a68c2a255a086cc88ddf73604f161764,bb69c63144f5831c2bc9b361ea5b45e83b2278f6,1,13/07/11,14/07/11,52,Made TapTest only run against Membase.,"Made TapTest only run against Membase.

I'm aware that tap works for memcached, but since most people
are still on a tapless version I don't want to run the tests
against memcached yet.

Change-Id: Ia5d1d943a59d91ec59419643e9c0af10ae5166ba",0,0,0,0,0,1,1,0,0,
7969,I7209adf74c871a9ad6d7cf3e46a9c2c377b588ec,http://review.couchbase.org/#/c/7969,2,e80d5d246f125ba4e31ed38df86c740c7683f2be,f91ab24c9877a24d17d22fa681a1666559f2e53b,1,13/07/11,13/07/11,940,Added MembaseClient Object,"Added MembaseClient Object

The MembaseClient object should be used when making connections
to Membase clusters. This commit also includes a new
MembaseConnectionFactory and adds adds the coresponding builder
code to ConnectionFactoryBuilder. Test support is also added
for connections specific to Membase clusters.

Change-Id: I7209adf74c871a9ad6d7cf3e46a9c2c377b588ec",1,0,0,0,1,0,1,-1,0,
8004,Iae2bb6381a8a7dd8732cd878a5d9016dc512a627,http://review.couchbase.org/#/c/8004,1,d59c471972addd8bff5b406fd505a1935b2b6136,f828f7b454cbfd4a8f9cd47ad1d25a01637e35dd,0,14/07/11,14/07/11,4,Excluded Non-memcached tests when testing memcached,"Excluded Non-memcached tests when testing memcached

Change-Id: Iae2bb6381a8a7dd8732cd878a5d9016dc512a627",0,0,0,1,0,1,1,NA,NA,
8006,I6fb7d41cc612ef1620ed678f7139ca002dfa2625,http://review.couchbase.org/#/c/8006,1,efc9691066d589faa72759018139226112ef63e6,14465397b3fccb64eda6de11ea003615b09682f1,0,14/07/11,15/07/11,7,Made EINTERNAL and ERR2BIG errors throw an exception,"Made EINTERNAL and ERR2BIG errors throw an exception

This fix will revert a change that broke user code. These errors
will now cause the connection to Membase to be reset.

Change-Id: I6fb7d41cc612ef1620ed678f7139ca002dfa2625",0,0,0,0,0,1,1,NA,NA,
8074,I17156e804155809cab54569c0906c64afeea99c9,http://review.couchbase.org/#/c/8074,1,2ee00303785fe956d67cd512d79dbe284fd10a5f,6668e0893afe293d679618c79b01e8a4096aa5d2,0,17/07/11,18/07/11,6,Fixed issue with flags not being added properly to tap messages,"Fixed issue with flags not being added properly to tap messages

Change-Id: I17156e804155809cab54569c0906c64afeea99c9",0,0,0,1,0,1,1,NA,NA,
8114,I0c7c84c2ae5c9cc68d4e9c6f925f9ac6885fae6b,http://review.couchbase.org/#/c/8114,2,b826e228beabb8884d59e405c0bac05b386cc664,a57e034037a979d66da7f3b8873c76ce1b5fc5fa,1,18/07/11,19/07/11,61,"Tap streams now pause every 10,000 messages","Tap streams now pause every 10,000 messages

In the previous code I was sending acks back to the server
immediately and this kind of behavior could cause a heap overflow
for users who start tap streams but don't process the messages. Now
the ack messages are queued with the responses and only sent back
to the server after all mutations sent before the ack was recieved
are processed.

Change-Id: I0c7c84c2ae5c9cc68d4e9c6f925f9ac6885fae6b",0,0,0,0,0,1,1,1,1,
8115,I51b3b72eb46c781eb3766435f43e57ded683514b,http://review.couchbase.org/#/c/8115,3,a1425898e5b7195417ae21cccccacc41874d9221,8c40552a90cf85cf63b8ced70f7386709c1ac380,1,18/07/11,21/07/11,34,Locator reconfiguration has been implemented,"Locator reconfiguration has been implemented

Change-Id: I51b3b72eb46c781eb3766435f43e57ded683514b",0,0,1,1,0,0,1,0,0,
8121,I4cd6a9924b9faf0361fbd496dc68a95a01bf6597,http://review.couchbase.org/#/c/8121,4,beae98e781fbfc167aabf25482d2e59b70afc2a6,9e099b16279bebff6a79ef8166277921bd7a6542,0,18/07/11,18/07/11,79,Added README.markdown,"Added README.markdown

Change-Id: I4cd6a9924b9faf0361fbd496dc68a95a01bf6597",0,1,0,1,0,1,1,NA,NA,
8125,I655adc5090249180c3e75fbd35036b15252d093f,http://review.couchbase.org/#/c/8125,3,e84fa6071234fc6dc7618e78b49bf9432e9dcabb,0a2cdc2ce51c6d03f3c26681f57d74870bdb1a4e,1,18/07/11,21/07/11,40,Encode with commons codec more correctly.,"Encode with commons codec more correctly.

Apache Commons Codec had introduced a change in 1.4 that had it
inadvertantly adding extra CRLF to encode responses.  We had worked
around this issue when writing the initial HTTP authorization
code, but it turns out commons codec has reverted to the behavior
in 1.3 with the release of 1.5.

This change updates commons codec, adds a test to verify correct
behavior, and addresses potential error handling issues with the
character set.

Change-Id: I655adc5090249180c3e75fbd35036b15252d093f",0,0,1,0,0,1,1,0,0,
8194,I23953356c77e72e0fa3ce0a1745dee7eb8faba3f,http://review.couchbase.org/#/c/8194,1,6fa4a9e5122c4e8e3af109a299f18dd1956c5491,682c34e1b73b342be92fd1cefdb1020cc96092cd,1,21/07/11,21/07/11,2,Also check for RETRY during clone.,"Also check for RETRY during clone.

Change-Id: I23953356c77e72e0fa3ce0a1745dee7eb8faba3f",0,0,0,1,0,1,1,0,0,
8195,Ida002fd1d510d20c432e77e01eefbc530d3b34b1,http://review.couchbase.org/#/c/8195,2,682c34e1b73b342be92fd1cefdb1020cc96092cd,1f8b51ed165c19ee20b4da390c4e27d0eba06fcf,1,21/07/11,21/07/11,77,Ensure nodesMap updates are safe when topology changes.,"Ensure nodesMap updates are safe when topology changes.

This change much more closely (perhaps too defensively)
couples the Config and the list of nodes.  It also ensures
that the Map<String, MemcachedNode> is less prone to
concurrency problems and fixes a concurrency problem which
allowed nodes to be removed when receiving a not-my-vbucket
response.

This indicates we need to make some changes to how the entire
object model and config list are handled, but just to quickly
fix a race found, tie together the config and node list when
locating the right node.

Testing for this is rather manual at the moment.

Change-Id: Ida002fd1d510d20c432e77e01eefbc530d3b34b1",0,0,0,0,0,1,1,0,0,
8196,Ia0a5c54abca51933995dc307bb5318ebf7dddbce,http://review.couchbase.org/#/c/8196,2,d96b66b5463258424ad5c84f890beeeef3176154,0f098b2887c4848781c7ece232cd1ab521693069,1,21/07/11,21/07/11,19,VBucketNodeLocator should not implement getSequence(),"VBucketNodeLocator should not implement getSequence()

Change-Id: Ia0a5c54abca51933995dc307bb5318ebf7dddbce",0,0,0,1,0,1,1,0,0,
8239,I98a562a8da8bff70c6f953d44d0b3863f493e472,http://review.couchbase.org/#/c/8239,2,783f23007a0c19e62f8cb3cc9039047b6dfbbaa9,747f185c881ced21f5bbf70c21c1b477b6911eac,1,22/07/11,26/07/11,947,Added MembaseClient Object,"Added MembaseClient Object

The MembaseClient object should be used when making connections
to Membase clusters. This commit also includes a new
MembaseConnectionFactory and adds adds the coresponding builder
code to ConnectionFactoryBuilder. Test support is also added
for connections specific to Membase clusters.

Change-Id: I98a562a8da8bff70c6f953d44d0b3863f493e472",0,0,1,0,1,1,1,-1,0,
8240,I9d2a168a031b6ed2c3cf3b44af26ec415ba36d75,http://review.couchbase.org/#/c/8240,3,1de1568269f7698ac675a97e21b673cd7f2f603e,b7a0047a256fd66afc040daaf28237874b39e171,1,22/07/11,26/07/11,44,Changed MemcachedConnection varibale from conn to mconn,"Changed MemcachedConnection varibale from conn to mconn

In the future we will have multiple connections do this name
change will distiguish it from those other connections

Change-Id: I9d2a168a031b6ed2c3cf3b44af26ec415ba36d75",0,0,1,0,0,1,1,0,0,
8241,I1b25d5bb3726ecef28354d5ee8173c82879a4f7d,http://review.couchbase.org/#/c/8241,4,67ac804f114d05a1a1766a20222e88011234aff1,7b0755d2ca50f851a08faeec6b9a8ba7e74889e0,1,22/07/11,26/07/11,227,Changed IO thread from MemcachedClient to MemcachedConnection,"Changed IO thread from MemcachedClient to MemcachedConnection

This change will allow us to have multiple IO thread running within
a client. This is paricularly important for being able to have
a CouchbaseClient since we will need a connection to memcached and
a connection to CouchDB.

Change-Id: I1b25d5bb3726ecef28354d5ee8173c82879a4f7d",0,1,1,0,0,1,1,0,0,
8242,I4f33f74c344775e9dfb0804eae8d7a7bbf341322,http://review.couchbase.org/#/c/8242,3,e9dbde883d8cd692ab4646205a49586071ab7e6b,fd2c348e1dec8eea0e22232ff33b8e395e20dc19,1,22/07/11,26/07/11,6,Removed warnings from LoggerFactory,"Removed warnings from LoggerFactory

Change-Id: I4f33f74c344775e9dfb0804eae8d7a7bbf341322",0,0,1,1,0,1,1,0,0,
8243,If3d13aec9145e459498087507877bb15de45ec78,http://review.couchbase.org/#/c/8243,7,8e80519e357d390a46fe88079b7ea9ae255bb789,aeae0543d4b5b047b945e0d948e3327f267ff21c,1,22/07/11,26/07/11,1237,Add HTTP Subsystem,"Add HTTP Subsystem

This http subsystem is based on the reactor model used by the
apache httpcomponents HTTPCore-NIO library

Change-Id: If3d13aec9145e459498087507877bb15de45ec78",0,1,1,0,1,1,1,1,1,
8359,I43b0934d25f6da5e94a6b5a5720d7edccf37152b,http://review.couchbase.org/#/c/8359,2,7b9994c450e59a57ce8df09128048a3d0185b289,435c56e813e5cda1bc2fc7d5262b6a9b584bac7f,0,26/07/11,26/07/11,2,Updated eclipse classpath to include commons-codec 1.5,"Updated eclipse classpath to include commons-codec 1.5

Previously it was commons-codec 1.4 and the upgrade to 1.5 fixed
and issue pertaining to commons-codec 1.4

Change-Id: I43b0934d25f6da5e94a6b5a5720d7edccf37152b",0,0,0,0,0,1,1,NA,NA,
8399,I6dae0f29d0c55c5a7e2caa69904f22ba44e608b8,http://review.couchbase.org/#/c/8399,1,435c56e813e5cda1bc2fc7d5262b6a9b584bac7f,eb62dbb7f4dd367f422be99deaab2e8db8475442,1,27/07/11,27/07/11,19,Added new test configuration args for Couchbase Server.,"Added new test configuration args for Couchbase Server.

Change-Id: I6dae0f29d0c55c5a7e2caa69904f22ba44e608b8",0,0,0,1,0,1,1,0,0,
8401,I09d4f8751ca8f308e986d07954d7e755af6aa2d8,http://review.couchbase.org/#/c/8401,7,eb62dbb7f4dd367f422be99deaab2e8db8475442,77d2a6cd6e384085fecd77a7ed77293827cdc0a6,1,27/07/11,27/07/11,1822,Added Couchbase Views.,"Added Couchbase Views.

Change-Id: I09d4f8751ca8f308e986d07954d7e755af6aa2d8",0,1,0,1,1,1,1,1,1,
8422,Ib0e07e048b2cfb35d5fca18ced933caf37963db1,http://review.couchbase.org/#/c/8422,2,5f1444222453fb93ae8a3bdd44ca38c38935011c,4bf064358c6ce34b0012550f4708d7d54600bb6b,1,27/07/11,27/07/11,17,A few javadoc fixes,"A few javadoc fixes

Buildr complains(warns) about these before creating jars and I
got tired of seeing the warnings.

Change-Id: Ib0e07e048b2cfb35d5fca18ced933caf37963db1",0,0,0,0,0,1,1,0,0,
8461,I2795962b8bf56a81f7a2c9ebacf4c90aaad4ce3c,http://review.couchbase.org/#/c/8461,7,bd90a61c75f3bca6ee156ce28998f60ba6487345,2c529f9332b16fcf0de459cfd00507d00c24a92b,1,27/07/11,28/07/11,219,Added the ability for Spy to handle errors in views,"Added the ability for Spy to handle errors in views

If a node is down or an item is unavailable then Couchbase
will return a view response that contains a mix of errors
and successes. Previously Spy could only handle responses
that contained only successes. This commit adds the ability
to handle a mix of errors and successes returned in the same
view result.

Change-Id: I2795962b8bf56a81f7a2c9ebacf4c90aaad4ce3c",0,1,0,0,0,1,1,0,0,
8478,I6c339c0300d666a32fa958aa273536209f51b8e6,http://review.couchbase.org/#/c/8478,2,56d19018cfd5a7161b217742619e0655ef8bde66,c86c0a4dd5fe3cce61a08969ab671145893243fc,1,28/07/11,28/07/11,191,Made MembaseClient and CouchbaseClient reconfigurable,"Made MembaseClient and CouchbaseClient reconfigurable

Theses two client classes will now handle topology changes
gracefully.

Change-Id: I6c339c0300d666a32fa958aa273536209f51b8e6",0,0,0,0,0,1,1,-1,0,
8480,I33ab5a4ad3e3f9d14486e446aef1e65b58832759,http://review.couchbase.org/#/c/8480,4,b486e4c6cdfbee4b9bc9f090b58f1c88563205f8,a192dbbc2d2c10866ccadc2948d8e28d66972d93,1,28/07/11,28/07/11,138,Moved protocol.couchdb package to protocol.couch,"Moved protocol.couchdb package to protocol.couch

mv src/main/java/src/net/spy/memcached/protocol/couchdb
to
src/main/java/src/net/spy/memcached/protocol/couch

Change-Id: I33ab5a4ad3e3f9d14486e446aef1e65b58832759",0,1,0,0,0,1,1,0,0,
8483,I90aba04cb81909ce2077c71c44643c15ab5c2425,http://review.couchbase.org/#/c/8483,1,d95766d8b9d8e1ad0e847862cfb571bbf2ab5a9b,2122457f1ae3c52b05559ac5a804a7f199ca0409,1,28/07/11,28/07/11,11,Spymemcached Issue 134: Performance fix,"Spymemcached Issue 134: Performance fix

Change-Id: I90aba04cb81909ce2077c71c44643c15ab5c2425",0,0,0,1,0,1,1,-1,0,
8503,I7b6da04d84d0f16ca309b37038971f0a822bc1df,http://review.couchbase.org/#/c/8503,5,2b89fa6ec1f6db51f9b500e76d7ae56c4f56aa9c,abd68d344a6011715ce232111791d692c39be717,1,28/07/11,28/07/11,67,Added the ability to have a properties file with config info,"Added the ability to have a properties file with config info

The only info we currently put into this file is whether or
not we want our views running in production or development
mode.

Change-Id: I7b6da04d84d0f16ca309b37038971f0a822bc1df",0,1,0,0,0,1,1,0,0,
8508,Ib396064fccbc02c6cd49056685310cdb167977e7,http://review.couchbase.org/#/c/8508,2,4e1ecd120055630884449724bf52290aa0f41cd9,b6512508c376c069f0404b4518b6e332ee6647b2,1,28/07/11,28/07/11,10,Changes operationTimeout for http operations to 60 seconds.,"Changes operationTimeout for http operations to 60 seconds.

This is a temporary change for the developer preview release
of Couchbase. The timeouts will be lowered and will not be
hardcoded in the future.

Change-Id: Ib396064fccbc02c6cd49056685310cdb167977e7",1,0,0,0,0,0,1,0,0,
8524,Ie0dd1e4f848b256bb7df077fb2c01f1d2f858991,http://review.couchbase.org/#/c/8524,1,b6512508c376c069f0404b4518b6e332ee6647b2,2dec34107e065bc861dd39a04dc5884af886a28e,0,29/07/11,02/08/11,3,Exclude membase tests when specifying memcached build type.,"Exclude membase tests when specifying memcached build type.

Change-Id: Ie0dd1e4f848b256bb7df077fb2c01f1d2f858991",0,0,0,1,0,1,1,NA,NA,
8559,I0c992186e7b7701929e0dc60341430d8d2255ba7,http://review.couchbase.org/#/c/8559,6,7010f7703fc24695d8ac3ce6bac5975535a4e49c,b1c311af134786e6dee92ac9de439fa16aac95c1,1,01/08/11,16/08/11,390,Made HashAlgorithm to be an interface.,"Made HashAlgorithm to be an interface.

This is preferable over an Enum in order to allow client hash function
customization.

This change introduces HashAlgorithm interface and updates all references
to the former Enum with the default interface implementation.

Change-Id: I0c992186e7b7701929e0dc60341430d8d2255ba7",0,1,1,0,0,0,1,0,0,
8560,Ie323151b67608e454b726050bd80b097cfba724c,http://review.couchbase.org/#/c/8560,10,3a01bc679c091e78d788a8e3b121b1af2512d6ab,4389a7c3f8e84d6ecbb2cf5f8c2ff61ec2524302,1,01/08/11,16/08/11,158,Introduced HashAlgorithm registry in order to support adding of new hash algorithms while initializing from configuration files,"Introduced HashAlgorithm registry in order to support adding of new hash
algorithms while initializing from configuration files

Also:
- TapConnectionProvider now uses configuration as a source for
  HashAlgorithm definition (just like ConnectionFactoryBuilder)

Change-Id: Ie323151b67608e454b726050bd80b097cfba724c",0,1,1,0,0,0,1,1,1,
8561,Ia3ea8d3b6825ed5558ce08f78adf0ae3579966e8,http://review.couchbase.org/#/c/8561,2,b573279514fcf8495b863c24a044ee3d5d7aa172,62577e22c77c6224af986ce0489d8dde6d0d1c29,0,01/08/11,16/08/11,2,Uptick JUnit version in the build-file to match .classpath,"Uptick JUnit version in the build-file to match .classpath

Change-Id: Ia3ea8d3b6825ed5558ce08f78adf0ae3579966e8",0,0,1,1,0,0,1,NA,NA,
8594,Icec6b7c4aceb6ce6319672bb3a033921960488ad,http://review.couchbase.org/#/c/8594,1,23848e098690dce214ec4dbf48c641b347167d20,ad64ebdc966dfbfc855daee5129e5e59b0ff4afe,1,02/08/11,02/08/11,34,Views results will now be null when an error occurs,"Views results will now be null when an error occurs

Previously view results were returned whether there was an error
or not, the result would just contain empty lists. The new behavior
of returning null is more consistent to the way spymemcached handles
things and it is easier for developers to detect when they have made
an error.

Change-Id: Icec6b7c4aceb6ce6319672bb3a033921960488ad",0,0,0,0,0,1,1,0,0,
8595,I809da61f485a96312756ec26715e79f27199511c,http://review.couchbase.org/#/c/8595,5,ad64ebdc966dfbfc855daee5129e5e59b0ff4afe,d02465513441b7768d422fa688743410fea49c90,1,02/08/11,06/08/11,169,"SPY-17: setStale() and setGroup(bool, int) don't produce the correct query","SPY-17: setStale() and setGroup(bool, int) don't produce the correct query

This issue was found by a user and is now fixed. I also added a bunch
of unit tests that test each function in the Query class builds a set
of query parameters correctly.

Change-Id: I809da61f485a96312756ec26715e79f27199511c",0,1,1,0,0,1,1,0,0,
8597,Ica3d3d70f838bd619d8a9d8a5a40fb7dfca8d4e1,http://review.couchbase.org/#/c/8597,3,c41dd610e93a3299c8fd950140bea4337196d45f,b7bef80a5473855cd61be39ceaec9196f30ae20d,1,02/08/11,06/08/11,131,Added syncronous calls to CouchbaseClient for views,"Added syncronous calls to CouchbaseClient for views

Developers now have the option to make calls to Couchbase views
both synchronously and asynchronously.

Change-Id: Ica3d3d70f838bd619d8a9d8a5a40fb7dfca8d4e1",0,0,1,0,0,1,1,0,0,
8599,I23c107ca3459e3386270c53f9ce20450d7ee8830,http://review.couchbase.org/#/c/8599,1,d0e8e6f99f686e11a3966ec3595b1c6333d1c93f,7cbc7837286ced0fe335209c842715df03f9c57f,1,02/08/11,08/08/11,8,SPY-8: Added a limit on how many gets can be optimized,"SPY-8: Added a limit on how many gets can be optimized

We have a limit on the amount of sets that can be optimized so we
should have a limit on how many gets can be optimized as well. This
way people don't run into any issues with optimizing too many get
requests and having the client timeout as a result of the server
being too slow trying to fill all of the requests in the multi-
get.

The max number of gets that can be optimized into a single
request is 4096.

Change-Id: I23c107ca3459e3386270c53f9ce20450d7ee8830",0,0,1,0,0,1,1,0,0,
8644,Ib5700f44129e5be33fee86f05b153527f66e9c01,http://review.couchbase.org/#/c/8644,9,02f6957bbad1a85d7b4a6cb9c76d5bd166e7939e,daa374964957d27bb71a5f21c754cad67607757f,1,04/08/11,15/08/11,62120,Formatted code,"Formatted code

Change-Id: Ib5700f44129e5be33fee86f05b153527f66e9c01",0,1,1,1,1,1,1,0,0,
8680,I07a57fb676f91f14b74db1499f4cdc17fcd960ab,http://review.couchbase.org/#/c/8680,1,43ec069c4e9473f3ee7aaf1d8d67bef2761c8903,adf5171609510ee3489c33792730ef20072fade1,1,05/08/11,10/08/11,11,Spymemcached Issue 134: Performance fix,"Spymemcached Issue 134: Performance fix

Change-Id: I07a57fb676f91f14b74db1499f4cdc17fcd960ab",0,0,1,1,0,1,1,-1,0,
8973,I8617ac733a874063c6c5b1699f3d44e286bda750,http://review.couchbase.org/#/c/8973,14,ebd6f6de0ee76ccbb38a5e394ccbc962e82a97e1,ea68ffd59464e76eff20d113f26f7d72bec3b1af,0,15/08/11,24/08/11,1396,Changed buildfile to ivy/ant,"Changed buildfile to ivy/ant

The new ant script is integrated with git, provides better
junit test reports, allows us to check coding style, adds
findbugs functionality to help improved code performance
and eliminate bugs, and generates eclipse project files
for developers using eclipse.

Change-Id: I8617ac733a874063c6c5b1699f3d44e286bda750",0,1,1,0,1,1,1,NA,NA,
8984,I14a1a93db924728b087161cdbb98a5e34f9c3f73,http://review.couchbase.org/#/c/8984,1,bea259472e11757cb561feb3d758c754de7b9dbf,8d0de1bca0fed0df87fa09eae0dba25397484c85,1,16/08/11,16/08/11,2,Log warnings when retrying due to not my vbucket.,"Log warnings when retrying due to not my vbucket.

The existing behavior with not my vbucket errors prior to this
change would warn when it receives an error to the log, but it
would not followup that warning with any indication of what it
did with the operation.  This can cause confusion end users
are logging what's happening, so give the logging some symmetry
by logging any retries due to not-my-vbucket.

Change-Id: I14a1a93db924728b087161cdbb98a5e34f9c3f73",0,0,0,0,0,1,1,0,0,
8995,I5342fcbdd31a0ed93b58a3e6ee8be9f6f9f75259,http://review.couchbase.org/#/c/8995,1,8d0de1bca0fed0df87fa09eae0dba25397484c85,ec919e69455aa97634105638c5838fa50a2e39c5,0,16/08/11,16/08/11,2,Update commons-codec to 1.5 in .classpath for Eclipse.,"Update commons-codec to 1.5 in .classpath for Eclipse.

Change-Id: I5342fcbdd31a0ed93b58a3e6ee8be9f6f9f75259",0,0,0,1,0,1,1,NA,NA,
8997,I233c3c854adcfe4886e879e69f568807def595a7,http://review.couchbase.org/#/c/8997,1,aa5b4f19b986b3b17c46ee6a2cc55f2031568430,24dd4ff13ebc5a2450b2eef2f0df11b0ba125130,1,16/08/11,16/08/11,2,Log warnings when retrying due to not my vbucket.,"Log warnings when retrying due to not my vbucket.

The existing behavior with not my vbucket errors prior to this
change would warn when it receives an error to the log, but it
would not followup that warning with any indication of what it
did with the operation.  This can cause confusion end users
are logging what's happening, so give the logging some symmetry
by logging any retries due to not-my-vbucket.

This was brought over from the 2.7 refresh branch manually,
owing to the formatting change making it hard to cherry-pick.

Change-Id: I233c3c854adcfe4886e879e69f568807def595a7",0,0,0,0,0,1,1,0,0,
8998,Ie8a9548846932d2a11570a1ed2b7a5fdac1d3723,http://review.couchbase.org/#/c/8998,4,1fca9622c6599809bc802dfc165ea2a2c4c2ca7c,6f28a6c452950f2ffd1d55678b6a3438da2573ad,1,16/08/11,19/08/11,228,Added interface for view rows called ViewRow,"Added interface for view rows called ViewRow

Each row type that can be sent back from a view now has
getter functions for every possible field. If a field doesn't
exist for that view row and UnsupportedOperationException is
thrown. This new interface is now the only user facing object
that will be seen when dealing with view rows and as a result
makes the code simpler to use.

Change-Id: Ie8a9548846932d2a11570a1ed2b7a5fdac1d3723",0,1,1,0,0,1,1,0,0,
8999,I6c70fa7b478d17bf6fe16c9626567bd2844c3e0d,http://review.couchbase.org/#/c/8999,3,736be4e7e73ac69231aa25f6d40542849c086c8a,c7bd0b0d72d3cf963c941e20f0c4cc71207a5f70,1,16/08/11,19/08/11,22,Don't use + when appending to StringBuffer in ViewResponse classes,"Don't use + when appending to StringBuffer in ViewResponse classes

Using + inside the append function completely takes away the point
of using a StringBuffer in the first place. This code will perform
better.

Change-Id: I6c70fa7b478d17bf6fe16c9626567bd2844c3e0d",0,0,1,0,0,1,1,0,0,
9000,I5fb681e5fd8e958ec701703999a1cd9a2a729f86,http://review.couchbase.org/#/c/9000,4,1f2ebdadd9f2d654354b9cbcf82d512b9e26d565,58a1b2ead6b490dfb5b33b1cc1d7f22a740e66b7,1,16/08/11,19/08/11,123,ViewFuture now extends HttpFuture,"ViewFuture now extends HttpFuture

Now developers only have to worry about using HttpFuture's. This
simplifies the codebase

Change-Id: I5fb681e5fd8e958ec701703999a1cd9a2a729f86",0,1,1,0,0,1,1,0,0,
9001,I1231f645fad28e19e1f6c80c5e7eac634dcd671a,http://review.couchbase.org/#/c/9001,3,6f90720b673b156b7d46e9ba197516372a1b9082,6ed72cf525e13eef15b4802003307040fe4786b1,1,16/08/11,19/08/11,23,Renamed view row classes (now more descriptive),"Renamed view row classes (now more descriptive)

RowWithDocs -> ViewRowWithDocs
RowNoDocs   -> ViewRowNoDocs
RowReduced  -> ViewRowReduced

Change-Id: I1231f645fad28e19e1f6c80c5e7eac634dcd671a",0,0,1,0,0,1,1,0,0,
9002,I5338af0d014211b3c954cb7394bba38b268205b3,http://review.couchbase.org/#/c/9002,4,e53bc4e8261ce81ae33752907e99504cb12974d1,13c278e3c6061cb9bc3f3676a933f73647e684a3,1,16/08/11,19/08/11,296,Made ViewResponse classes more general,"Made ViewResponse classes more general

We now return a ViewResponse Object from all view calls
from CouchbaseClient.

Change-Id: I5338af0d014211b3c954cb7394bba38b268205b3",0,1,1,0,0,1,1,0,0,
9003,I5961da892c7327cc8981d19dcc2a31758b30bb95,http://review.couchbase.org/#/c/9003,4,2ec9a1ad4eb5284e95ff1063be0410d1cf22f12d,c9979cf06ac092ed727928141dbeea6db1e6dab7,1,16/08/11,19/08/11,47,"Changed ViewOperation,ViewsOperation to GetViewOperation, GetViewsOperation","Changed ViewOperation,ViewsOperation to GetViewOperation, GetViewsOperation

This renaming makes more sense for what the classes really do. These
are also none user facing classes so the long name will only be an
issue.

Change-Id: I5961da892c7327cc8981d19dcc2a31758b30bb95",0,1,1,0,0,1,1,0,0,
9004,I36387306a28818f8b20a49760dce2da60fd57f65,http://review.couchbase.org/#/c/9004,4,1e96e9c2153122d7fc783b6250dc8be828b3187d,615c7895a5be934b4469ebdc921fb9df4d4474be,1,16/08/11,19/08/11,201,Consolidated view operation classes into a single ViewOperation class.,"Consolidated view operation classes into a single ViewOperation class.

Change-Id: I36387306a28818f8b20a49760dce2da60fd57f65",0,1,1,1,0,1,1,0,0,
9005,Iafd910ca8e837fc5d14b9041adc9fc267e324fbe,http://review.couchbase.org/#/c/9005,2,63bc7d953e3b72198e34d03d914bbadc6e9edc44,8c94fff3fba8f0d3a89c1659604f0b8c5f21debd,1,16/08/11,19/08/11,125,Refactored ViewResponse classes,"Refactored ViewResponse classes

ViewResponse is now an abstract class.

Change-Id: Iafd910ca8e837fc5d14b9041adc9fc267e324fbe",0,0,1,0,0,1,1,0,0,
9006,I21b0ababa452ff760e3c0b8ddf72a9a8ed3fdc24,http://review.couchbase.org/#/c/9006,3,3d37d3fa94bf6ab8ba5d123f8fecc5cb1f1aadfc,834ec4fc383a771539d1bd82fe6230db9eb4c4dc,1,16/08/11,19/08/11,127,Consolidated query functions in CouchbaseClient,"Consolidated query functions in CouchbaseClient

Now there is only one query function.

Change-Id: I21b0ababa452ff760e3c0b8ddf72a9a8ed3fdc24",0,0,1,0,0,1,1,0,0,
9015,Ie08828974e0f3ea090abb708951eb425ce99821c,http://review.couchbase.org/#/c/9015,2,8a9c874b8be8fed6df0f596b4334eaa6530d09e4,c8f38d54f2f79fd65099f079366a76719038d220,1,16/08/11,17/08/11,19,SPY-29: Default mode should be production mode,"SPY-29: Default mode should be production mode

CouchbaseClient is now configured to be in produciton mode by
default instead of being in development mode as it previously
was.

Change-Id: Ie08828974e0f3ea090abb708951eb425ce99821c",0,0,0,0,0,1,1,0,0,
9110,I59f47614bbf555ce6104ea26117d83bfa0b091fe,http://review.couchbase.org/#/c/9110,1,7106b2f1d423b5793c38e533931b9e388b31e853,910e9329300b5c692169fa7cc436eb5d347f587e,1,18/08/11,24/08/11,2,Fixed issue with the CouchDB connection not closing.,"Fixed issue with the CouchDB connection not closing.

MemcachedConnection was returning false when the shutdown
function was called even when the connection was closed correctly.
As a result the CouchConnection wasn't shutting down properly. The
issue had to do with having false be the default return value when
it should have been true.

Change-Id: I59f47614bbf555ce6104ea26117d83bfa0b091fe",0,0,1,0,0,1,1,0,0,
9111,I970ee3e93332ef5f562bdf932564ca4d25d4cc26,http://review.couchbase.org/#/c/9111,3,910e9329300b5c692169fa7cc436eb5d347f587e,3b9eff76d5f38b7c37eeda686a29366fc4f623a7,1,18/08/11,24/08/11,274,Added pagination.,"Added pagination.

Change-Id: I970ee3e93332ef5f562bdf932564ca4d25d4cc26",0,0,1,1,0,1,1,1,1,
9161,I0af0c9ce60c28a8838266d9b0d67855f773ac51f,http://review.couchbase.org/#/c/9161,2,7eac25e634ae930a671f14c30c6e5a2b9305576a,b699ac570cbd960506a0af39939f86e31e3e8b17,0,22/08/11,24/08/11,19,Added a mvn-install target to build.xml,"Added a mvn-install target to build.xml

Allows users to install the latest source jars to their local
maven repository.

Change-Id: I0af0c9ce60c28a8838266d9b0d67855f773ac51f",0,0,0,0,0,1,1,NA,NA,
9162,I9584668161636935bfa7b7a8d69347e99f7d3c6f,http://review.couchbase.org/#/c/9162,2,9d93bc404d238fc56acf0c0cd0f88560a6e41c9a,22d56caa2116c0ff84628705568f692e1e562a45,0,22/08/11,24/08/11,1,Updated .gitignore to exclude bin/ directory,"Updated .gitignore to exclude bin/ directory

Change-Id: I9584668161636935bfa7b7a8d69347e99f7d3c6f",0,0,0,1,0,1,1,NA,NA,
9199,I3b6ec598ae1032b6bab525651f660f01823bfa1b,http://review.couchbase.org/#/c/9199,2,7717447a868c8a577bcba51cec70c0f721c1664f,3a5e377c53bc3992ce485c99d3a51201a110c3e6,1,23/08/11,24/08/11,9,Perf Improvement: Changed String +'ing to StringBuffer in Query class,"Perf Improvement: Changed String +'ing to StringBuffer in Query class

Change-Id: I3b6ec598ae1032b6bab525651f660f01823bfa1b",0,0,0,1,0,1,1,0,0,
9223,I36eac0b5ca675ebe76ffe97e56e5fcf90b0916b2,http://review.couchbase.org/#/c/9223,4,ee1c31c1a11d5395ac711c0397b8b55096445d99,adabbc8a787fb89d2d63e66e0a137955b56fd28f,1,24/08/11,25/08/11,62,Operations can't timeout when writing to the write buffer,"Operations can't timeout when writing to the write buffer

We implemented a mechanism for operations to be able to timeout
while waiting to be written to a socket, but failed to take into
account the fact that an item can timeout while in the middle
of writing to that buffer.

This commit adds a new OperationState called WRITE_QUEUED that
specifies that the operation is waiting to be written to the
write buffer. When an operation begins writing to the write
buffer it goes into the WRITING state. When an operation is in
the WRITING state it cannot time out.

Change-Id: I36eac0b5ca675ebe76ffe97e56e5fcf90b0916b2",0,1,0,0,0,1,1,0,0,
9225,I25322fe5a2f55ad19f9cbff5654b842599495c52,http://review.couchbase.org/#/c/9225,3,4ca2333ce8cccf260c13442f26e4471ac80b6438,c08914769c4395751834088b211c22deebae1112,1,24/08/11,03/09/11,14,SPY-125: Significant performance issue largse number of sets,"SPY-125: Significant performance issue largse number of sets

We now add an operation to the read queue when we transistion it
into a WRITING state. This gaurantees that the operation is added
to the read queue once. As a result we no longer have to check to
see if the operation has already been added to the read queue.

Change-Id: I25322fe5a2f55ad19f9cbff5654b842599495c52",0,0,0,0,0,1,1,0,0,
9226,I2e216fb18c1789ce333a5bef28c56806a2d52180,http://review.couchbase.org/#/c/9226,1,8ee226a2e72fcd84816a9d52b9009759a7a63b6d,6f34f62d334c4ae5b0a79b71fd3cb2874ccf062a,1,24/08/11,03/09/11,53,Improved performance of write queue processing during timeouts,"Improved performance of write queue processing during timeouts

There were two major issues here. First if there are a lot of
timeouts in a row then we processing the write queue we removed
them only one at a time. We now are able to process the entire
write queue each time the handleIO function is called. The
second issue was that it is possible to send timed out requests
to the server. This would happen if there was one not timed out
request followed by some timed out requests. Since in the while
loop we don't check to see if an operation is timed out (or
cancelled) we would send it anyways. This commit addresses both
of these issues by adding a getNextWritable() op which only
operations that should be written. If the write queue is empty
it returns null.

Change-Id: I2e216fb18c1789ce333a5bef28c56806a2d52180",0,0,0,0,0,1,1,-1,0,
9227,I30806fd456e24761e8e88a1e5f4688e7f63290a6,http://review.couchbase.org/#/c/9227,1,d436b8f2300e25fad960b40d6da2f1a81f144e38,d118cd60a4420945c783d3c51d58516d1c44d6e2,0,24/08/11,24/08/11,12,Alphabetized the .gitignore file,"Alphabetized the .gitignore file

Change-Id: I30806fd456e24761e8e88a1e5f4688e7f63290a6",0,0,0,1,0,1,1,NA,NA,
9370,I9317453ab6e4fd3d03493d70adef79b0c06ec683,http://review.couchbase.org/#/c/9370,1,a3a89fb4dbdace4e6c36dc5f1569cf65369ffd14,76443d1c4f207371cffef0ba5ee5a522bde2b4f7,1,03/09/11,04/09/11,2,SPY-28: rename CouchbaseClient config file,"SPY-28: rename CouchbaseClient config file

client.properties -> cbclient.properties

Change-Id: I9317453ab6e4fd3d03493d70adef79b0c06ec683",0,0,0,0,0,1,1,0,0,
9387,Ia38180d53a10ce2f370971dc6c65869f9e953e95,http://review.couchbase.org/#/c/9387,2,c4be24cb01e8737e7e01f51e927ac4e96be95579,3468035623d45b6750e8c6b10988ac44cff9f698,1,05/09/11,07/09/11,14,SPY-46: Change StringBuffer to StringBuilder,"SPY-46: Change StringBuffer to StringBuilder

Change-Id: Ia38180d53a10ce2f370971dc6c65869f9e953e95",0,0,0,1,0,1,1,0,0,
9389,I4291caf70e28db19adb1754b5db6cdd364ef836a,http://review.couchbase.org/#/c/9389,4,9f99ea1f7cd4a61be4126c3f439c6a51aa1199ad,a60ad9852b0199a0bcc2f03dbe72d9daeb8e8b37,1,05/09/11,19/10/11,200,"SPY-48: Incr/Decr param ""by"" should be a long","SPY-48: Incr/Decr param ""by"" should be a long

Change-Id: I4291caf70e28db19adb1754b5db6cdd364ef836a",0,1,0,1,0,1,1,0,0,
9393,I5fd48c52aacc205e3ec184d21f47249427a11c5d,http://review.couchbase.org/#/c/9393,3,0d90395a95c0dea66cb018b3fed7e8132c98c0fe,8441c404e695fcf2c670ecbacaa3476212b21aba,0,06/09/11,07/09/11,12,SPY-43: mvn-install target now installs javadocs to local maven dir,"SPY-43: mvn-install target now installs javadocs to local maven dir

Change-Id: I5fd48c52aacc205e3ec184d21f47249427a11c5d",0,0,0,1,0,1,1,NA,NA,
9394,I74a81f7786a5557ffb7d7a6aeb17294a4d04cb5a,http://review.couchbase.org/#/c/9394,3,83170de1a6e033893a320144a78213c697271d19,316af15b61315036a342d8ffa097ce687246a429,1,06/09/11,07/09/11,25,SPY-49: BaseSerializingTranscoder.decompress() does not close resources,"SPY-49: BaseSerializingTranscoder.decompress() does not close resources

Change-Id: I74a81f7786a5557ffb7d7a6aeb17294a4d04cb5a",0,0,0,1,0,1,1,0,0,
9402,I280f31ed47922e27da3d5dc82f640c114d6014d7,http://review.couchbase.org/#/c/9402,4,3a9623cdf0167f5d10326d1b2a870506aadb8d9e,a9b939009fd38496b49e89f23a5056aa6bf70981,1,06/09/11,06/09/11,136,"Fix concurrent access to operations objects, especially near timeouts.","Fix concurrent access to operations objects, especially near timeouts.

We discovered that having one thread call get() on futures with a
timeout much shorter than the timeout built into the client could
(after a while) reliably kill off the IO thread with a
NullPointerException. After restarting with assertions enabled, we
found many other ways to make the IO thread die relating mostly to
operations that were canceled or timed out in one thread while they
were being used in another thread.

The solution to this is to make ""timing out"" an operation something
similar to ""cancel"" - that is, not a state of the operation's state
machine, but just a flag. Then, since this flag (as with the cancelled
flag) can be read and set from multiple threads, synchronize the
methods that do that.

Ideally, transitionState and getState would never be called outside
the IO thread; however, since at least getState is currently, both
getState and transitionState should then also be synchronized.

With these changes, we don't end up killing off the IO thread anymore.

Change-Id: I280f31ed47922e27da3d5dc82f640c114d6014d7",0,1,0,0,0,0,1,-1,0,
9403,I44ba7f8e9c42e648b0169954b33eb87cf19f2b70,http://review.couchbase.org/#/c/9403,5,7a25a8f5fc7a0d23a7f5e8317e8cb44f9faf45de,ac5b8f2af4f81b6b13086757176dd51b339c0159,1,06/09/11,06/09/11,9,Use direct buffers in TCPMemcachedNodeImpl,"Use direct buffers in TCPMemcachedNodeImpl

Since the buffers in a TCPMemcachedNodeImpl are allocated rarely (only
on client creation or reconfigure), and are passed to Channel.read()
and Channel.write() repeatedly, it's best to use direct buffers to
avoid http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6214569

Change-Id: I44ba7f8e9c42e648b0169954b33eb87cf19f2b70",0,1,0,0,0,0,1,0,0,
9424,Ib4ed9e1764c31e9270f79206b11574d98638e989,http://review.couchbase.org/#/c/9424,1,845f748d103fd23c75eb5525d3c5f872340aab0e,bf649a2f2afd2a485acd78e46050c41e4f94a52b,1,06/09/11,06/09/11,66,Operations can't timeout when writing to the write buffer.,"Operations can't timeout when writing to the write buffer.

We implemented a mechanism for operations to be able to timeout
while waiting to be written to a socket, but failed to take into
account the fact that an item can timeout while in the middle
of writing to that buffer.

This commit adds a new OperationState called WRITE_QUEUED that
specifies that the operation is waiting to be written to the
write buffer. When an operation begins writing to the write
buffer it goes into the WRITING state. When an operation is in
the WRITING state it cannot time out

Change-Id: Ib4ed9e1764c31e9270f79206b11574d98638e989",1,0,0,0,0,0,1,0,0,
9425,I0b21d3e1ac7ff7792afabc57c1a8a26c6b757c12,http://review.couchbase.org/#/c/9425,1,bf649a2f2afd2a485acd78e46050c41e4f94a52b,a3332d9aad0d0d6ecd26c4abd0a339c1a8e0ef66,1,06/09/11,06/09/11,14,SPY-125: Significant performance issue large number of sets,"SPY-125: Significant performance issue large number of sets

We now add an operation to the read queue when we transistion it
into a WRITING state. This guarentees that the operation is added
to the read queue once. As a result we no longer have to check to
see if the operation has already been added to the read queue

Change-Id: I0b21d3e1ac7ff7792afabc57c1a8a26c6b757c12",1,0,0,0,0,0,1,0,0,
9428,I1a5eed9d8f96d9d9dd83d251794b68840f595621,http://review.couchbase.org/#/c/9428,3,674a828fd0c16b427cb686f811eefe6eb23a4aa3,facd0cee20b905ddc9d274a36b01d44c557b347f,1,06/09/11,20/09/11,24,SPY-51: Bug in OperationImpl's decodeLong(2),"SPY-51: Bug in OperationImpl's decodeLong(2)

We were incrrectly decoding long values here. For example,

0 0 0 1 0 0 0 0

was being decoded as 1, but should have been 4294967296.

Change-Id: I1a5eed9d8f96d9d9dd83d251794b68840f595621",0,0,1,0,0,1,1,0,0,
9429,I427e5a47cf2e8ad89e3f59c895f3ef8e0ad36550,http://review.couchbase.org/#/c/9429,1,f6b57ee69bd34a1fab4667ea5dad68c084332db9,91de0b5f116d1270bbb6ea84b4f79fa66da322a2,1,06/09/11,06/09/11,51,Improved performance of write queue processing during timeouts,"Improved performance of write queue processing during timeouts

There were two major issues here. First if there are a lot of
timeouts in a row then we processing the write queue we removed
them only one at a time. We now are able to process the entire
write queue each time the handleIO function is called. The
second issue was that it is possible to send timed out requests
to the server. This would happen if there was one not timed out
request followed by some timed out requests. Since in the while
loop we don't check to see if an operation is timed out (or
cancelled) we would send it anyways. This commit addresses both
of these issues by adding a getNextWritable() op which only
operations that should be written. If the write queue is empty
it returns null.

Change-Id: I427e5a47cf2e8ad89e3f59c895f3ef8e0ad36550",1,0,0,0,0,0,1,-1,0,
9431,Ice7bac2ba1e2dbcd2004f5d7920944eef6bbbcb8,http://review.couchbase.org/#/c/9431,1,da740341135ca75471a204885726e93f30797438,023f27ca568eab2d595e55eb0c367d2995078b24,1,06/09/11,06/09/11,147,"Fix concurrent access to operations objects, especially near timeouts","Fix concurrent access to operations objects, especially near timeouts

We discovered that having one thread call get() on futures with a
timeout much shorter than the timeout built into the client could
(after a while) reliably kill off the IO thread with a
NullPointerException. After restarting with assertions enabled, we
found many other ways to make the IO thread die relating mostly to
operations that were canceled or timed out in one thread while they
were being used in another thread.

The solution to this is to make ""timing out"" an operation something
similar to ""cancel"" - that is, not a state of the operation's state
machine, but just a flag. Then, since this flag (as with the cancelled
flag) can be read and set from multiple threads, synchronize the
methods that do that.

Ideally, transitionState and getState would never be called outside
the IO thread; however, since at least getState is currently, both
getState and transitionState should then also be synchronized.

With these changes, we don't end up killing off the IO thread anymore.

Change-Id: Ice7bac2ba1e2dbcd2004f5d7920944eef6bbbcb8",0,0,0,0,0,0,0,0,0,
9435,I4fafa41e9072aa514e2da97a977c6ac6adc759d5,http://review.couchbase.org/#/c/9435,1,023f27ca568eab2d595e55eb0c367d2995078b24,09ecb1522e7ce2be53312894a0975a7159e5dd1d,1,06/09/11,06/09/11,8,Use direct buffers in TCPMemcachedNodeImpl,"Use direct buffers in TCPMemcachedNodeImpl

Since the buffers in a TCPMemcachedNodeImpl are allocated rarely (only
on client creation or reconfigure), and are passed to Channel.read()
and Channel.write() repeatedly, it's best to use direct buffers to
avoid http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6214569

Change-Id: I4fafa41e9072aa514e2da97a977c6ac6adc759d5",0,0,0,0,0,0,0,0,0,
9436,I4b7e02f839074f80909d4f0fb44b707b76a1a5d5,http://review.couchbase.org/#/c/9436,1,09ecb1522e7ce2be53312894a0975a7159e5dd1d,7b642ceb344efa5f79b3f198dde19ec88d01d2c2,1,07/09/11,07/09/11,2,Remove assertions that assert a completed op isn't timed out,"Remove assertions that assert a completed op isn't timed out

Matt was trying to assure we weren't erroneously marking something
timedout that had been completed. The timeout can come from either
the IO thread or the latch from the asynch call. Now that we have
synchronized methods this shouldn't happen.

Change-Id: I4b7e02f839074f80909d4f0fb44b707b76a1a5d5",0,0,0,0,0,1,1,0,0,
9437,I26a215ac2f4f10bc90f0fcc0c1c9956991f63abb,http://review.couchbase.org/#/c/9437,1,26e31757beeae05309055195165925efafa84022,765c7d7f06bbf6576e58a06b90a3f2efef92ddd3,1,07/09/11,07/09/11,6,Remove assertions that assert a completed op isn't timed out,"Remove assertions that assert a completed op isn't timed out

Matt was trying to assure we weren't erroneously marking something
timedout that had been completed. The timeout can come from either
the IO thread or the latch from the asynch call. Now that we have
synchronized methods this shouldn't happen.

Change-Id: I26a215ac2f4f10bc90f0fcc0c1c9956991f63abb",0,0,0,0,0,1,1,0,0,
9438,I015132f87ebeb8b19625327e0be54775770bb907,http://review.couchbase.org/#/c/9438,1,765c7d7f06bbf6576e58a06b90a3f2efef92ddd3,6409a301109bdcca6527406579e5c5c49a39fa81,1,07/09/11,07/09/11,16,Change getBytes() to getData() in CASOperation,"Change getBytes() to getData() in CASOperation

The getBytes function was incorrectly named in the CASOperation
class for two reasons. First the function actually gets the
data field from a message so getData() is a better name. Second,
in the StoreOperation class and other classes the name of the
function is getData() so this improves consistency. This issue
was notice when I was looking at the StoreOperation and saw that
this class had two different functions that did exactly the same
thing.

Change-Id: I015132f87ebeb8b19625327e0be54775770bb907",0,0,0,0,0,1,1,0,0,
9442,Ib4dc76a2bacc44f2af148a3d576c018f5dfc2d95,http://review.couchbase.org/#/c/9442,1,c62f9da7c04f9e394351fe2eee570956558133ac,556c82134708d822489dfca13d62b531bba8f65b,0,07/09/11,07/09/11,5,"Add support for commons-codec 1.3, 1.4, and 1.5","Add support for commons-codec 1.3, 1.4, and 1.5

Some versions of commons-codec append a \r\n onto the end
of Base64 encoded strings. This fix checks the encoding for
a trailing \r\n and if it finds one, removes if from the
string.

Change-Id: Ib4dc76a2bacc44f2af148a3d576c018f5dfc2d95",0,0,0,0,0,1,1,NA,NA,
9443,I9b23a19608bfa91cba64e0d579fb49f20612b286,http://review.couchbase.org/#/c/9443,1,bd10da1e1e51e747e054db00d5c915406fba4c70,984c58a0fec38339e5741ac2a9c4f78d0315591c,0,07/09/11,07/09/11,4,"Add support for commons-codec 1.3, 1.4, and 1.5","Add support for commons-codec 1.3, 1.4, and 1.5

Some versions of commons-codec append a \r\n onto the end
of Base64 encoded strings. This fix checks the encoding for
a trailing \r\n and if it finds one, removes if from the
string.

Change-Id: I9b23a19608bfa91cba64e0d579fb49f20612b286",1,0,0,0,0,0,1,NA,NA,
9450,Ia642727d9a9599f22551bf7783c8925b3f3feaf1,http://review.couchbase.org/#/c/9450,1,80288a8a87fdd757b75faabcba23a7683770ecb9,18990a1ec63ec3976d826f4ebc2724a3d7903adb,0,07/09/11,07/09/11,2,Removed unused variables in GetOperationImpl,"Removed unused variables in GetOperationImpl

Change-Id: Ia642727d9a9599f22551bf7783c8925b3f3feaf1",0,0,0,1,0,1,1,NA,NA,
9452,I3d512837f31d5e4d46096235a49f65245895de77,http://review.couchbase.org/#/c/9452,2,8cd8169c5b575810997977dd01231c330ac26098,42ee1e728ffefb7f41bdb218bd43638a2c5f449c,1,07/09/11,25/09/11,12,SPY-26: Add Getl Tests,"SPY-26: Add Getl Tests

Change-Id: I3d512837f31d5e4d46096235a49f65245895de77",0,0,1,1,0,1,1,0,0,
9454,Ifa6b356a9faaad39f12f2cf28d34fbc837faa7b7,http://review.couchbase.org/#/c/9454,1,a151286bd90c12412348deccdcff98027f2f7711,c889af93bae6b1a1e8bd783d7bdbef8edb499cf7,1,07/09/11,07/09/11,24,SPY-49: BaseSerializingTranscoder does not close resources.,"SPY-49: BaseSerializingTranscoder does not close resources.

Change-Id: Ifa6b356a9faaad39f12f2cf28d34fbc837faa7b7",1,0,0,1,0,0,1,0,0,
9455,I3c52dfd21b7b02ea4e9d5f97fd7ed9b034ca0237,http://review.couchbase.org/#/c/9455,1,c889af93bae6b1a1e8bd783d7bdbef8edb499cf7,af33d50cbabfa46cf03fe9b39e629e6cc0465173,0,07/09/11,07/09/11,2,Removed unused variables in GetOperationImpl,"Removed unused variables in GetOperationImpl

Change-Id: I3c52dfd21b7b02ea4e9d5f97fd7ed9b034ca0237",1,0,0,1,0,0,1,NA,NA,
9462,I1dc91641016fa31e5cdd51f5bba85bd7cd68bd45,http://review.couchbase.org/#/c/9462,2,5c43d6f65bae50bcee9738a79bfa978b1e54dc80,19b04305607d80092f6e2b4b982538f649af95c0,1,07/09/11,09/09/11,42,SPY-50: Set viewmode programatically,"SPY-50: Set viewmode programatically

We can now set properties programatically and I allowed the
properties file to be found in the classpath (which I thought
I did before, but I guess I didn't). There is now a heirarchy
for how this parameter can be defined. The list is below from
highest priority to lowest:

1. Set in user code - System.setProperty(2)
2. Set on the command line
3. Set in the cbclient.properties file

Change-Id: I1dc91641016fa31e5cdd51f5bba85bd7cd68bd45",0,0,0,0,0,1,1,0,0,
9472,I840259953d1d5192f1038e734103b63281e68ed0,http://review.couchbase.org/#/c/9472,2,a67c1fe65873ccbe38025f89f4156eb32083b37a,d1ce9a5115d5e9d3c6a5da3f8467a6c6a8e789d9,1,08/09/11,09/09/11,47,Added toString() functions to ConnectionFactory classes,"Added toString() functions to ConnectionFactory classes

This will allow us to see how users have configured their client
and will greatly help in debugging issues from customers.

Change-Id: I840259953d1d5192f1038e734103b63281e68ed0",0,0,0,0,0,1,1,0,0,
9473,Ic8f3741bdcdc97d5bb46b2c4a68caec998903fde,http://review.couchbase.org/#/c/9473,2,91b83b82179e269ddfd8cd7603191ecd877f4bb8,2718db34409ee8cd05378d196df67ee872d0f58e,1,08/09/11,09/09/11,27,SPY-47: Client object should have toString(),"SPY-47: Client object should have toString()

The toString() method in MemcachedClient now prints out it's
configuration eg. the information of the ConnectionFactory it
is using.

Change-Id: Ic8f3741bdcdc97d5bb46b2c4a68caec998903fde",0,0,0,0,0,1,1,0,0,
9474,I4d0c95f309a6f1bb1ccde52ffdf6e9ab1958bebe,http://review.couchbase.org/#/c/9474,1,ea31ccf19e32e2b7fcc5c5a798ead5c6c380df71,565f1fdd297bc6c14c1e845e9f134d306b6338f2,1,08/09/11,09/09/11,22,Change getBytes() to getData() in CASOperation,"Change getBytes() to getData() in CASOperation

The getBytes function was incorrectly named in the CASOperation
class for two reasons. First the function actually gets the
data field from a message so getData() is a better name. Second,
in the StoreOperation class and other classes the name of the
function is getData() so this improves consistency. This issue
was notice when I was looking at the StoreOperation and saw that
this class had two different functions that did exactly the same
thing.

Change-Id: I4d0c95f309a6f1bb1ccde52ffdf6e9ab1958bebe",0,0,0,0,0,1,1,0,0,
9475,Ie3ea5b8d04b683303fe8e5f4d5b7b22d7d5bd18b,http://review.couchbase.org/#/c/9475,2,71c30699f1b1f64676d14a0e8245c5facd6aaf20,f36bd9dabf71656e8e725e57bba65b0a54949118,1,08/09/11,09/09/11,319,SPY-39: Added toString() to operation heirarchy,"SPY-39: Added toString() to operation heirarchy

Change-Id: Ie3ea5b8d04b683303fe8e5f4d5b7b22d7d5bd18b",0,0,0,1,0,1,1,0,0,
9476,Ia6b32a4af94ed2e8dc973237132f3fd291655634,http://review.couchbase.org/#/c/9476,4,95ecb766fdc976e506a5ab1ae6b0d6399942817e,ab7ff7173e131ed82da3881f6692ccd64befdf18,1,08/09/11,20/09/11,97,Made cmd variable a byte for binary operations.,"Made cmd variable a byte for binary operations.

This variable should have never been an int since it is defined in
the protocol as a byte. The reason for the change is that when we
have opcode that is greater have 127 the value of a byte and an int
are different (Ex. int = 128 byte = -127). This was causing an
assertion to fail, in this case for the getl command (0x94).

Change-Id: Ia6b32a4af94ed2e8dc973237132f3fd291655634",0,1,1,0,0,1,1,0,0,
9477,I322433f6eafbdc9261cc40f322b8362e113646b7,http://review.couchbase.org/#/c/9477,2,23a621d23d91903fa2806092513dcdb9397f9211,1ac0606816f763264fab29e2458a4547d04c97b4,1,09/09/11,09/09/11,1124,Merge branch 'refresh',"Merge branch 'refresh'

Changes Merged:
	Removed unused variables in GetOperationImpl
	SPY-49: BaseSerializingTranscoder does not close resources.
	Remove assertions that assert a completed op isn't timed out
	Add support for commons-codec 1.3, 1.4, and 1.5
	Use direct buffers in TCPMemcachedNodeImpl
	Fix concurrent access to operations objects, especially near timeouts
	Improved performance of write queue processing during timeouts
	SPY-125: Significant performance issue large number of sets
	Operations can't timeout when writing to the write buffer.

Conflicts:
	.classpath
	src/main/java/net/spy/memcached/MemcachedConnection.java
	src/main/java/net/spy/memcached/internal/BulkGetFuture.java
	src/main/java/net/spy/memcached/ops/BaseOperationFactory.java
	src/main/java/net/spy/memcached/ops/OperationState.java
	src/main/java/net/spy/memcached/protocol/BaseOperationImpl.java
	src/main/java/net/spy/memcached/protocol/TCPMemcachedNodeImpl.java
	src/main/java/net/spy/memcached/protocol/ascii/AsciiMemcachedNodeImpl.java
	src/main/java/net/spy/memcached/protocol/binary/BinaryMemcachedNodeImpl.java
	src/main/java/net/spy/memcached/protocol/binary/GetOperationImpl.java
	src/main/java/net/spy/memcached/transcoders/BaseSerializingTranscoder.java
	src/main/java/net/spy/memcached/vbucket/ConfigurationProviderHTTP.java

Change-Id: I322433f6eafbdc9261cc40f322b8362e113646b7",0,0,0,0,1,1,1,-1,0,
9513,I9fc07dd898205612b384f8c4e9820cb186f8e550,http://review.couchbase.org/#/c/9513,1,23522ab9d60cf117675989ecbc8fa8d14620ac0f,8302e8e3478711edbc87cff575029ed275209345,1,12/09/11,12/09/11,3,SPY-54: getBulk() shouldn't log a warning when a key is not found,"SPY-54: getBulk() shouldn't log a warning when a key is not found

A key not being found is not incorrect behavior for memcached so
having a warning here is incorrect.

Change-Id: I9fc07dd898205612b384f8c4e9820cb186f8e550",0,0,0,0,0,1,1,0,0,
9514,Id8cf17132bff06dba78935cbb8b81d83f58b4bc2,http://review.couchbase.org/#/c/9514,5,ea098a48c7a9a4c50645e471177f88367e536aa1,f682877ddde4b66d7e77cc5e3d2caa028b03f93e,1,12/09/11,03/10/11,10,SPY-37 & SPY-38: Fixed redistribution performance issue,"SPY-37 & SPY-38: Fixed redistribution performance issue

This issue was caused by a O(n^3) algorithm used when redistributing
operations among nodes. It turns out that one of the loops was not
neccessary because the clone operation is gaurenteed to return a
list of single key operations. Multi-key operations are never
returned as part of this list.

The fix involves removing the one of these loops. which frequently
queued duplicate operations for transmission. Since the
operations are all single key, the list returned by the call
getKeys() is gaurenteed to have only one operation.

Change-Id: Id8cf17132bff06dba78935cbb8b81d83f58b4bc2",0,1,0,0,0,1,1,0,0,
9526,If8fc5e7f8b6aeb41ed68c2acb03fba5b7e503836,http://review.couchbase.org/#/c/9526,6,9dda712bda172d6f6f9ae75215d6aaa14e0dae05,275733f43f9cab445bbc3413914dba0feac62cb5,1,12/09/11,12/09/11,6,Send an ack for all tap messages,"Send an ack for all tap messages

Previously we ignored tap opaque and no-op messages. This caused
us to hang tap streams in some cases. One example is when doing a
tap dump. The server would send an opaque message and wait for an
ack after transmitting all of the data. Since we ignored the opaque
message the server would wait for an ack that would never be sent.
This would cause the connection to hang.

Change-Id: If8fc5e7f8b6aeb41ed68c2acb03fba5b7e503836",0,1,0,0,0,0,1,0,0,
9531,Idca74e4ca51b99216779f1c3b8d6c5dc83feaea2,http://review.couchbase.org/#/c/9531,4,564cfe42fb281404bb5048d4156a7fa63fdf7059,7883268ae70df0c71a908bf6abf912d15ffcc7ef,1,12/09/11,16/09/11,19,Added function to get number of vBuckets to MembaseClient,"Added function to get number of vBuckets to MembaseClient

This is needed by the Couchbase-Hadoop connector

Change-Id: Idca74e4ca51b99216779f1c3b8d6c5dc83feaea2",0,1,1,0,0,1,1,0,0,
9568,I1a8fab0229fd29b1545ffe5e826b5769f5bbfe00,http://review.couchbase.org/#/c/9568,1,cddd6baf64cfea4fb7185af037b8ba96ef1eae5d,0ba4fcea37c98f93981181b83bb35c7470031cf8,1,13/09/11,16/09/11,1151,Merge branch 'refresh',"Merge branch 'refresh'

Changes Merged:
	Send an ack for all tap opaque messages
	SPY-54: getBulk() shouldn't log a warning when a key is not found
	SPY-47: Client object should have toString()
	Added toString() functions to ConnectionFactory classes
	SPY-39: Added toString() to operation heirarchy
	Change getBytes() to getData() in CASOperation

Change-Id: I1a8fab0229fd29b1545ffe5e826b5769f5bbfe00",0,0,1,0,1,1,1,0,0,
9576,I0776f3c24fcb6ff64993da2b3b065e381459ab21,http://review.couchbase.org/#/c/9576,1,0ba4fcea37c98f93981181b83bb35c7470031cf8,27378fc4e90182173468a2269199b3dc3949655b,1,13/09/11,16/09/11,57,Operations statuses on errors are now handled by the operation,"Operations statuses on errors are now handled by the operation

When asking for the status the future will no longer have to call
the get() function to get the status. This is also much cleaner
code than what was previously done.

Change-Id: I0776f3c24fcb6ff64993da2b3b065e381459ab21",0,0,1,0,0,1,1,0,0,
9591,I13830b22f58bfa132891a2111e5b4675a297ec51,http://review.couchbase.org/#/c/9591,1,5cf104060d0d7e710e6cb118a1cfc30e84df32fe,904dd1a252b0012e6001daf5f55cfdaa58ab96b1,1,14/09/11,14/09/11,1,Fixed test failure issue in testIPv6Host() in AddrUtilTest,"Fixed test failure issue in testIPv6Host() in AddrUtilTest

And ipv6 address can return a hostname of 0:0:0:0:0:0:0:1 so
it needs to be added to the list of valid hostnames that can
be returned.

Change-Id: I13830b22f58bfa132891a2111e5b4675a297ec51",0,0,0,0,0,0,0,0,0,
9613,I1e793514e8b1df1dbcdb133fba7cec837994b6d9,http://review.couchbase.org/#/c/9613,1,60d4f3edbe368d90579e8f23aabcd246a298c777,e41195ab7895f0aaaadc502e3b7128a3b0f47e4f,1,15/09/11,22/10/11,17,Fixed testOverflowing ReadQueue in QueueOverflowTest,"Fixed testOverflowing ReadQueue in QueueOverflowTest

The issue with this test failing inconsistently has to do with
how many operations are in the input queue when the first
queue overflow occurs. The queue size is 5 and if there are more
than 5 operations in the input queue then this will cause a second
queue overflow when we try to do our final operation. This fix
corrects the error by making sure that we drain all of the
operations from the write queue and therefore make sure that there
is actually space for the last operation.

Change-Id: I1e793514e8b1df1dbcdb133fba7cec837994b6d9",0,0,0,0,0,1,1,0,0,
9641,Ib5acb8514da7f1df7893936dd3ed9ab7b4884b1e,http://review.couchbase.org/#/c/9641,1,b9e62b3fe5d393022a096550a1932c18a58177a6,d762a51374777431a5a962e08cbbf962f8b04cba,0,16/09/11,16/09/11,22,Deleted files that accidentally got included in the last merge,"Deleted files that accidentally got included in the last merge

Change-Id: Ib5acb8514da7f1df7893936dd3ed9ab7b4884b1e",1,0,0,1,0,0,1,NA,NA,
9674,I76cea19b3b74cceee3316f39d0565b9959547867,http://review.couchbase.org/#/c/9674,1,c5159f850be925824f1334ce75354bb25662cbec,814462528d8402d1d90408d8fab0c263e67891fb,1,20/09/11,24/09/11,3,Removed extra variables in tapCustom header,"Removed extra variables in tapCustom header

We abandoned my rudamentry key/value filter change a while ago but
the tapCustom signature was never updated.

Change-Id: I76cea19b3b74cceee3316f39d0565b9959547867",0,0,1,0,0,1,1,0,0,
9678,I07fcc169a34dd5d14156c82ebdc1a99c785992de,http://review.couchbase.org/#/c/9678,2,9c2d16ff04136792b386baaf297abaff74f9a69d,beef3c2829e9507ddd18aac659b30dc0c51dc53f,1,20/09/11,20/09/11,8,Fixed ASCII getl issue,"Fixed ASCII getl issue

When processing errors Spymemcached had no notion of what
LOCK_ERROR was. This fix allows Spy to handle the LOCK_ERROR.

Change-Id: I07fcc169a34dd5d14156c82ebdc1a99c785992de",0,0,0,0,0,0,0,0,0,
9679,I9ee8170c20f668d804d083a6d89832c73ad119ee,http://review.couchbase.org/#/c/9679,1,7544e71ee92471bd441143ec5482f08b017d52a9,f68233c0df59f1a8567c55593aabb65484b9c368,1,20/09/11,24/09/11,461,Merge branch 'refresh',"Merge branch 'refresh'

Changes Merged:
	Made cmd variable a byte for binary operations
	SPY-51: Bug in OperationImpl's decodeLong(2)

Change-Id: I9ee8170c20f668d804d083a6d89832c73ad119ee",0,0,1,0,0,1,1,0,0,
9710,Icc98b26ecb1da4c9f3dbf96f9e827801f3b807b1,http://review.couchbase.org/#/c/9710,1,45e27177256b60f8c2e92007ba4e215fe9eb2f74,65e8e41f3f315b206c2e6e0288def25635e51751,1,22/09/11,24/09/11,1,Flush the PrintWriter in TapMessagePrinter,"Flush the PrintWriter in TapMessagePrinter

This doesn't print anything until you flush.

Change-Id: Icc98b26ecb1da4c9f3dbf96f9e827801f3b807b1",0,0,0,0,0,1,1,0,0,
9711,I7c70697bdd8f67f451c514193ae2d6fa2856dfc7,http://review.couchbase.org/#/c/9711,2,65e8e41f3f315b206c2e6e0288def25635e51751,f5ab74a94ca399baa4d68a279e76f29d8e0f8f58,1,22/09/11,25/09/11,1,Don't reconnect when a tap connection finishes.,"Don't reconnect when a tap connection finishes.

Change-Id: I7c70697bdd8f67f451c514193ae2d6fa2856dfc7",0,0,1,1,0,1,1,0,0,
9712,I583c43216643b111b6256f39ca475582b37267c6,http://review.couchbase.org/#/c/9712,7,14fad7f8a8c55de52e982a52fad1cdea2715cf66,6a52f85c7a7ba2d1c6e33631171c76e4eef38d8b,1,22/09/11,07/10/11,705,Refactored tap message classes.,"Refactored tap message classes.

These needed to be more readable and were horribly coded (by me). I
started seeing issues with conversion from bytes on the wire to
variables in spy so I changed how this was done.

Change-Id: I583c43216643b111b6256f39ca475582b37267c6",0,1,0,0,1,1,1,2,1,
9713,I9f060ab36a407eb91dd3a8b784cd7c854e2d706d,http://review.couchbase.org/#/c/9713,1,23a7f8ca5fe2e62097427cea25cce0fb7277a25d,982e3bd03e0889cb094d020517a3027087e9ae79,1,22/09/11,22/09/11,1,Removed a print line statement from TestConfig,"Removed a print line statement from TestConfig

Change-Id: I9f060ab36a407eb91dd3a8b784cd7c854e2d706d",1,0,0,1,0,0,1,0,0,
9760,I00472392dd0c9a892f3f5ed2dd62249844ab92e8,http://review.couchbase.org/#/c/9760,3,8c21ce0469bcb0acb55066361d2a4a6677fea605,b06941825d18995ea9a5553580975f9db72f4ec7,1,26/09/11,21/10/11,109,SPY-4: Get CouchDB config info from config,"SPY-4: Get CouchDB config info from config

Change-Id: I00472392dd0c9a892f3f5ed2dd62249844ab92e8",0,0,0,1,0,1,1,0,0,
9761,I65c4084df0a4b0ea0e2cedbd934eb0dab2ea378d,http://review.couchbase.org/#/c/9761,3,ed3e4145bc7061fb46e7f7324e8040605dccd92f,b593c88ecd400b98b20c97bed67c177ae20cfd45,0,26/09/11,28/09/11,6,Added a docsjar target,"Added a docsjar target

This target creates a javadoc jar file from the generated docs

Change-Id: I65c4084df0a4b0ea0e2cedbd934eb0dab2ea378d",0,0,0,0,0,1,1,NA,NA,
9762,Iaa0490030d869897b837e6f5bd38ba5332e34827,http://review.couchbase.org/#/c/9762,2,e37d68159f0a38a74d6efaf61b434eea14997538,8717e1ac0fd9980e971796aa55266283584940d2,0,26/09/11,28/09/11,12,Made package the default target and made it build all jars,"Made package the default target and made it build all jars

Change-Id: Iaa0490030d869897b837e6f5bd38ba5332e34827",0,0,0,1,0,1,1,NA,NA,
9763,Ie63b1479bb6dfa4959f78429159c4eb45573d2a5,http://review.couchbase.org/#/c/9763,2,58771af4c659346b1238684ff0e27c64cb8d3f5b,0357638eb979782ce4d443c650189d37e78d9a1e,0,26/09/11,28/09/11,5,Install javadocs java into local maven when doing ant mvn-install,"Install javadocs java into local maven when doing ant mvn-install

Change-Id: Ie63b1479bb6dfa4959f78429159c4eb45573d2a5",0,0,0,1,0,1,1,NA,NA,
9764,I1c2e862699f1784bde1294ad62996ebfacfbe1bf,http://review.couchbase.org/#/c/9764,1,0357638eb979782ce4d443c650189d37e78d9a1e,6d025c36f624b64f35131f841795c81b6d45fcb3,0,26/09/11,28/09/11,3,The jar target now builds a jar of all of the test classes,"The jar target now builds a jar of all of the test classes

Change-Id: I1c2e862699f1784bde1294ad62996ebfacfbe1bf",0,0,0,1,0,1,1,NA,NA,
9765,I33890737d862ec38e29e1c5e09f3d338652e97f2,http://review.couchbase.org/#/c/9765,2,6d025c36f624b64f35131f841795c81b6d45fcb3,a7f5faeb6ca601c5dbbf0b67f9a6b0a615fb3cb4,0,26/09/11,29/09/11,47,Updated README.markdown to reflect the new build file,"Updated README.markdown to reflect the new build file

Change-Id: I33890737d862ec38e29e1c5e09f3d338652e97f2",0,0,1,1,0,1,1,NA,NA,
9769,I17ea7a0146443ed1ef4578fb04cab431a3e723d7,http://review.couchbase.org/#/c/9769,1,e83d08e52fe819f92a1f61f3ec4032dae6b789b4,ccf3553d1649eafdfcb9c0d3bc48eb524c625d37,1,26/09/11,29/09/11,12,Made vbmap in MultiKey operation synchronized,"Made vbmap in MultiKey operation synchronized

There was a concurrency issue here that has to do with accessing a
two threads accessing the same set. One thread is iterating over
the set and the other is modifying the set. This modification
causes iteration to undefined and therefore java throws an error.

Change-Id: I17ea7a0146443ed1ef4578fb04cab431a3e723d7",0,0,1,0,0,1,1,0,0,
9852,I1d2e7c4a3e6db6648d175364950eab6076a45e5f,http://review.couchbase.org/#/c/9852,2,ccf3553d1649eafdfcb9c0d3bc48eb524c625d37,71400eb95658a1992490e34ad954dec177ae74c5,1,29/09/11,08/10/11,69,Add compatibility with netty 3.2.0+.,"Add compatibility with netty 3.2.0+.

Netty 3.2.0+ (NETTY-281) changed HttpMessage.setHeader(String, String) to setHeader(String, Object), which causes NoSuchMethodErrors when spymemcached is used with such a newer netty version. To prevent spymemcached users from other library incompatibilities the netty dependency is not upgraded, but the appropriate setHeader method is selected and invoked at runtime. This was discussed on the mailing list: http://groups.google.com/group/spymemcached/browse_thread/thread/4b9f0638bbcc96fb

Change-Id: I1d2e7c4a3e6db6648d175364950eab6076a45e5f",0,0,0,0,0,0,0,0,0,
9986,Icc9b70a068af8383a4da3045628e999a8df811d8,http://review.couchbase.org/#/c/9986,2,5d9da2a680b1b8d16ad4cfdb31db3ee0c3623f6f,bfe15fcc85fcf02a6f95ac157422267107cb81e4,1,06/10/11,07/10/11,22,Recognize a query is using a json object and don't quote it,"Recognize a query is using a json object and don't quote it

This fixes an issue where sending json object as the value to the
key argument in a query was getting quotes put around it. We now
check to see if something is a json object before we decide to
put quotes around it.

Change-Id: Icc9b70a068af8383a4da3045628e999a8df811d8",0,0,0,0,0,1,1,0,0,
10026,Ic68ba9db5b5f645d3affc6964f7b2b90d309e519,http://review.couchbase.org/#/c/10026,2,17b0473da17910d080e7e289c16f83ee9cb5677d,57d8a0cfd2a6b0d79bfa7fb9510f4e549c5c2c37,1,09/10/11,14/10/11,49,Continue to other URIs if one in the list is down. SPY-60.,"Continue to other URIs if one in the list is down. SPY-60.

Change-Id: Ic68ba9db5b5f645d3affc6964f7b2b90d309e519",0,0,1,1,0,1,1,0,0,
10027,I31ad1af2e6d0a33fa8534fa09e3f30175b931408,http://review.couchbase.org/#/c/10027,2,bf5742a7a10fd43b73b53b8e179555ccb5742a72,bfd449b06e2cd893522272b0cfe1c2ca6ccc026d,1,09/10/11,09/10/11,1,No need for old debugging string in test.,"No need for old debugging string in test.

Change-Id: I31ad1af2e6d0a33fa8534fa09e3f30175b931408",0,0,0,1,0,1,1,0,0,
10059,I9f6bc488406fc9c5ce537454b773d9baf21e379d,http://review.couchbase.org/#/c/10059,1,0a67c037f08f8c1e7f5a24fa27fa3c3bd1c7013f,af317924c9861bacf9312802305bf3459592b792,1,11/10/11,11/10/11,10,"Revert ""SPY-37 & SPY-38: Fixed redistribution performance issue""","Revert ""SPY-37 & SPY-38: Fixed redistribution performance issue""

This reverts commit 48e7e62b75c93925647a6acd6bcfe06b1b89f492.

Change-Id: I9f6bc488406fc9c5ce537454b773d9baf21e379d",0,0,0,0,0,1,1,0,0,
10098,I4e7b13fcb0a925277761c32373b3696eed9daa0a,http://review.couchbase.org/#/c/10098,1,41241430eac79db96cd9fa6d7d0caf68adad0487,56ccb19887615cd00e82eba56a825a70f02d54aa,0,12/10/11,12/10/11,86,Format the readme correctly.,"Format the readme correctly.

Change-Id: I4e7b13fcb0a925277761c32373b3696eed9daa0a",0,0,0,1,0,0,1,NA,NA,
10186,Icfc3f78fe00d1254f5ed30e1776301171b5e54a7,http://review.couchbase.org/#/c/10186,2,56ccb19887615cd00e82eba56a825a70f02d54aa,8af4e69cc3ddf69a94f71d487ea78a6b710129f0,1,18/10/11,18/10/11,2130,Merge branch 'refresh',"Merge branch 'refresh'

* refresh:
  Continue to other URIs if one in the list is down. SPY-60.
  Revert ""SPY-37 & SPY-38: Fixed redistribution performance issue""
  No need for old debugging string in test.
  Add compatibility with netty 3.2.0+.
  Refactored tap message classes.
  SPY-37 & SPY-38: Fixed redistribution performance issue
  Made vbmap in MultiKey operation synchronized
  Don't reconnect when a tap connection finishes.
  Flush the PrintWriter in TapMessagePrinter
  Removed extra variables in tapCustom header
  Removed a print line statement from TestConfig

Change-Id: Icfc3f78fe00d1254f5ed30e1776301171b5e54a7",0,0,0,0,1,1,1,2,1,
10202,If8d61bd1e016afbac8f79c8b5481f1bb60c79b06,http://review.couchbase.org/#/c/10202,1,0fbbf529c806d23ae47d9404c04e7efc1bc82271,262ee938acacb3bf3ec2348b825f688e496b4cda,1,19/10/11,19/10/11,26,Fixed checkstyle issues from merge with refresh,"Fixed checkstyle issues from merge with refresh

Change-Id: If8d61bd1e016afbac8f79c8b5481f1bb60c79b06",0,0,0,1,0,1,1,0,0,
10260,If60423b56ebf22c4529bffe95496ffe8b833a65f,http://review.couchbase.org/#/c/10260,7,a59421ede8e180ce484755d37d1a0985160a3fc3,24dc1b85b423a4faa9763fe2b103b4182c221deb,1,21/10/11,23/10/11,50,Don't compress json objects,"Don't compress json objects

We don't actually parse the whole object. Instead we look
at the first character and if it looks like json then we
don't compress it.

Change-Id: If60423b56ebf22c4529bffe95496ffe8b833a65f",0,1,0,0,0,1,1,0,0,
10294,I2e3807f976363e8b8bd985e9b6faa283875ed7f1,http://review.couchbase.org/#/c/10294,1,e677021826c9628bde3269ed57480fbd9adf8678,d18fe9be528b48a5c11817a1d56539f61d6ceb01,1,22/10/11,22/10/11,2,Fixed a typo when computing vbucketlist size for tap messages.,"Fixed a typo when computing vbucketlist size for tap messages.

Change-Id: I2e3807f976363e8b8bd985e9b6faa283875ed7f1",0,0,0,1,0,1,1,0,0,
10297,Icf3fb6a3750572685d9806aa6f90af23f25eadc6,http://review.couchbase.org/#/c/10297,1,dd5be33c5274cf8580418ce6c4a1d5ac08bdf4d9,63df45217e474f17a07d44308c5860dca5e9f3ec,1,23/10/11,23/10/11,11,Rename and fix VBucketMemcachedClientTest to VBucketMembaseClientTest.,"Rename and fix VBucketMemcachedClientTest to VBucketMembaseClientTest.

This test was causing other test failures because it didn't clean up
after itself.  When trying to determine why the test was even used
here, I realized it had not been renamed in the refactoring between
2.7 and 2.8.

Change-Id: Icf3fb6a3750572685d9806aa6f90af23f25eadc6",0,0,0,0,0,1,1,0,0,
10299,I85bef0e42146e90c58082a4c175b41d47112f5b5,http://review.couchbase.org/#/c/10299,1,d83da445884ca86caca264b76eec1368e0e12722,0fe91c2bb4f8d196f4c8de62cc3951d900849bee,0,23/10/11,23/10/11,2,Skip all ConfigurationProvider tests when testing against memcached.,"Skip all ConfigurationProvider tests when testing against memcached.

Change-Id: I85bef0e42146e90c58082a4c175b41d47112f5b5",0,0,0,1,0,1,1,NA,NA,
10300,I86ca4471c3b845a2f4edd0004a4ec9ad9d766e7b,http://review.couchbase.org/#/c/10300,1,0fe91c2bb4f8d196f4c8de62cc3951d900849bee,2fa31e687ce5577163c0be8bf2b06bd8e4606290,0,23/10/11,23/10/11,4,Update to Netty 3.2.0.Final.,"Update to Netty 3.2.0.Final.

We have already updated 2.7.3 to Netty 3.2.0 and added compatibility
with either 3.1.5.GA or 3.2.0.Final.

In 2.8, we will support only 3.2.0.Final, though 2.7.x will continue
to support 3.1.5.GA.

Change-Id: I86ca4471c3b845a2f4edd0004a4ec9ad9d766e7b",0,0,0,0,0,1,1,NA,NA,
10301,I80dca6250f7b3f72c6175dce7769f91908f74770,http://review.couchbase.org/#/c/10301,1,2fa31e687ce5577163c0be8bf2b06bd8e4606290,2d3b91c900bdeedf7f2e10f283afd0350ebeb247,0,23/10/11,23/10/11,7,Update maven pom generation with more detail.,"Update maven pom generation with more detail.

Change-Id: I80dca6250f7b3f72c6175dce7769f91908f74770",0,0,0,1,0,1,1,NA,NA,
10302,I3e5de47f609b52dd2dfe8d3cfc3803cee4c46f92,http://review.couchbase.org/#/c/10302,1,2d3b91c900bdeedf7f2e10f283afd0350ebeb247,b935f5c71f6db8cf7f153fe33c0cf34ff3c61c6a,0,23/10/11,23/10/11,6,Update maven dependencies and metadata for more completion and accuracy.,"Update maven dependencies and metadata for more completion and accuracy.

Change-Id: I3e5de47f609b52dd2dfe8d3cfc3803cee4c46f92",0,0,0,1,0,1,1,NA,NA,
10304,I033dcc36ffdb0795463794c2838dad651aeb4e3b,http://review.couchbase.org/#/c/10304,1,b935f5c71f6db8cf7f153fe33c0cf34ff3c61c6a,94a3d0020ebce72bd3d2a86b7a426faf18a16b9e,0,24/10/11,24/10/11,10,Use variables for jar version names,"Use variables for jar version names

I just realized I +2'ed a commit that had these hard coded. The
only place a version number should be hard coded is in the
ivy/library.properties file.

Change-Id: I033dcc36ffdb0795463794c2838dad651aeb4e3b",0,0,0,0,0,1,1,NA,NA,
10328,I209a474cbd3fb153c0c95701e5943aaa2560b5cd,http://review.couchbase.org/#/c/10328,1,7925f60c6f6d847b86cec3b280a73d3fd9250013,af6dc0229c015244e440051a0d5ca30799b4aa2b,1,24/10/11,27/10/11,20,Issue-211: Fix javadoc warnings from tap and vbucket class.,"Issue-211: Fix javadoc warnings from tap and vbucket class.

Change-Id: I209a474cbd3fb153c0c95701e5943aaa2560b5cd",0,0,1,1,0,1,1,0,0,
11099,I383dfcde9b5c1fbd0225e5a5e8ee001e8e3ada60,http://review.couchbase.org/#/c/11099,8,096c386e936b4d0c55f851b720a4e87482502461,cd8f9655d99148c382836bb0a40054fcda6b51f5,1,22/11/11,02/01/12,12588,Removed all Membase and Couchbase support,"Removed all Membase and Couchbase support

We are splitting up this project into three seperate projects.
Each project will support a specific database.

Change-Id: I383dfcde9b5c1fbd0225e5a5e8ee001e8e3ada60",0,1,0,0,1,1,1,-16,0,
11100,I1512cdc6b76409796085ffdf8182a6d73fd4319b,http://review.couchbase.org/#/c/11100,3,8b33be1045b7905fea620a1896163d4b3358ec26,f6ebcbd7d847f3b4f6f66e623e21a540bfcb1d47,0,22/11/11,02/01/12,3,Rewrote javadocs file attachment for mvn-install,"Rewrote javadocs file attachment for mvn-install

This shouldn't have it's own artifact:install function
since it can be included in the one that already exists.

Change-Id: I1512cdc6b76409796085ffdf8182a6d73fd4319b",0,0,0,0,0,1,1,NA,NA,
11101,I65ea6f1aaf6c501e2f7746ec9027f20f517751ec,http://review.couchbase.org/#/c/11101,3,e0fde448c49f02e74a533794b725b049cf2a9e57,c442880924b9352ef10f890b6d547bab7cc76722,0,22/11/11,02/01/12,32,Added variable names for versions to spymemcached.xml,"Added variable names for versions to spymemcached.xml

Change-Id: I65ea6f1aaf6c501e2f7746ec9027f20f517751ec",0,0,0,1,0,1,1,NA,NA,
11102,Ida7f38c0bb94a420e24ec935a3b68e1d70cae6aa,http://review.couchbase.org/#/c/11102,3,806d789bdf384798c9a0200cc957564d098af843,1fa531ec811cd8adf42e9433ec9b9a360bc30d9f,0,22/11/11,02/01/12,77,mvn-install publishes spymemcached test cases,"mvn-install publishes spymemcached test cases

Change-Id: Ida7f38c0bb94a420e24ec935a3b68e1d70cae6aa",0,0,0,1,0,1,1,NA,NA,
11103,Ie1bdaa247966a42d830fdce51b770fb36f4db324,http://review.couchbase.org/#/c/11103,2,25a791871901d981bbd51304b7530b45990d0cb1,4b3371bf2215b530ea91acd19465101dbaff5471,0,22/11/11,02/01/12,55,Remove unused dependencies,"Remove unused dependencies

Change-Id: Ie1bdaa247966a42d830fdce51b770fb36f4db324",0,0,0,1,0,1,1,NA,NA,
11104,I924eb5b3df30241b21b4dd101f5962268ea05911,http://review.couchbase.org/#/c/11104,2,d92bb03635afadd992e5da2b653cb3ab13a6fe6e,db33796ebe48a406a8256524f18a7e08dcdd1e2d,0,22/11/11,02/01/12,18,POM files now generate the correct scopes,"POM files now generate the correct scopes

Change-Id: I924eb5b3df30241b21b4dd101f5962268ea05911",0,0,0,1,0,1,1,NA,NA,
11105,I0dd8e0acbe9eecc06542ca4fee45de99c1844227,http://review.couchbase.org/#/c/11105,2,3595ed5d757c6f10118c97b2092d058850fa9794,16339ea223fb7bc6a0e68d55cc5eab156e258ce2,1,22/11/11,02/01/12,33,Remove tests that checked for Membase/Couchbase,"Remove tests that checked for Membase/Couchbase

Change-Id: I0dd8e0acbe9eecc06542ca4fee45de99c1844227",0,0,0,1,0,1,1,0,0,
11106,I90619ff869d49b31c09a227bb96e9f1d6dbe0d7b,http://review.couchbase.org/#/c/11106,2,34603c02ed9e1e90f28d32751c93d2a18ec927d3,35645cb9d5ebc9af25409098835ea8e36d727f0d,0,22/11/11,02/01/12,123,Only generate a version once in the build file,"Only generate a version once in the build file

Change-Id: I90619ff869d49b31c09a227bb96e9f1d6dbe0d7b",0,0,0,1,0,1,1,NA,NA,
11107,I35b144c70d382da5a862119cf762ca6383323f95,http://review.couchbase.org/#/c/11107,1,7ceae7fa6917c494350e0a10a7c3d764c595f687,37f0f3099a1f6780c1df7ba663e52ad2309a5e34,0,22/11/11,03/01/12,4,"Don't hardcode ""spymemcached"" the buildfile","Don't hardcode ""spymemcached"" the buildfile

Change-Id: I35b144c70d382da5a862119cf762ca6383323f95",0,0,0,1,0,1,1,NA,NA,
11108,I3cb98b7fe7be52e59fb96fe9fdd6ef04ce25ed04,http://review.couchbase.org/#/c/11108,1,37f0f3099a1f6780c1df7ba663e52ad2309a5e34,e9afa932c80f40fd01b4f81a52a31bb404e92b6e,0,22/11/11,03/01/12,8,Don't put test after ther version # on test jars,"Don't put test after ther version # on test jars

Change-Id: I3cb98b7fe7be52e59fb96fe9fdd6ef04ce25ed04",0,0,0,1,0,1,1,NA,NA,
11109,I9b10e2b4fbed283aa124f7db8a5ee91a163c2f40,http://review.couchbase.org/#/c/11109,1,e9afa932c80f40fd01b4f81a52a31bb404e92b6e,8e3e95608047543d3fd7803c24291f2aa9956acb,0,22/11/11,03/01/12,2,Fixed project description,"Fixed project description

Change-Id: I9b10e2b4fbed283aa124f7db8a5ee91a163c2f40",0,0,0,1,0,1,1,NA,NA,
12049,Idbab18ffa7d30400fb7c066f3ccdace2e93201e2,http://review.couchbase.org/#/c/12049,5,1ff0a18af366cc827acb6af4b055939448807a9f,755bc099e56657d26e8ba71d5094aa3fbb6ed276,1,04/01/12,08/01/12,2,Potential Refactoring of Java Client to couchbase-client and spymemcached,"Potential Refactoring of Java Client to couchbase-client and spymemcached

I had to make some minimal changes to spymemcache (changing access
modifiers) to make the refactoring happen.

This is not final(so no ant checkstyle yet :-)), but, if deemed
OK, we can make it final.

Change-Id: Idbab18ffa7d30400fb7c066f3ccdace2e93201e2",0,1,1,0,0,0,1,0,0,
12052,I49e28b2c89555ebbc24dc8db109fc5c0a7b40cf4,http://review.couchbase.org/#/c/12052,1,95da3210942e2411f7f0e6dd3afa237e58ea2725,dc20ca1f5e2032074bda38390738848ae7bdc8c7,1,04/01/12,06/01/12,4,SPY-69: Fixed CASMutator expiration issue,"SPY-69: Fixed CASMutator expiration issue

The cas call in this class wasn't using the function that allows
the expiration to be specified. As a result, if the CASMutator was
used and an item was already in memcached then the expiration would
be set to 0.

Change-Id: I49e28b2c89555ebbc24dc8db109fc5c0a7b40cf4",0,0,0,0,0,1,1,0,0,
12088,Ia6606f73d9fd8006ee4b714bbfc25e320370d414,http://review.couchbase.org/#/c/12088,1,bc99380d79456679d333cf6a5c1cacb1e422edbe,d6f8f0cca88f789e1d3af8305d692e25ea8a75e0,1,05/01/12,06/01/12,28,Added options to selectively run some tests for CI,"Added options to selectively run some tests for CI

Change-Id: Ia6606f73d9fd8006ee4b714bbfc25e320370d414",0,0,0,1,0,0,1,0,0,
12127,Ie2a589dc5040d465eb74bb7918f866165109d011,http://review.couchbase.org/#/c/12127,12,d6f8f0cca88f789e1d3af8305d692e25ea8a75e0,44b680f0f5a329fba5859d0349ec3cb73d217057,1,07/01/12,08/01/12,103,Added the capability to test based on different ports,"Added the capability to test based on different ports

Mmecached can start on different ports and the tests can be configured to
run correctly than using teh default 11211

Change-Id: Ie2a589dc5040d465eb74bb7918f866165109d011",0,1,0,0,0,0,1,0,0,
12137,Ie28277585c7da21e8ab4dbf5d738e69e24597a02,http://review.couchbase.org/#/c/12137,4,8d6a5654810ea8290c2bd06d0677eb8fa04f5f42,a60f4a064563e295fdf412677fb6c8ed69b2f03d,0,08/01/12,08/01/12,2,Added Capability to selectively run unit tests for CI,"Added Capability to selectively run unit tests for CI

Change-Id: Ie28277585c7da21e8ab4dbf5d738e69e24597a02",0,1,0,1,0,0,1,NA,NA,
12138,I497286aa37a37b251681e42a8fcdd45ce8dc5577,http://review.couchbase.org/#/c/12138,1,dcf4d14c5a3970f0d1d6e09081243de24abeda6a,ddf786a2be00bf58d76e895735c06d8990c47886,1,08/01/12,08/01/12,20,Fixed checkstyle errors,"Fixed checkstyle errors

Change-Id: I497286aa37a37b251681e42a8fcdd45ce8dc5577",0,0,0,1,0,1,1,0,0,
12139,I194dc2f7feb59d49579ec5123e21d17bbf3b6ef9,http://review.couchbase.org/#/c/12139,1,ddf786a2be00bf58d76e895735c06d8990c47886,c40f055f43e611abc7fce857ac3c1d65ff8875d3,1,08/01/12,08/01/12,46,Moved validateKey function to StringUtils class,"Moved validateKey function to StringUtils class

Change-Id: I194dc2f7feb59d49579ec5123e21d17bbf3b6ef9",0,0,0,1,0,1,1,0,0,
12141,I816a86405c4d0d4d696f72bcf115e98b1e8632aa,http://review.couchbase.org/#/c/12141,2,9bb1a11d2c5c5320fc93ee3374e0c8cece8f531a,be1d5438ece255ffbad533ec2f1c5d067405fc59,1,08/01/12,08/01/12,33,Removed server.type parameter,"Removed server.type parameter

Spymemcached is only meant to work against mecached now so we
don't need the ability to include/exclude tests.

Change-Id: I816a86405c4d0d4d696f72bcf115e98b1e8632aa",0,0,0,0,0,1,1,0,0,
12142,Ia2b64253cb24331e73806ebd92a2501f029439c4,http://review.couchbase.org/#/c/12142,6,2513eb288529700b6b5ea7089d54c996ba1de3b1,7f2dd61c357f16af14a0e994029f70be53b6fdee,1,08/01/12,08/01/12,106,Moved addOp() to MemcachedConnection,"Moved addOp() to MemcachedConnection

Change-Id: Ia2b64253cb24331e73806ebd92a2501f029439c4",0,1,0,1,0,1,1,0,0,
12143,I401beb3473631024d9362451cb5f3b0a4f72277d,http://review.couchbase.org/#/c/12143,2,5fd2d78d88890b648d1850bfb51d44358b876d0c,2e3ecc4d2be82fa3429e5ec5248cbcafd7b50016,1,08/01/12,08/01/12,15,Fixed javadoc warnings,"Fixed javadoc warnings

Change-Id: I401beb3473631024d9362451cb5f3b0a4f72277d",0,0,0,1,0,1,1,0,0,
12158,Ief2909d0177c944dc39023b205f5fad03f3acb97,http://review.couchbase.org/#/c/12158,2,2e3ecc4d2be82fa3429e5ec5248cbcafd7b50016,b36e1d3e27eaada07342139fcc9bb166cb87b737,1,09/01/12,11/01/12,653,Added a tap client back to Spymemcached,"Added a tap client back to Spymemcached

The tap client was removed from Spymemcached when we split the
project in two. Since Spymemcached supports some of tap I have
moved back only the code that makes sense. After this commit
Spymemcached will support only the tap dump command. Note I
have also left the tap custom function in case future versions
of memcached support more tap options and Spymemcached is unable
to keep up. This tapCustom function will also allow people who
write their own engines for memcached to take full advantage of
the tap protocol.

Change-Id: Ief2909d0177c944dc39023b205f5fad03f3acb97",0,0,0,0,1,1,1,1,1,
12283,I15821983ea2ebd07fd98feeb968ce9fa578ded0b,http://review.couchbase.org/#/c/12283,3,b36e1d3e27eaada07342139fcc9bb166cb87b737,674e4eb74271706a091a5f325302e64d21fefcdb,1,11/01/12,22/01/12,113,Add Iterator versions of getAsyncBulk and getBulk,"Add Iterator versions of getAsyncBulk and getBulk

Add the following methods to Memcached/MemcachedIF:
- <T> BulkFuture<Map<String, T>> asyncGetBulk(Iterator<String> keys,
      Iterator<Transcoder<T>> tcs);
- <T> BulkFuture<Map<String, T>> asyncGetBulk(Iterator<String> keys,
      Transcoder<T> tc);
- BulkFuture<Map<String, Object>> asyncGetBulk(Iterator<String> keys);
- <T> Map<String, T> getBulk(Iterator<String> keys, Transcoder<T> tc);
- Map<String, Object> getBulk(Iterator<String> keys);

Some times it is more convenient/memory efficent to pass in an
Iterator of keys than it is to have a Collection of them.

Example:

public PrefixAdderIterator implements Iterator<String> {

  private final String prefix;
  private final Iterator<String> iterator;
  public PrefixAdderIterator(String prefix,
         Iterator<String> iterator) {
    this.prefix = prefix;
    this.iterator = iterator;
  }
  ...
  public String next() {
    return prefix+iterator.next();
  }
 ...
}

rather than

 List<String> prefixedKeys = new ArrayList<String>();
 for (String key: keys) {
  prefixedKeys.add(prefix+key);
 }

Change-Id: I15821983ea2ebd07fd98feeb968ce9fa578ded0b",0,0,1,0,0,0,1,0,0,
12298,Ib5f8d76aa6ce05cf8f5c15980f29b8e93100d6a8,http://review.couchbase.org/#/c/12298,3,b2019acb2b778b4e374d1edd23ea27f96748b6dd,4d6b3b5f08e152a492f759dfd4d5b1accb837dcd,1,12/01/12,12/01/12,175,Split tap flags class into request and response,"Split tap flags class into request and response

Tap requests and responses flags have different meanings. They
should be represented by two different classes.

Change-Id: Ib5f8d76aa6ce05cf8f5c15980f29b8e93100d6a8",0,0,0,0,0,1,1,0,0,
12573,I90eaf4107ef8942855cb9c125d2428fe6076e538,http://review.couchbase.org/#/c/12573,3,542f7c4557a5c211f0b09bd3b0d613b01c4cad68,01f5e5b1e2909ff0a6dd2b0c0bd26ee16b72a020,0,22/01/12,22/01/12,45,More changes to publish maven repo. to ~/repo from ivy,"More changes to publish maven repo. to ~/repo from ivy

Change-Id: I90eaf4107ef8942855cb9c125d2428fe6076e538",0,0,0,1,0,0,1,NA,NA,
12575,I90f78654835939305bb0342f8442ea8a54cabd14,http://review.couchbase.org/#/c/12575,1,01f5e5b1e2909ff0a6dd2b0c0bd26ee16b72a020,2f449e5de565ceb2f343e30906292e91eaa25f6e,0,22/01/12,22/01/12,3,Added Javadocs JAR publication,"Added Javadocs JAR publication

Change-Id: I90f78654835939305bb0342f8442ea8a54cabd14",0,0,0,1,0,0,1,NA,NA,
12581,I2523f96e6e0fe1791876001bbc345a23674ba6dc,http://review.couchbase.org/#/c/12581,1,2f449e5de565ceb2f343e30906292e91eaa25f6e,16ecfddbb6ac1ad645daf9d7da17dea31b504d27,0,22/01/12,22/01/12,56,Changes to do a staging of Maven locally,"Changes to do a staging of Maven locally

Incorporated chanes Ife95d2f4, I34b46bc0, Ib71d9ab4 from
couchbase-java-client.

Change-Id: I2523f96e6e0fe1791876001bbc345a23674ba6dc",0,0,0,0,0,0,0,NA,NA,
12908,I9da7cc17eb5adedc9c2cac79ab562bab0fc7ba52,http://review.couchbase.org/#/c/12908,5,042f9f9d52f2e511cc248a7994122890e20f2ba8,f11ab89834f7002506b4e6938f2800cbcd984314,1,02/02/12,06/02/12,195,Added support for unlock on a key,"Added support for unlock on a key

Based on

http://code.google.com/p/spymemcached/issues/attachmentText?id=205&aid=2050003000&name=zynga-patch&token=43het0qMD0x7uoEWDTVfwQCYRZc%3A1328018112032

Change-Id: I9da7cc17eb5adedc9c2cac79ab562bab0fc7ba52",0,1,1,0,0,0,1,0,0,
13081,I68650e187eec5f79952dab1374bad0e07d5a6c30,http://review.couchbase.org/#/c/13081,5,b811d16e1d37a5f58525df408bf7b922641a6e2f,ef55bcf30242e46f45292284adc82af9eab8c978,1,08/02/12,20/02/12,287,Created TapStream abstraction,"Created TapStream abstraction

Previously when we created a tap stream we would only send it
to a single node in the memcached cluster. This fix creates
a tap stream abstraction that aggregates the tap streams
sent to each server and treats them as a single tap stream.

Change-Id: I68650e187eec5f79952dab1374bad0e07d5a6c30",0,1,1,0,0,1,1,1,1,
13084,I96f7fb126ab3f7879e590131ded7229f9f75bc31,http://review.couchbase.org/#/c/13084,4,0d5a27d73deaf79e456b7b3db64bea09d9b4738c,6e5a2b3e294e7f9cf8935aaf01a8eaafce84b9e8,1,08/02/12,20/02/12,106,Made TapAck its own class,"Made TapAck its own class

This will help reduce having duplicate code.

Change-Id: I96f7fb126ab3f7879e590131ded7229f9f75bc31",0,1,1,0,0,1,1,0,0,
13361,Ie627cd14631a01a0258d67337251c552e90aa3bc,http://review.couchbase.org/#/c/13361,4,7652c33ec5bb35a39d6a52bfe91afdfb951d95e5,22cb1c177a358f5521eac04b49ff2eadcb36db52,1,19/02/12,22/03/12,29,Added toString() for ResponseMessage.,"Added toString() for ResponseMessage.

Change-Id: Ie627cd14631a01a0258d67337251c552e90aa3bc",0,1,0,1,0,1,1,0,0,
13362,Ia5ed0e3a6a2074a1dac229904826fdd838e06b37,http://review.couchbase.org/#/c/13362,2,0565b855a87c1e084287ac99fcbd5278a7868b28,7e05bdba05977f6af4eeba18b0f8ec69fd33c411,1,19/02/12,20/02/12,10,"Enhanced TapTest, ensuring success with random leftovers.","Enhanced TapTest, ensuring success with random leftovers.

Change-Id: Ia5ed0e3a6a2074a1dac229904826fdd838e06b37",0,0,0,1,0,1,1,0,0,
13509,I5279eec0f642688013c9a8d98ca4a7922cae9d42,http://review.couchbase.org/#/c/13509,2,773b2695c70b635b3d6054d6df6da08674c5f1fb,911e359637977db53cf71e63657f863e4afe3679,1,23/02/12,21/03/12,4,Wait longer on tap data received.,"Wait longer on tap data received.

Change-Id: I5279eec0f642688013c9a8d98ca4a7922cae9d42",0,0,0,1,0,1,1,0,0,
13510,I63b69273cac194163b784211474ec2ff77bd7959,http://review.couchbase.org/#/c/13510,3,e15c8a7a51f9f3e50789d474bb60179a58dd0ec2,f67838b3df55d6110c9928efd80c013a94b68d59,1,23/02/12,21/03/12,22,Decode TAP mutation flags as host byte order.,"Decode TAP mutation flags as host byte order.

In trying to decode the item flags from a tap mutation, it was found
that the flags are stored in the server in network byte order, but when
sent over tap it goes through htonl() conversion, making it a double
conversion.  Since TAP is pretty well baked, we'll decode differently.

:(

Change-Id: I63b69273cac194163b784211474ec2ff77bd7959",0,0,0,0,0,1,1,0,0,
13570,Ic90fee141df1485ac55e6fdfc5a922f6a158803b,http://review.couchbase.org/#/c/13570,1,d7eb0b76fc72a2ee224e10bed80b9e97f13149ef,5e003d1a2eb932e9c0f2b6d4c655f65d26ae9aab,1,24/02/12,12/07/12,19,add TAP Opcodes for start/end checkpoint,"add TAP Opcodes for start/end checkpoint

Change-Id: Ic90fee141df1485ac55e6fdfc5a922f6a158803b",0,0,1,1,0,0,1,0,0,
13571,If646c70aaa345f3dd1191257dfcedc1aaacdc7b1,http://review.couchbase.org/#/c/13571,5,5e003d1a2eb932e9c0f2b6d4c655f65d26ae9aab,ab4963a5373f757fe80bebb3a03304d6d13d71d2,1,24/02/12,24/07/12,60,add support for TAP request/response with checkpoint info,"add support for TAP request/response with checkpoint info

Change-Id: If646c70aaa345f3dd1191257dfcedc1aaacdc7b1",0,1,1,1,0,0,1,0,0,
13995,I20ae1b176cb3bc764e993ab98254b15f69cba9ea,http://review.couchbase.org/#/c/13995,1,3e30647aefd8c271697fcb32d877bda26dc3f242,c66efdee060b8ddf4aeea79d9d3714995c34a893,1,16/03/12,21/03/12,72,Fixed handling of TAP flags.,"Fixed handling of TAP flags.

The request and response messages for flags were not following the defined
protocol for their data size.  Also, the logic in the setting of the flags
was incorrect, meaning it wasn't actually possible to determine which
flags were set.

A test that verifies correct behavior will be added in a later commit
that introduces test coverage for the ResponseMessage class.

Change-Id: I20ae1b176cb3bc764e993ab98254b15f69cba9ea",0,0,1,0,0,1,1,0,0,
13996,I68355b5ea10437c144a7b4a46adb7d005edfa0fc,http://review.couchbase.org/#/c/13996,3,570329a21823d872a255e1b7070fb120ac1f120c,869a0da3288a1f230cece3c602badfbacb190771,1,16/03/12,21/03/12,346,Add test coverage for ResponseMessage and fix to get bytes.,"Add test coverage for ResponseMessage and fix to get bytes.

This adds test coverage to the ResponseMessage.  This test was used for
finding and addressing a number of recent fixes and verifying correct support
for requesting the flags to be sent correctly in network byte order.  These
other fixes were added in recent commits.

Change-Id: I68355b5ea10437c144a7b4a46adb7d005edfa0fc",0,0,1,0,0,1,1,0,0,
14142,Ib3d344e7a0db28994017c515e1c56c4efdcfae19,http://review.couchbase.org/#/c/14142,1,e2fa0d36bc21a75ffebff602b7ef9b8afef7d540,908e3483518fb982f23435ee816d48a01e7e91dd,0,21/03/12,21/03/12,16,"Remove test for ""stats cachedump"".","Remove test for ""stats cachedump"".

In the most recent memcached memcached branch, stats cachedump
has been removed.  It now returns an error saying it's not supported.

See also:
http://code.google.com/p/memcached/issues/detail?id=207
http://www.couchbase.com/issues/browse/MB-4058
http://review.couchbase.org/#change,13854

Change-Id: Ib3d344e7a0db28994017c515e1c56c4efdcfae19",0,0,0,0,0,1,1,NA,NA,
14143,I975a79774fe7d8ec0484fb69c0910525ed164b02,http://review.couchbase.org/#/c/14143,1,f13f3f0f1933205d2f87ce2059a3a885d4b8bdf5,add9a07f0e8bf8b2606239f41c77f5018786fd71,1,21/03/12,21/03/12,6,Complete the removal of stats cachedump.,"Complete the removal of stats cachedump.

Unfortunately, late night coding means I put up a change and
marked it verified, but it makes the project not compile.  Not
worth rewriting history for these 5 commits or so, but need
to fix it.

See also http://review.couchbase.org/#change,14142

Change-Id: I975a79774fe7d8ec0484fb69c0910525ed164b02",0,0,0,0,0,1,1,0,0,
14158,Ie98c136a0c1d450ba3aa5ccd12dfc40650653131,http://review.couchbase.org/#/c/14158,1,add9a07f0e8bf8b2606239f41c77f5018786fd71,fb0c514b9a805cc39ce0cd4da8cbd45d7e8f4807,0,21/03/12,21/03/12,2,Bump log4j to 1.2.16 to get rid of transitive JMS deps.,"Bump log4j to 1.2.16 to get rid of transitive JMS deps.

Change-Id: Ie98c136a0c1d450ba3aa5ccd12dfc40650653131",0,0,0,1,0,1,1,NA,NA,
14159,I579a5832fc4ff0ed9d4303c80b309a25dc8cfbaf,http://review.couchbase.org/#/c/14159,1,fb0c514b9a805cc39ce0cd4da8cbd45d7e8f4807,d5b94e8cd973609a53cf898ca6d57aae72f79d14,0,21/03/12,21/03/12,14,"Make log4j, spring-beans optional in our maven artifacts.","Make log4j, spring-beans optional in our maven artifacts.

Change-Id: I579a5832fc4ff0ed9d4303c80b309a25dc8cfbaf",0,0,0,1,0,1,1,NA,NA,
15947,I58af8a9899025fc54db4d374bce6ca5d29b309af,http://review.couchbase.org/#/c/15947,1,89cfb9d7de44203a97971d09ae025647bd1776d8,c4ce26d3a7c688cfaa9244c1b1ce459cf58096a2,1,12/05/12,02/06/12,6,Fixed tap message test cases,"Fixed tap message test cases

The flags were wrong here. We were passing a long, but the flag said
it was an int.

Change-Id: I58af8a9899025fc54db4d374bce6ca5d29b309af",0,0,0,0,0,1,1,0,0,
15948,I6b4b21ec8448444103d8e73b440df6085bdc1e33,http://review.couchbase.org/#/c/15948,4,c4ce26d3a7c688cfaa9244c1b1ce459cf58096a2,e7872879b626b3cb1febaf4b0339b75114472b28,1,12/05/12,04/06/12,207,Create an ErrorCode class for error codes,"Create an ErrorCode class for error codes

This allows us to use error codes in other places than just
operations. This class defines all of the Memcached error codes
as well as two client specific codes (timed out and canceled). The
reason for client specific error codes is that is gives the user
something definitive to test against when error cases happen.

Change-Id: I6b4b21ec8448444103d8e73b440df6085bdc1e33",0,1,0,0,0,1,1,1,1,
15949,I067e3145d5d95b09d7ca0ad0445bcfa5d5784d51,http://review.couchbase.org/#/c/15949,5,2bc68d7b564d54446d7453f12369b77611228677,3468582a069af761972e85d6056f38edb58a18aa,1,12/05/12,04/06/12,149,OperationStatus now has an error code,"OperationStatus now has an error code

Having error codes will make it easier for users who get errors
to test for what error it is. Right now we only have the message
string and this can actually be different for the same error type.

Change-Id: I067e3145d5d95b09d7ca0ad0445bcfa5d5784d51",0,1,0,0,0,1,1,0,0,
16251,I729781636917f80714cf8d9460e4523e876e1258,http://review.couchbase.org/#/c/16251,3,5babbe04c30aae8ee54a5e163f656f309a6eae7f,507414abee80eb47c1cfc9c3362f9faf4d1eda7e,1,21/05/12,23/05/12,7,CBSE-131: Retry not my vbucket error for optimized sets,"CBSE-131: Retry not my vbucket error for optimized sets

Change-Id: I729781636917f80714cf8d9460e4523e876e1258",0,0,0,1,0,1,1,0,0,
16255,Id8a871c018a6a6372367129b8924e5a833f83644,http://review.couchbase.org/#/c/16255,4,e25e927edef329e1a473011a872d14dd25636880,f2b50d7f1058c438b4c51b2737a7cbcc03437b21,1,21/05/12,09/06/12,4,Make the OperationState volatile.  JCBC-52.,"Make the OperationState volatile.  JCBC-52.

Change-Id: Id8a871c018a6a6372367129b8924e5a833f83644",0,1,0,1,0,1,1,0,0,
16256,I9cce09cb58bf8e7ee4afe33f70ec01638b126d85,http://review.couchbase.org/#/c/16256,3,9ce029ca98fb66dd991dd9646073f68b5a9a3e4a,319102ec19b7c96a882039566cdccbaab87b47c4,1,21/05/12,09/06/12,122,Add javadoc for OperationFuture.,"Add javadoc for OperationFuture.

Change-Id: I9cce09cb58bf8e7ee4afe33f70ec01638b126d85",0,0,0,1,0,1,1,0,0,
16257,I31aa045ff6d328858fa44e53720e38b20b8d38dc,http://review.couchbase.org/#/c/16257,5,6ca46763ad3b43eb5407bbcdad3bea9e03adf74d,0a2d5a764284daa3c0acbb021c3fee81d7bb483f,1,21/05/12,24/05/12,2,Change vbucket retry logging to debug level. JCBC-51,"Change vbucket retry logging to debug level. JCBC-51

Change-Id: I31aa045ff6d328858fa44e53720e38b20b8d38dc",0,1,1,1,0,1,1,0,0,
16335,I25ce3945b4e5e6527dd680031237be22faed69ee,http://review.couchbase.org/#/c/16335,3,653723019cd45b287af1d19fa3d7f996bf04bbea,daafb972353aeddd41d9e6e5a34be8e93f1c6d65,1,23/05/12,24/05/12,2,Make queueReconnect protected so subclasses can request reconnects.,"Make queueReconnect protected so subclasses can request reconnects.

In fixing JCBC-53 on the Couchbase Java client, a need to queue
reconnections in some cluster configuration updates was found to be
required.  This change allows that.

Change-Id: I25ce3945b4e5e6527dd680031237be22faed69ee",0,0,0,0,0,1,1,0,0,
17026,I8bc580f3305191521949a28ce70bca0da8b24d2b,http://review.couchbase.org/#/c/17026,1,30a73cdebd4fb3be8fc067e0d5611d8d853690d3,281481e73fa223599734a6d700ada823d12e6edf,1,11/06/12,15/06/12,4,Check if op is null before asserting in OperationFuture,"Check if op is null before asserting in OperationFuture

On another note, the change Matt put in that added this causes
two other test failures that I didn't have time to fix. I should
have run make test before pushing his change.

Change-Id: I8bc580f3305191521949a28ce70bca0da8b24d2b",0,0,1,0,0,1,1,0,0,
17027,I822bd3accc2dd2b122b1b44dfe79d8ed36250cf2,http://review.couchbase.org/#/c/17027,2,281481e73fa223599734a6d700ada823d12e6edf,6576350c89d3b027866b2af6667ffc76c1bb7ff2,1,11/06/12,29/06/12,38,JCBC-52: Fix StringUtils.join(),"JCBC-52: Fix StringUtils.join()

This function was implemented incorrectly. It was returning
a,b,c,

when it should have been returning
a,b,c

This change fixes this issue.

Change-Id: I822bd3accc2dd2b122b1b44dfe79d8ed36250cf2",0,0,1,0,0,1,1,0,0,
17028,Ida7f9ec4aa101873d464a42db9e5b2b55f2910fa,http://review.couchbase.org/#/c/17028,1,49a5a6ae1704579c51923852a0eb9bd11785c8d5,beea3239d0b791fcc4a4e6d3ab198417d894f1c5,0,11/06/12,15/06/12,4,SPY-90: getStats() can return an error,"SPY-90: getStats() can return an error

Change-Id: Ida7f9ec4aa101873d464a42db9e5b2b55f2910fa",0,0,1,1,0,1,1,NA,NA,
17640,Ice82717ada14c7e85b6191470d7174189f878073,http://review.couchbase.org/#/c/17640,4,5f59cbb1e44c295b543537f3cb49df8917881638,569362481b05859d7612c0b4d843ce9d0df150fd,1,26/06/12,29/06/12,88,Fixed parsing of delete tap packet,"Fixed parsing of delete tap packet

We weren't taking the revid into account

Change-Id: Ice82717ada14c7e85b6191470d7174189f878073",0,1,1,0,0,1,1,0,0,
17666,Idf5f35739cb286a8e808891a202964ca67e685cf,http://review.couchbase.org/#/c/17666,1,2532570624d694c5035e1baeb13c785e4c9238df,2a3b51663097ee4d1447b6da28ed2d1d9db869ff,1,27/06/12,03/07/12,2,Comment correction in MemcachedConnection.  Non-javadoc.,"Comment correction in MemcachedConnection.  Non-javadoc.

Change-Id: Idf5f35739cb286a8e808891a202964ca67e685cf",0,0,0,1,0,1,1,0,0,
17667,I7d41ef0e1781fc1c1f3b3ca01cf07edf5b3d3639,http://review.couchbase.org/#/c/17667,1,2a3b51663097ee4d1447b6da28ed2d1d9db869ff,3d05f40c5f380ee6f668092771b7a1895eefddeb,0,27/06/12,11/07/12,11,Let offline try to work with already downloaded mvn.,"Let offline try to work with already downloaded mvn.

Change-Id: I7d41ef0e1781fc1c1f3b3ca01cf07edf5b3d3639",0,0,0,1,0,1,1,NA,NA,
18196,I7730bf378e9437d6575d5e9880295a25571d28f6,http://review.couchbase.org/#/c/18196,3,9638536ce37a07b41b905838b2c879cf33f77ba5,44eaf09e622b25d300681c3e8cb19d77df905ac4,1,11/07/12,11/07/12,3,JCBC-72: Make OperationException extendable,"JCBC-72: Make OperationException extendable

Change-Id: I7730bf378e9437d6575d5e9880295a25571d28f6",0,0,0,1,0,1,1,0,0,
18670,I755b18aa487247a445657726ae2dc8dad6a27991,http://review.couchbase.org/#/c/18670,4,6b18b50090c8d9721726a1924241d54398f81f2e,46e90607c6bb489ad7b4ddfb1d41751a5a1d58b6,1,21/07/12,24/07/12,10,Disable optimization by default.  SPY-88 workaround.,"Disable optimization by default.  SPY-88 workaround.

Change-Id: I755b18aa487247a445657726ae2dc8dad6a27991",0,1,1,1,0,1,1,0,0,
18682,I9c320db96a1a1587d39696195f44a1d775cdd0a8,http://review.couchbase.org/#/c/18682,1,7bae7ab7f66275d2332815e9860e2425486f75db,5f7828d89f5d9ae00451d6b8f33e1d022e1f3c59,1,23/07/12,23/07/12,6,Correct test for StringUtils.join().,"Correct test for StringUtils.join().

Change-Id: I9c320db96a1a1587d39696195f44a1d775cdd0a8",0,0,0,1,0,1,1,0,0,
18683,Id6e04ed1787e140c5072a78cece682c45fe06313,http://review.couchbase.org/#/c/18683,2,1d4ee86e3f12547c9faab25bbc4acc54479162d3,f0d324980f42ff04f27e46ca809ccbcb82dc655e,1,23/07/12,25/07/12,354,Revert ErrorCode and OperationStatus changes.,"Revert ErrorCode and OperationStatus changes.

This is a squashed revert of two separate commits. After
disabling optimization, I still found failing tests. I had
thought it was related at first, but after doing a bisect
it clearly identified the ""Create an ErrorCode class"" as
the culprit. In combination with the OperationState
correctly being volatile, it would regularly fail in the
midst of bulk operations.

This commit reverts:
""OperationStatus now has an error code""
 commit cdc26cdfaeecc63714c1edcf297d6ffc2c9b8554 and
""Create an ErrorCode class for error codes""
 commit 82ad6cb4629a2c98fdebc55ad10f058cd2767ff9.

Change-Id: Id6e04ed1787e140c5072a78cece682c45fe06313",0,0,0,0,0,1,1,-1,0,
18996,Ifbb7b619f1e9d85433ff6c7a07ea4cc292737285,http://review.couchbase.org/#/c/18996,2,1476a52a91f64c828302b0133aec5a363c07459c,aaf2da933316b19635f2cd6b3e70b136e672600e,1,28/07/12,30/07/12,4,Change selection key logging to debug level.,"Change selection key logging to debug level.

Change-Id: Ifbb7b619f1e9d85433ff6c7a07ea4cc292737285",0,0,0,1,0,1,1,0,0,
19035,I72161b5867b12aa31206a8924f46651cc0566d11,http://review.couchbase.org/#/c/19035,1,aaf2da933316b19635f2cd6b3e70b136e672600e,a5fb6df43b31a16c650ea5cefb835570a56d26a4,1,30/07/12,30/07/12,68,Fixed misc checkstyle errors which crept in.,"Fixed misc checkstyle errors which crept in.

Change-Id: I72161b5867b12aa31206a8924f46651cc0566d11",0,0,0,1,0,1,1,0,0,
19534,Ieced868b0b9870838801fd45eee010f61e215fd6,http://review.couchbase.org/#/c/19534,2,d7b89cf226a14a574a8f90d2d5f3b25def13ddfc,c93ac5f20e7882ee428b59e22e088e57cc319021,1,13/08/12,13/08/12,119,Adding a getCas() for Store functions,"Adding a getCas() for Store functions

Change-Id: Ieced868b0b9870838801fd45eee010f61e215fd6",0,0,0,1,0,0,1,0,0,
19537,I94a0709e0856b5dd72d108feec9574b0836b4fbf,http://review.couchbase.org/#/c/19537,3,c93ac5f20e7882ee428b59e22e088e57cc319021,40c29f07e4ae7b9b9bbe5b8e08ab56201ffe5150,1,13/08/12,17/08/12,313,Changes for Observe.,"Changes for Observe.

Change-Id: I94a0709e0856b5dd72d108feec9574b0836b4fbf",0,0,1,1,0,0,1,1,1,
19538,I20b0e9734c7fa170edcd38c76e59f353f4a4df41,http://review.couchbase.org/#/c/19538,4,a8d3a0a87a1969b801c714c256a059decf118d80,cf8d66649850ea0f5cba6b3b48c9a813037f8abf,1,13/08/12,19/08/12,5,Fixed failing Unlock test,"Fixed failing Unlock test

Change-Id: I20b0e9734c7fa170edcd38c76e59f353f4a4df41",0,1,1,1,0,0,1,0,0,
19847,I47960883b515a1d2b571e5b286179337dd960b2e,http://review.couchbase.org/#/c/19847,1,9b3d4f6f2f644c8d2c4571ed071070f5a7e3b9b6,d7dd463590483e5464c349118e03b8a2a5713e5f,1,19/08/12,19/08/12,2,Add the node back to connected during reconnect.  Issue 225.,"Add the node back to connected during reconnect.  Issue 225.

The connection was being added back a bit later than its
reconnect, causing operations to continue to timeout.  It's
not clear if this is platform specific or not, but this change
is reported to work.

See http://code.google.com/p/spymemcached/issues/detail?id=225

Change-Id: I47960883b515a1d2b571e5b286179337dd960b2e",1,0,0,0,0,0,1,0,0,
19919,Id2a1483bc1c75268f579b3df88ae4e8d488b6f46,http://review.couchbase.org/#/c/19919,4,82feec75f4ded36668033cb7a474e24b15b36c7d,1684235a67935c6312a3b7da69226d9549bdb621,1,21/08/12,21/08/12,26,Fixed issues with the Observe Method(s),"Fixed issues with the Observe Method(s)

Change-Id: Id2a1483bc1c75268f579b3df88ae4e8d488b6f46",0,1,0,1,0,0,1,0,0,
28018,I2fb28d96121c5bd337ec1c33c8e907a13e3a8bfa,http://review.couchbase.org/#/c/28018,3,323d9baa4112de088507b5da05cf06c1bfb9a556,b92ceb7c8e7083e9351ed3dd7e1400e71738ddd0,1,08/08/13,30/08/13,33,SPY-131: Expose cas with expiration.,"SPY-131: Expose cas with expiration.

This changeset simply exposes the expiration time on cas() without
a custom transcoder and adds tests to verify the correct behavior.

Change-Id: I2fb28d96121c5bd337ec1c33c8e907a13e3a8bfa",0,0,1,0,0,1,1,0,0,
28025,I516af74918e57521542a0bad2ff7142b75ab7b13,http://review.couchbase.org/#/c/28025,14,12d04ccb1efc7403632eb34a0dcc883e4c019548,1f592cfe5e7b88ac0cde5ddd24015bb7a6e9a191,1,08/08/13,05/09/13,842,WIP: Adding Callbacks to Futures.,"WIP: Adding Callbacks to Futures.

This changeset adds a onComplete callback to futures and executes
the callback in a configurable ExecutorService. By default, this
is a 2 thread fixed size thread pool, but configurable through
the Factory.

TODO:
 - Refine Interface to make it more straightforward.
 - Add callbacks to other futures (BulkFuture, BulkGetFuture,
   GetFuture, ImmediateFuture)
 - Much more testing on those futures
 - Add test to override with a custom executorService

Change-Id: I516af74918e57521542a0bad2ff7142b75ab7b13",0,1,0,0,1,1,1,0,0,
28292,I7c7e935e4307c181f98e5ff5615b18cba3f403b4,http://review.couchbase.org/#/c/28292,8,57a0ae8ff7599ffd7a99381509731c5b1b1ad544,c85a27867e492e3d60331ff1ffb257aab8c2164f,1,16/08/13,27/08/13,89,WIP: SASL md5 cram.,"WIP: SASL md5 cram.

Change-Id: I7c7e935e4307c181f98e5ff5615b18cba3f403b4",0,1,1,1,0,1,1,0,0,
28575,If206f0be0c0bd6c6ff11d63f1be25debab2e524e,http://review.couchbase.org/#/c/28575,6,9867328407d473ea512498089a704126e06a7100,b856d6a74cb3bc858f2d4928bfae9f8252585b1c,1,26/08/13,04/09/13,913,SPY-133: Add additional metrics support.,"SPY-133: Add additional metrics support.

This changeset adds basic metrics for performance measurement and
debug support. It is optional and can be enabled through the factory
or via a system property.

The collected values can be exported through:
 - The Console
 - JMX
 - CSV
 - SLF4J

These output reporters can also be configured through properties, by
default the console reporter will be used.

TODO:
----
 - Add basic testing of creation
 - (not included here) basic profiling to see perf impact on load
 - Add JavaDoc
 - Run all Test for verification

Change-Id: If206f0be0c0bd6c6ff11d63f1be25debab2e524e",0,1,0,0,1,1,1,0,0,
28738,Ief5af0aa2267665e763972f39bd27e7ca6894e7b,http://review.couchbase.org/#/c/28738,2,cfea39217ec2487ffd60a8e44647a70cac6dd91f,e5bcb92365942c0ac0311c76414bf75aa0ebbc63,0,02/09/13,02/09/13,3,Ignore IntelliJ Idea .idea directory.,"Ignore IntelliJ Idea .idea directory.

Change-Id: Ief5af0aa2267665e763972f39bd27e7ca6894e7b",0,0,0,1,0,1,1,NA,NA,
28765,If564fdb8eee84ff2f1fe39718588bbe5fb98f4a6,http://review.couchbase.org/#/c/28765,2,e5bcb92365942c0ac0311c76414bf75aa0ebbc63,c0b94c9e3f31f773d6c5b0cc38b643d7990504cc,0,03/09/13,03/09/13,2,Ignore intellij directory on ant clean.,"Ignore intellij directory on ant clean.

Change-Id: If564fdb8eee84ff2f1fe39718588bbe5fb98f4a6",0,0,0,1,0,1,1,NA,NA,
28792,Ic94d7a3a2ce4cd8c17f2aeb94b57eb670e2a41a5,http://review.couchbase.org/#/c/28792,3,36aafbcf6c32243c0f501607ff9ab882cf01d7ff,9e5d4ab265f37bcf2d4b267bc76da3e4ee82ca9a,1,04/09/13,04/09/13,98,Remove unreliable tests.,"Remove unreliable tests.

Change-Id: Ic94d7a3a2ce4cd8c17f2aeb94b57eb670e2a41a5",0,0,0,1,0,1,1,0,0,
29346,I99ecf0b293a9d52871b81e9166f07a35f90c712a,http://review.couchbase.org/#/c/29346,2,4303da40f931e1d05f3688f64069afa7e4e61a68,ba69d48c9c2e4a8f232bab4512fc93fecec86648,1,04/10/13,08/10/13,36,SPY-135: Expose asyncCAS with Expiration and default transcoder.,"SPY-135: Expose asyncCAS with Expiration and default transcoder.

Change-Id: I99ecf0b293a9d52871b81e9166f07a35f90c712a",0,0,1,1,0,1,1,0,0,
29372,I23bf0a30cc96c5721d6ed0d5c16bdfc2113c0fe4,http://review.couchbase.org/#/c/29372,4,f16be1ee380900b5127152f6ea88d239bd3d26e8,e30224d0b60a829cbbcc88a300bc8cab86e47e8f,1,07/10/13,09/10/13,7,SPY-137: Properly shutdown executorService on shutdown().,"SPY-137: Properly shutdown executorService on shutdown().

Change-Id: I23bf0a30cc96c5721d6ed0d5c16bdfc2113c0fe4",0,1,0,1,0,1,1,0,0,
29373,I6f9c577f734c33f2d6004031253dd561b6302b4c,http://review.couchbase.org/#/c/29373,4,4a624704e395daced274eb277d5af9d179d57e76,7d7442d938bb39ebd5e8b561020dffc357ba7aba,1,07/10/13,09/10/13,95,SPY-138: Allow the ExecutorService to be overridden.,"SPY-138: Allow the ExecutorService to be overridden.

Change-Id: I6f9c577f734c33f2d6004031253dd561b6302b4c",0,1,0,1,0,1,1,0,0,
29548,I3e3db7861a6e6e6c24c61c40ea02b19c8bc57fab,http://review.couchbase.org/#/c/29548,2,c6aacc5cf35e6b5b953e8c89d3223671541e9179,47f45f369a8b90a775028588cddd8c89e07a9641,1,15/10/13,16/10/13,2,SPY-140: Use LinkedBlockingQueue for listener task queuing.,"SPY-140: Use LinkedBlockingQueue for listener task queuing.

Change-Id: I3e3db7861a6e6e6c24c61c40ea02b19c8bc57fab",0,0,0,1,0,1,1,0,0,
29584,Ic944bca9c7e005fb793edc0ddb3a51674f2d2be0,http://review.couchbase.org/#/c/29584,2,47f45f369a8b90a775028588cddd8c89e07a9641,f059a3c1a6bfe4312d6222d48d961ce3619da3bb,1,16/10/13,21/10/13,2,SPY-141: Do not assume positive CAS.,"SPY-141: Do not assume positive CAS.

This changeset makes sure that when loading the CAS value, there
is no assumption of the actual value done on the client side.
Especially, -1 is a valid CAS and can cause issues when running
with -ea in production (since the callback is executed on the
IO thread, it can die for no reason).

Change-Id: Ic944bca9c7e005fb793edc0ddb3a51674f2d2be0",0,0,1,0,0,1,1,0,0,
29585,I3ff86456c5f2f28e206612890c08834fc96935f1,http://review.couchbase.org/#/c/29585,3,ecd6863708d25a215111afac5950b7b7201adc00,29d39216a4deadbb9d39f87648215c4263e33a0f,1,16/10/13,28/11/13,36,SPY-106: Allow GetAndTouchOperation to be cloned.,"SPY-106: Allow GetAndTouchOperation to be cloned.

This fixes an issue where GAT called during rebalance, causing it
to be cloned potentially, fails the IO threads since its not
supported in there properly.

Change-Id: I3ff86456c5f2f28e206612890c08834fc96935f1",0,0,0,0,0,1,1,0,0,
29657,I270e91e0794ea7de10cd26a9dafc85e35f87095d,http://review.couchbase.org/#/c/29657,2,292d5aa04d156611da28437322c820eb44e5bdf4,d6af139e69e997cbe2028b664feb097efe5cc951,1,21/10/13,28/11/13,2,SPY-136: Do not timeout when waiting on the sasl mechs.,"SPY-136: Do not timeout when waiting on the sasl mechs.

Since we also dont timeout on the return of the auth op, keeping
the process consistent. This avoids the situation where the server
is potentially rebooting and the timeout occurs. In combination with
code depending on the sasl list, exceptions can occur and the auth
thread dies.

Change-Id: I270e91e0794ea7de10cd26a9dafc85e35f87095d",0,0,0,0,0,1,1,0,0,
30415,I6846fe9b23d43d9f2e257a5206a511f941aed8ff,http://review.couchbase.org/#/c/30415,5,985e41a74d7a272d907edfb713b773964bebbc22,2a6db10337854243a591f74696e800f4b5764b9f,1,20/11/13,28/11/13,39,SPY-144: Avoid growing callstack on get* clones.,"SPY-144: Avoid growing callstack on get* clones.

This changeset makes sure that if an operation gets cloned over
and over again (which is not the norm, but can happen in certain
failure scenarios), it will not lead to a stack overflow.

Change-Id: I6846fe9b23d43d9f2e257a5206a511f941aed8ff",0,1,1,0,0,1,1,0,0,
30416,I3369606afeef00b50740e54c01a78e89682cade1,http://review.couchbase.org/#/c/30416,3,e8f2c57ff0051e5c4e5f826d299978b20086c6fd,f6d27f5949266c719b618ed60a65c2a431c72315,1,20/11/13,28/11/13,947,This changeset refactors the MemcachedConnection class.,"This changeset refactors the MemcachedConnection class.

It also breaks out certain large blocks into their own methods
to make it better readable and easier for the JIT to inline
the code.

Change-Id: I3369606afeef00b50740e54c01a78e89682cade1",0,0,1,0,1,1,1,-1,0,
30417,I1be0a3ea410e9bed0a155ac821d41bf64125beac,http://review.couchbase.org/#/c/30417,4,dad8359c876e890c3c70dabc4929f069303721e6,058dc6dd4e3059176e5a59cff96d009a553f52c3,1,20/11/13,02/12/13,141,SPY-145: Make MemcachedConnection inline properly.,"SPY-145: Make MemcachedConnection inline properly.

Change-Id: I1be0a3ea410e9bed0a155ac821d41bf64125beac",0,1,0,1,0,1,1,-3,0,
30418,Ia03701670d9b3bb82d7e8c4798dd5cb99c9e25c7,http://review.couchbase.org/#/c/30418,4,34745fb1f8250494f13816eac9dce0c8d51e87f4,da9d1378df837cad060d9771167bcdbc36437ea3,0,20/11/13,28/11/13,232,SPY-145: Make OperationImpl inline properly.,"SPY-145: Make OperationImpl inline properly.

Change-Id: Ia03701670d9b3bb82d7e8c4798dd5cb99c9e25c7",0,1,1,1,0,1,1,NA,NA,
30447,I89818f2a94e8e746c562b5a115602f8d3ccfb8d2,http://review.couchbase.org/#/c/30447,2,9cf9f694e98e36ea99d81304714e1524a9f0e1d2,90c2f3e7e24c4d5ad0e39ec47e5452e92a4b329c,0,21/11/13,28/11/13,3,Allow OperationImpl to be used elswhere.,"Allow OperationImpl to be used elswhere.

Change-Id: I89818f2a94e8e746c562b5a115602f8d3ccfb8d2",0,0,1,1,0,1,1,NA,NA,
30448,Ia71874207b5a213074e2ca525aa3eb37ff80e24b,http://review.couchbase.org/#/c/30448,5,aa934b91c8f755e79b2849776051fe1771d03a08,1d28f3ab82448cb73f0ad6df15a735e9eece2bdb,1,21/11/13,31/01/14,44,WIP: CCCP,"WIP: CCCP

Change-Id: Ia71874207b5a213074e2ca525aa3eb37ff80e24b",0,1,0,1,0,1,1,-4,0,
30701,I48b68127f384e3bcb963a5df1cddd5b5c2d5ca7a,http://review.couchbase.org/#/c/30701,3,187164e09f4181556651ec7d3d9ce13c40eabe81,e941d24f1b4008ee621b9694c395d071791f7a15,0,29/11/13,02/12/13,5,SPY-146: Use correct length of key in observe.,"SPY-146: Use correct length of key in observe.

This changeset makes sure that the correct length of the key is used in the
protocol. Since UTF-8 chars like the pound sign (currency) are represented
in two bytes but are one character in a string, the length of the key needs
to be determined after it is converted into a byte array.

Change-Id: I48b68127f384e3bcb963a5df1cddd5b5c2d5ca7a",0,0,0,0,0,1,1,NA,NA,
31669,Iedb899ed9d70a5d76e7d3891524336a21edf34b8,http://review.couchbase.org/#/c/31669,2,b37635e5d3b4457a3c36ee251f98ec5692f57123,0a504b232069521eab6ee78c234a680528f47e4f,1,07/01/14,07/01/14,98,Syncing MemcachedClientIF with MemcachedClient.,"Syncing MemcachedClientIF with MemcachedClient.

This changeset makes sure all implemented methods are available
in the interface. Also, @Override annotations are added for
clarity.

Change-Id: Iedb899ed9d70a5d76e7d3891524336a21edf34b8",0,0,0,0,0,1,1,0,0,
31670,I1a9140635781bf622c6aeba4156f5e1cb7f5b468,http://review.couchbase.org/#/c/31670,3,0a504b232069521eab6ee78c234a680528f47e4f,2e1fa08d7055fdcd8f5a11815fc77fc73b568828,1,07/01/14,07/01/14,91,Cleanup of MemcachedClient.,"Cleanup of MemcachedClient.

This changeset adds more @Override annotations and does some minor
cleanup.

Change-Id: I1a9140635781bf622c6aeba4156f5e1cb7f5b468",0,0,0,0,0,1,1,0,0,
31714,I99686c212d8610299f78078b28d31b7891da8d1c,http://review.couchbase.org/#/c/31714,5,3e840f372ee40c74feb3312baf4efd9796ba1805,13e9c54abacec2f4a483d16334efecc82eb99db5,1,08/01/14,08/01/14,57,SPY-149: Notify Listeners after Complete.,"SPY-149: Notify Listeners after Complete.

This changeset honors the fact that setting the status and actually
completing the latch can happen at two different points in time.
Without this change, effects can be observed that a listener is called
but the latch has not been counted down yet, leading to weird effects.

Also see https://github.com/mathieuancelin/play2-couchbase/issues/33
for a dependent issue.

Change-Id: I99686c212d8610299f78078b28d31b7891da8d1c",0,1,0,0,0,1,1,0,0,
31715,I7457d036b70ba6dd30d6d99dd9d8cbcbaa0cf3dd,http://review.couchbase.org/#/c/31715,3,4ccf48c22dff2d79de732df709c3ea59ffbfcb47,89f8ca291c0662da30713f957f6e5b17ba1892aa,1,08/01/14,03/02/14,13,SPY-148: Do not rename the worker thread for listeners.,"SPY-148: Do not rename the worker thread for listeners.

It's more explicit if the naming of the threads is left to the
executor service (through custom thread factory).

Change-Id: I7457d036b70ba6dd30d6d99dd9d8cbcbaa0cf3dd",0,0,0,0,0,1,1,0,0,
31732,I261bcf045264b041bdea8ec0df0fab3c711cd64f,http://review.couchbase.org/#/c/31732,2,0d45bb0fef88be352320c6b60cb548a58206acfd,d06101cfd1d89698c16d798bd20204646e6d7475,0,08/01/14,08/01/14,1,Add missing import.,"Add missing import.

Change-Id: I261bcf045264b041bdea8ec0df0fab3c711cd64f",1,0,0,1,0,0,1,NA,NA,
31828,I386fea0da2d06b655c7e3cd0d843761d59ee7e28,http://review.couchbase.org/#/c/31828,4,d06101cfd1d89698c16d798bd20204646e6d7475,04b1cb35da045aedd37c28a53d84cf78a09defa1,1,10/01/14,16/01/14,21,fix Authread Hang issue while shutting down connection,"fix Authread Hang issue while shutting down connection

Change-Id: I386fea0da2d06b655c7e3cd0d843761d59ee7e28",0,1,1,1,0,0,1,0,0,
32337,Ic9de6711a32575c81a499b360923f21d8cfd13ff,http://review.couchbase.org/#/c/32337,5,bfb56ebb089fe19a6ff1978d936b01fec133566c,9d5c697560edc0de1aef924c704e5d6c12a38419,1,13/01/14,16/01/14,20,check connection status before executing latch.await,"check connection status before executing latch.await

Change-Id: Ic9de6711a32575c81a499b360923f21d8cfd13ff",0,1,1,1,0,0,1,0,0,
32588,Ic777b04e87670f0a9d967b4a439fea205b129e97,http://review.couchbase.org/#/c/32588,4,3772e3fe627a88887e8495260b2f4ce92d901d1d,cd82a485a8630138788e125c26f99b9b02d080f1,1,17/01/14,14/02/14,14,Changes for the New feature test for credential encryption CRAM-MD5 or PLAIN,"Changes for the New feature test for credential encryption CRAM-MD5 or PLAIN

Change-Id: Ic777b04e87670f0a9d967b4a439fea205b129e97",0,1,0,1,0,0,1,0,0,
33405,Ie416e317d5fd21af2c3efb177b08b68dd8c45639,http://review.couchbase.org/#/c/33405,5,795947bfdcbb3eb3cf06c57dc17aefb13f418199,316463197d00e27bc3ad7317bcf2cb30217df633,1,10/02/14,25/02/14,294,WIP: Add ENUM StatusCode.,"WIP: Add ENUM StatusCode.

Change-Id: Ie416e317d5fd21af2c3efb177b08b68dd8c45639",0,1,1,1,0,1,1,1,1,
33700,I6413233a3d0289ab728312f8f4edab5df96a0081,http://review.couchbase.org/#/c/33700,7,0a2ddc0769ffcf5a032a88b356577cf8fe98374a,93b6354ae6a8ba4ea1f479353272b3bace7f5756,1,18/02/14,06/03/14,71,SPY-154: Also RETRY on binary NMVB response with bulk gets.,"SPY-154: Also RETRY on binary NMVB response with bulk gets.

This changeset makes sure that even when one of the individual get
operations in the bulk request fails with a ""Not My VBucket"", the
whole bulk is scheduled for retry.

Note that while just scheduling the one failed get for retry would
be more efficient, this would mean a much larger change to the
overall system, so this should be a good tradeoff for this rather
special case.

Change-Id: I6413233a3d0289ab728312f8f4edab5df96a0081",0,1,0,0,0,1,1,1,1,
33799,Ib218669b6bbc84f3111e107e14761a03ed2f9728,http://review.couchbase.org/#/c/33799,5,f822afae575e896da88a3d28cb24bdedb8aa3097,4a519dd38a6810f464615422bc15abc11589886e,1,20/02/14,25/02/14,180,Add the CAS to the callback for ReplicaGetOperation.,"Add the CAS to the callback for ReplicaGetOperation.

In order to be more flexible when analyzing the response of a
ReplicaGet request, the response now also has the flexibility
to look at the returned CAS value. This can be utilized either
as a regular ""get"" or as a more rich ""gets"" response.

Change-Id: Ib218669b6bbc84f3111e107e14761a03ed2f9728",0,1,1,0,0,1,1,0,0,
33800,I4cfa0036c2b7b89985b0026c5da5dca26cc9fe52,http://review.couchbase.org/#/c/33800,3,47d19a219d1a39f109c33aff4740aeef09ed4ce8,4998b0b1e7f352301dde55d3bd7c2e18cc352a38,1,20/02/14,25/02/14,7,Synchronize when listeners are called.,"Synchronize when listeners are called.

This changeset prohibits a possible race condition when listeners
are called from the callback. Proper sync has been in place for
both adding and removing, but not for notifying.

Change-Id: I4cfa0036c2b7b89985b0026c5da5dca26cc9fe52",0,0,1,0,0,1,1,0,0,
34184,I7616d2b042896aa76d73d536a3dde1c998990d9b,http://review.couchbase.org/#/c/34184,2,8fab1f831bf2eefe3dbbb24a83eb9cd57105fb1b,3f9fb23a18789d105e9772c15de868e2080a60d1,1,05/03/14,06/03/14,293,SPY-127: Optimize StringUtils performance.,"SPY-127: Optimize StringUtils performance.

This changeset optimizes the individual StringUtils methods, especially
the isJsonObject method. Before, if no proper JSON was detected, a final
check against an Integer was performed. If no integer was found, a very
expensive exception was thrown, killing performance.

This check has been replaced with a faster regex. Also, other parts
of the methods have been refactored to be more performant.

Change-Id: I7616d2b042896aa76d73d536a3dde1c998990d9b",0,0,0,0,0,1,1,0,0,
34257,I4403b14d6146afb325afa9c239da28b55e89e935,http://review.couchbase.org/#/c/34257,7,96351d945a88ca37def65e3039881d17f18ecb15,eb9c4e0e7fcefecef2ea6316615181e103741101,1,07/03/14,26/03/14,221,SPY-156: Expose more async mutate methods.,"SPY-156: Expose more async mutate methods.

This changeset exposes more async mutate variants, now they are on
par with the sync ones.

Change-Id: I4403b14d6146afb325afa9c239da28b55e89e935",0,1,1,0,0,1,1,0,0,
34728,I4a348f50e41451a6542b4b0263b915990730c3f8,http://review.couchbase.org/#/c/34728,4,a4f7d1f103bed420dade9a3e09cc44fa7b03a359,8fd575557d993a628c73e782b7906620dd44d42c,1,20/03/14,20/03/14,2,SPY-158: Use Milliseconds instead of Seconds for Max_Reconnect delay.,"SPY-158: Use Milliseconds instead of Seconds for Max_Reconnect delay.

Motivation:
Currently, when a reconnection needs to happen against a node, a incremental
delay for subsequent reconnect tries is selected. Because of the wrong time
format used (seconds instead of milliseconds), the delay is always capped
at 30ms, leading to immediate reconnects with no backoff effect.

Modifications:
For backwards compatibility, the ""second"" time unit is kept in the factory,
and instead in the MemcachedConnection the time is converted to milliseconds.

Result:
A proper reconnect delay going from 2^0 seconds up to 2^4 seconds, peaking at
30 seconds by default (as always changeable through the factory)

This changeset makes sure that

Change-Id: I4a348f50e41451a6542b4b0263b915990730c3f8",0,1,0,0,0,1,1,0,0,
34845,I837eb73cb07560aef15301490eaab56e484be3a8,http://review.couchbase.org/#/c/34845,7,8fd575557d993a628c73e782b7906620dd44d42c,efa3dc93e504dad50010e7f06f2ef5f4dcd6a532,1,24/03/14,27/03/14,92,Add development pom.xml,"Add development pom.xml

Motivation
----------
While ivy/ant works for years now, it is a little too hard to get
started when contributing simple patches with IDE setup. Since most
IDEs have good maven support, adding a pom.xml to get up and running
quickly makes it easier to contribute and develop.

Modification
------------
Add a pom.xml which is inteded to get up and running quickly. It is not
designed to do release management, which still happens through the
ant/ivy pipeline.

Result
------
Contributors and developers can import the project more easily and
contribute patches.

Change-Id: I837eb73cb07560aef15301490eaab56e484be3a8",0,1,1,0,0,1,1,0,0,
34846,Id06f4ede00402688c00a283bcff82cde25a7a205,http://review.couchbase.org/#/c/34846,4,214a87b525f2fd3d8afbcc48bc8494b62c0f73ee,cc1685dd5c012a620faa22bec7ce6a192573337e,1,24/03/14,26/03/14,75,SPY-159: Make the auth latch timeout configurable.,"SPY-159: Make the auth latch timeout configurable.

Motivation
----------
Currently, the auth latch timeout is fixed to one second and not changeable.
In certain scenarios (for example with CRAM-MD5 where more roundtrips need
to be issued), this is too short. Making it configurable allows to adjust the
setting to latencies in target environments.

Modification
------------
Expose a ""authWaitTime"" setting in the factory and the builder to allow set
the value in milliseconds. It still defaults to one second for backwards
compatibility.

Result
------
The auth timeout can be modified as needed in production deployments.

Change-Id: Id06f4ede00402688c00a283bcff82cde25a7a205",0,1,0,0,0,1,1,2,1,
34849,I3deab53332251263c5a6dcf3e2bfd75538dfb24c,http://review.couchbase.org/#/c/34849,3,86d1be46fcf0d40a7270d20fde35978be4ae2598,df4de9fcc0850e34b1b674846335c6ee19d140e4,1,24/03/14,26/03/14,37,SPY-157: Add Auth logging.,"SPY-157: Add Auth logging.

Motivation
----------
Debugging how long authentication steps take is currently not
possible. Proper logging needs to be added in order to debug
authentication timeframes.

Modifications
-------------
Added logging infrastructure for the individual steps (list sasl
mechs, and challenge/response cycles), as well as a total amount
on a per-node basis.

If an individual step takes over 250ms it is WARNed instead of
DEBUGed, and if the total auth step takes over 1 second it it also
WARNed. Note that while these timings are fixed values, in general
the operation taking this long points to something wrong since it
is expected to take in the 1ms range.

Result
------
Auth times can now be observed both in development and production,
better pointing to possible issues.

Change-Id: I3deab53332251263c5a6dcf3e2bfd75538dfb24c",0,0,0,0,0,1,1,1,1,
34852,I6f849314e11435a6ebc69a4bfc1eab705df850e8,http://review.couchbase.org/#/c/34852,4,e787a91dba3d6bedb7228b79d76497ff862499d9,6cd34da6b3bdcddde61be7e47effa4bb768a8d32,1,24/03/14,26/03/14,160,SPY-160: Redistribute ops when waiting for authentication to complete.,"SPY-160: Redistribute ops when waiting for authentication to complete.

Motivation
----------
When an operation gets added and the node needs to (re)connect, it waits
for a given amount of time (authWaitTime). If the auth does not complete
in the period of time, the operation is cancelled. This is suboptimal,
especially if the operation is not timed out yet, it could wait longer
until it gets timed out/cancelled.

Modifications
-------------
This changeset makes sure that an operation gets redistributed (assuming
FailureMode is NOT cancel) if the authLatch is not counted down in the
wait period.

Redistributing will only happen (further down the code stack) if the
op is 1) not cancelled and 2) not timed out already.

Result
------
Still valid operations will be transparently rescheduled until they
either go through validly or will eventually time out or get
cancelled.

Change-Id: I6f849314e11435a6ebc69a4bfc1eab705df850e8",0,1,0,0,0,1,1,1,1,
34883,I304534a62202b705d78ca5f775f47afcd6be238a,http://review.couchbase.org/#/c/34883,8,b8564bde9126c468458c182cfbe425e0e7216991,d4e894d5c1eb2cc2191b07fbbd265bb38d93860d,1,25/03/14,04/04/14,81,Verification Pending: Cascade op cancellations.,"Verification Pending: Cascade op cancellations.

Motivation
----------
When an operation is redistributed (be it because of reconnects
and/or ""not my vbucket"" responses, it gets cloned. The problem
is that the initial callback always points to the original
operation, not the cloned one. While the clone gets the callback,
the other way round (like cancelling from user-code) will never
trickle through to the cloned ops.

Modifications
-------------
In order to fix this issue, code has been added which connects
the original op with the cloned ones, by keeping a list of
cloned operations in the original op. To prevent overly long
stack is malicious scenarios, an overall clone-cap of 100
clones is introduced. If this cap is reached, the operation
will not be cloned further but cancelled.

Result
------
With this modifications, timeouts and cancellations from user code
will trickle through to the clone operations, prevent issues when
cloned operations are around ""forever"".

Change-Id: I304534a62202b705d78ca5f775f47afcd6be238a",0,1,0,0,0,1,1,1,1,
34936,Id174a49e03e052f9e32c98cc32aa7ad0b82bbb4d,http://review.couchbase.org/#/c/34936,2,d36a335a7490c3d61a787ef3c3a02c39e1f3122e,ecf6e8b22be613ee82ea9f222f8dce08fe1be075,1,26/03/14,27/03/14,10,SPY-157: Fix auth logging times.,"SPY-157: Fix auth logging times.

Motivation
----------
In the previous commit which added logging, it measured nanoseconds and printed
milliseconds. This also screwed up the debug/warn metric.

Modifications
-------------
Correctly convert nanoseconds to milliseconds.

Result
------
Timings are now properly warned and formatted.

Change-Id: Id174a49e03e052f9e32c98cc32aa7ad0b82bbb4d",0,0,0,0,0,1,1,0,0,
34938,I73a8e77255a54bceeb929febcadb0e555febdd67,http://review.couchbase.org/#/c/34938,2,c4c6a360c11aef887d3ea7ecbc8054acd76a233e,9504370629f8dd14e27ee3f4f548a54d01df9cc8,1,26/03/14,27/03/14,12,SPY-160: Queue retry op instead of redistributing it immediately.,"SPY-160: Queue retry op instead of redistributing it immediately.

Motivation
----------
After making the original SPY-160 changes, the ops were correctly redistributed,
but if the latch never gets counted down it gets recursively distributed and
added. Example:

	  at net.spy.memcached.protocol.TCPMemcachedNodeImpl.addOp(TCPMemcachedNodeImpl.java:344)
	  at net.spy.memcached.MemcachedConnection.addOperation(MemcachedConnection.java:1206)
	  at net.spy.memcached.MemcachedConnection.redistributeOperation(MemcachedConnection.java:994)
	  at net.spy.memcached.protocol.TCPMemcachedNodeImpl.addOp(TCPMemcachedNodeImpl.java:350)
	  at net.spy.memcached.MemcachedConnection.addOperation(MemcachedConnection.java:1206)
	  at net.spy.memcached.MemcachedConnection.redistributeOperation(MemcachedConnection.java:994)
	  at net.spy.memcached.protocol.TCPMemcachedNodeImpl.addOp(TCPMemcachedNodeImpl.java:350)
	  at net.spy.memcached.MemcachedConnection.addOperation(MemcachedConnection.java:1206)
	  at net.spy.memcached.MemcachedConnection.redistributeOperation(MemcachedConnection.java:994)

Modifications
-------------
The changeset, instead of redistributing right now, adds the operation to the retry queue which means
it will be handled eventually, but gives the IO thread a chance to run other tasks (including retreiving
auth response information).

Result
------
The operation is queued and is not blocking the IO thread.

Change-Id: I73a8e77255a54bceeb929febcadb0e555febdd67",0,0,0,0,0,1,1,0,0,
34977,Ieff1a87136bef38280b7f139192419073d6a878a,http://review.couchbase.org/#/c/34977,2,71d9e7ac69217da7bbec3795b7d6ddf0d66b1b97,d3a405409e4c3b18e68d96d6e29190d26a44c4cd,1,27/03/14,27/03/14,12,SPY-160: Avoid ConcurrentModificationException with the retry queue,"SPY-160: Avoid ConcurrentModificationException with the retry queue

Motivation
----------
ConcurrentModificationException will show up since the code can recursively
modify itself.

Modifications
-------------
Copy the original list into a temporary new one to avoid the exception.

Result
------
Redistribute on the retry list will work as expected, without an
exception.

Change-Id: Ieff1a87136bef38280b7f139192419073d6a878a",0,0,0,0,0,1,1,0,0,
35553,Ic0b513b8538a39710aaf8fd0f0f699a5c561bc09,http://review.couchbase.org/#/c/35553,2,947376fb9ce543be06d039665f7cc2e77d7dbdd4,d43b64cf8cfbf9eab1fc8338704c1e5986a4f184,1,10/04/14,14/04/14,1,SPY-162: Also respect nagle setting on reconnect.,"SPY-162: Also respect nagle setting on reconnect.

Motivation
----------
If a server connection is reset (because it is lost or a reconnection
is triggered), the nagle setting is not re-set properly.

Modifications
-------------
During the reconnect phase, properly re-set the nagle setting so it is
respected on the new connection.

Result
------
The custom nagle setting is respected and used even across new connections.

Change-Id: Ic0b513b8538a39710aaf8fd0f0f699a5c561bc09",0,0,1,0,0,1,1,0,0,
35672,I9f0fff8b2c3a6b1492fb0fd82746ff78f7b006c5,http://review.couchbase.org/#/c/35672,4,a10d5450f3980b23c808a57bd9852727437c4ce8,66ed43dd900fb077244f813dd6865b4ebacaff71,1,14/04/14,14/04/14,17,WIP: Enhanced auth logging on sasl failure.,"WIP: Enhanced auth logging on sasl failure.

Change-Id: I9f0fff8b2c3a6b1492fb0fd82746ff78f7b006c5",0,1,0,1,0,1,1,0,0,
36208,I0711c399d9f15010bc808e0f651ce6ad605c06f0,http://review.couchbase.org/#/c/36208,2,44557f0c134cf1a0f7d30ec4c583500c17796d4c,ddbc97c8b7baeb7ef32594ef8676a2e7965f5611,1,23/04/14,23/04/14,8,SPY-163: Count down bulk get latch even when empty key list is provided.,"SPY-163: Count down bulk get latch even when empty key list is provided.

Motivation
----------
When a empty iterator (or empty key list) is passed in to a get bulk operation,
a result is never returned and the thread is blocked because it waits on a
latch that will never be counted down (because no response will ever arrive).

Modifications
-------------
If no chunks with keys are sent out to the servers, the latch is initialized
to 0 right away so that the code doesn't need to wait at all.

Result
------
The code now returns properly with an empty map instead of blocking the thread
forever.

Change-Id: I0711c399d9f15010bc808e0f651ce6ad605c06f0",0,0,0,0,0,1,1,0,0,
36219,I7ebda58c2eadd62d8885e3eeac79d5a971e07979,http://review.couchbase.org/#/c/36219,8,010fc0a14347af9bae0dfb0d099552ad8b90d015,867c2747fe62e47edc639e14cdeea6090f3f7088,1,23/04/14,05/05/14,52,Pending Verification: Widen Listener lock to avoid deadlock,"Pending Verification: Widen Listener lock to avoid deadlock

Motivation
----------
Because of how the addListener and notifyListener works, it could be that
one deadlocks each other because they are waiting on the same locks from
different threads.

Modifications
-------------
The lock is widened to a method-wide synchronization to avoid potential
inner-method deadlocks.

Result
------
Since the lock is widened, there should be no inner deadlocks anymore.

Change-Id: I7ebda58c2eadd62d8885e3eeac79d5a971e07979",0,1,0,0,0,1,1,0,0,
36221,I7b8820bea20d0a0d9555f1bb9b2a46e5327a5f78,http://review.couchbase.org/#/c/36221,3,284640d58418abe149d9e19cf8d4d706f6af1642,993001ba0b92b544166005d233ae12d4887cfe66,1,23/04/14,05/05/14,45,SPY-164: Clone gets correctly.,"SPY-164: Clone gets correctly.

Motivation
----------
When a gets operation is cloned, it currently gets incorrectly cloned into
a regular get operation. This can cause issues later on.

Modifications
-------------
Make sure that a gets() gets correctly cloned into a new gets().

Result
------
The cloning is now properly done, based on the operation type.

Change-Id: I7b8820bea20d0a0d9555f1bb9b2a46e5327a5f78",0,0,0,0,0,1,1,0,0,
36222,If82cdfc810c758a4196415cb709a03ebd72c3d15,http://review.couchbase.org/#/c/36222,6,5a11ebb0df239fad024594f74853dab762513255,35b26510bd07f231e2db11085887f54617a5cd27,1,23/04/14,05/05/14,13,Do not cache the selectedKeys.,"Do not cache the selectedKeys.

Motivation
----------
Caching the selected keys may cause issues if the selector is accessed by different
threads, also the loop for the keys is not using the iterator correct.

Modifications
-------------
Make it not cache the keys and also correctly make use of an iterator to loop through
the keys.

Result
------
No stale/cached selected keys and correctly using the iterator should lead to better
stability during failure cases.

Change-Id: If82cdfc810c758a4196415cb709a03ebd72c3d15",0,1,0,0,0,1,1,0,0,
36258,I79fec436aa538a8a4074e82f69b3ed186c5126b7,http://review.couchbase.org/#/c/36258,3,89bef64e92a67b7bb022f89b8b87f3eba7c0f10c,622c67cecb3276c9e46e9b07bb21a51a21eb2724,1,24/04/14,05/05/14,43,"Only readd a WRITE_QUEUED operation, not clone it in addition.","Only readd a WRITE_QUEUED operation, not clone it in addition.

Motivation
----------
When a WRITE_QUEUED operation is redistributed, it needs to be readded
but not cloned (since its still in a sendable state).

Modification
------------
Return after adding the operation again.

Result
------
The operation is readded and not cloned afterwards too.

Change-Id: I79fec436aa538a8a4074e82f69b3ed186c5126b7",0,0,0,0,0,1,1,0,0,
36695,Icaca2f3fef658cdb2c376b6b4dba12ae0327f240,http://review.couchbase.org/#/c/36695,3,3c77a94e56104d80ddb9d797bf9af7a23752d5e9,e5a5c1acac5ea63428f1355b23544c10950c6a41,1,05/05/14,05/05/14,19,SPY-168: isJSONObject should handle null or empty input values.,"SPY-168: isJSONObject should handle null or empty input values.

Motivation
----------
Before this change, the isJSONObject was suspect to NPEs and possibly also
regex match failings on empty strings, although that does not seem to be the
case on Java 1.7+.

Modifications
-------------
Specific null and empty checks have been added to make the method more robust.

Result
------
NPEs are not raised anymore and also empty strings are checked much quicker. Test
cases have been added to verify functionality.

Side note: An exception like this was reported on empty strings, but could not be
verified with Java 1.7 onward. It is suspected that this changeset also fixes
the issue given the input type and code process:

Original Exception: java.lang.StringIndexOutOfBoundsException: String index out of range: 0
Stack trace:
java.lang.String.charAt(String.java:658)
java.util.regex.Pattern$BmpCharProperty.match(Pattern.java:3715)
java.util.regex.Pattern$Ques.match(Pattern.java:4079)
java.util.regex.Pattern$Begin.match(Pattern.java:3472)
java.util.regex.Matcher.match(Matcher.java:1221)
java.util.regex.Matcher.matches(Matcher.java:559)
net.spy.memcached.util.StringUtils.isJsonObject(StringUtils.java:109)
net.spy.memcached.transcoders.SerializingTranscoder.encode(Seriali
...

Change-Id: Icaca2f3fef658cdb2c376b6b4dba12ae0327f240",0,0,0,0,0,1,1,0,0,
36698,I6269a1d7fb756855f94caa2fe0495133fe1a83b0,http://review.couchbase.org/#/c/36698,3,2467045f492a72b1fe945ee729e2b5795da3f4d1,30f9c67cdd482a25277194773cbe4ff57c8931e0,1,05/05/14,07/05/14,31,SPY-169: Also clone observe calls on redistribute.,"SPY-169: Also clone observe calls on redistribute.

Motivation
----------
Observe calls also need to be cloned when redistributed, for example if a socket
gets closed or the op stil waits for an auth latch.

Modifications
-------------
The observe operation now gets cloned similar to get, gets and so on.

Result
------
No assert error is raised if an observe needs to be cloned.

Change-Id: I6269a1d7fb756855f94caa2fe0495133fe1a83b0",0,0,0,0,0,1,1,0,0,
37603,I09729af78bd241ff8dcb0869992d3ff474fb6ec1,http://review.couchbase.org/#/c/37603,3,30f9c67cdd482a25277194773cbe4ff57c8931e0,1c3e6292644c7c8aa5e3bd435661818adf040ae2,1,27/05/14,02/06/14,10,SPY-170: Fix concurrency issue in StringUtils.isJSONObject(),"SPY-170: Fix concurrency issue in StringUtils.isJSONObject()

Motivation
----------
A concurrency issue was reported in the StringUtils class, pointint towards
the pattern matching of the JSON string.

Modifications
-------------
It turned out that the matcher is not thread safe and there is a race condition
between clearing it and then maching on it. By falling back to the thread-safe
builder directly the race condition goes away.

Result
------
No concurrency issue anymore in the helper method.

Change-Id: I09729af78bd241ff8dcb0869992d3ff474fb6ec1",0,0,0,0,0,1,1,0,0,
37646,I39e47408319f8adf3b2875a4a730232ecadeafe2,http://review.couchbase.org/#/c/37646,2,eddc90a8a55eeb67762811874cc9eb58e22a7306,983813f1f6511a0e6e8bbef5cc671b681cecc76f,1,28/05/14,02/06/14,6,SPY-134: Make sure lastReadTimestamp is concurrency safe.,"SPY-134: Make sure lastReadTimestamp is concurrency safe.

Motivation
----------
When the last read timestamp is read from each node, there has been some
suspicion that the (sometimes very long) reported times are flawed.

Tracking it down further, it was discovered that the timestamp was potentially
accessed by two or more threads, but not volatile.

Modifications
-------------
This changeset makes the timstamp volatile and also uses nanoTime instead
of currentTimeMillis for better accuracy.

Result
------
Since the timestamp is now thread safe, the actual value will now be shown
to the user.

Change-Id: I39e47408319f8adf3b2875a4a730232ecadeafe2",0,0,0,0,0,1,1,0,0,
37647,I13ef691dd435f397dc9d5f08ff40a28202d3ddb7,http://review.couchbase.org/#/c/37647,3,cd8ba8a0fc51cd60b3b931d7193bb4ecbbd147e7,07b248e9744cd5ac5576d43fb783b9a7dfec621c,1,28/05/14,02/06/14,2,Move superfluous log message from info to debug.,"Move superfluous log message from info to debug.

Motivation
----------
In every log when connecting, a message like this shows up:

INFO [Memcached IO over {MemcachedConnection to ...}] (?:?) - Connection state changed for sun.nio.ch.SelectionKeyImpl@...

This message is superfluous since it does not provide any addition information to the user, especially not at INFO level.

Modifications
-------------
The message has been moved to DEBUG level so that users are not wondering what it means and also to streamline the log a bit.

Result
------
Easier log output to read and analyze for the user.

Change-Id: I13ef691dd435f397dc9d5f08ff40a28202d3ddb7",0,0,0,0,0,1,1,0,0,
37724,I99f3effbbb20a78a2705ee7f3f839e9753fb2a4a,http://review.couchbase.org/#/c/37724,4,b26e7ce1cdd245b58d10c0f5e3448da0f8e539e7,b9762a42f6bdeab602443a9765b2fa44d7c6b8d7,1,02/06/14,04/06/14,32,SPY-171: More robust shutdown handling characteristics.,"SPY-171: More robust shutdown handling characteristics.

Motivation
----------
It has been reported several times that the IO thread kept lingering
around even after a shutdown() call.

Modifications
-------------
Since its run() method is kept alive by the ""running"" variable, the
code now makes sure to always set it to false, even if an exception
occurs during the connection shutdown process.

Also, a slightly misleading IOException has been removed in favor of
just silently moving on if shutdown is in progress.

Result
------
More stable and predictable shutdown behavior.

Change-Id: I99f3effbbb20a78a2705ee7f3f839e9753fb2a4a",0,1,0,0,0,1,1,0,0,
37725,I43ea722b8a4fc28be4f997674ea85f73f2c66a50,http://review.couchbase.org/#/c/37725,8,647a3cd79ef21d68e06418e23cb050c1d8c191d8,e43e8146d360960aac6792e67a1a9be1301725b5,1,02/06/14,04/06/14,115,WIP: Wakeup selector if idle.,"WIP: Wakeup selector if idle.

Change-Id: I43ea722b8a4fc28be4f997674ea85f73f2c66a50",0,1,0,1,0,1,1,0,0,
37839,I82f55e8cef10c30bac785389b8d3c23d57553206,http://review.couchbase.org/#/c/37839,2,e43e8146d360960aac6792e67a1a9be1301725b5,90420f1d79202ab2bb3725e6a0d569df6dc7b438,1,04/06/14,04/06/14,2,SPY-172: Addition - test case fix.,"SPY-172: Addition - test case fix.

Just fixed the port.

Change-Id: I82f55e8cef10c30bac785389b8d3c23d57553206",1,0,0,0,0,0,1,0,0,
38358,I511a8e5ec6e8fe50168337a4b9bbddf2360bd365,http://review.couchbase.org/#/c/38358,2,723de42dc10bfec66c262bcfe169d8e8c0862cf7,cce23383341d433977b7483afde8f6354af50bac,0,17/06/14,17/06/14,8,SPY-174: Make sure MultiOperationCallback is threadsafe,"SPY-174: Make sure MultiOperationCallback is threadsafe

First, special thanks goes to @exortech for reporting and fixing the issue
here: https://github.com/dustin/java-memcached-client/pull/9

Motivation
----------
Certain operations like the multi get callback rely on the multi operation
callback which has a non-thread safe component to it.

Modification
------------
Make the callback atomic and thread safe.

Result
------
No race conditions with bulk get operation callbacks.

Change-Id: I511a8e5ec6e8fe50168337a4b9bbddf2360bd365",1,0,0,0,0,0,1,NA,NA,
38359,I9b90aab0b54a2ae7d2c262d499ff47482b9d6c6c,http://review.couchbase.org/#/c/38359,2,e588e2976fa5d39ef54e146f87462f57b31c676f,ff39b55c47183c5b29dcfcb32205e4c3cb479867,0,17/06/14,17/06/14,59,SPY-175: Reduce memory use in binary GET,"SPY-175: Reduce memory use in binary GET

Change-Id: I9b90aab0b54a2ae7d2c262d499ff47482b9d6c6c",1,0,0,1,0,0,1,NA,NA,
38669,Icbc5f9e4f568ea885500e8d2baedfa989c8ef801,http://review.couchbase.org/#/c/38669,3,ff39b55c47183c5b29dcfcb32205e4c3cb479867,95497a037590923ba25c647eba736ae1dccd3673,1,23/06/14,24/06/14,9,SPY-176: Enhance redistribution logic and avoid possible deadlocks.,"SPY-176: Enhance redistribution logic and avoid possible deadlocks.

Motivation
----------
There have been issues reported that redistribution of operations does
not work as expected, especially with authentication scenarios. This
has been tracked down and the following changes have been made:

Modifications
-------------

	- With the old redistribute logic, it could happen that subsequend
	  ops in the retry queue got accidentially deleted. With the copy
	  first, this cannot happen anymore.
	- On redistribute, if the handling node is still not set, just
	  clone the operation to avoid NPEs. A op without a node set
	  can happen if it is enqueued to retry because the target node
	  is not yet authenticated.
	- Do not try to add operations to a node which is not yet authen
	  ticated. This can lead to costly locks whith redistributions since
	  they are run from the IO thread. Without the change, it can happen
	  that the IO thread waits for an auth latch, but is also responsible
	  for telling listeners when auth has completed, therefore
	  locking everything up until the auth latch wait runs out of time.

Result
------
Much better resilience and performance with redistributions, especially
if authentication takes longer than expected and from scenarios where the
operations get redistributed/moved around from within the IO thread.

Change-Id: Icbc5f9e4f568ea885500e8d2baedfa989c8ef801",0,0,0,0,0,1,1,0,0,
42925,I0c976344d0f8e09bc041d94f3544620ef4fb3117,http://review.couchbase.org/#/c/42925,2,9dcaab23647963a2e331b8cae62f85b3588fa607,a409cb130e9f1ca5fd218e4efccfd62bbe45b685,1,07/11/14,21/11/14,2,"SPY-179: Reconnect has wrong ceiling, leading to very long reconnect delays.","SPY-179: Reconnect has wrong ceiling, leading to very long reconnect delays.

Motivation
----------
This is a regression which was introduced through the change in SPY-158
(https://github.com/couchbase/spymemcached/commit/bfaec2b4f1385f20f32fd0ed0736b52ef572e340).

Because the time is now converted to millis right away, but the comparison checks with the 2^n
still converted to seconds. That way, even with a very high N it is smaller than the default of
30k.

Modifications
-------------
The code now correctly converts the 2^n to milliseconds before comparing it, making it a comparison
on the same unit of time again.

Result
------
The ceiling is now properly respected and as a result, reconnect delays are properly capped at
their defined maximum.

Change-Id: I0c976344d0f8e09bc041d94f3544620ef4fb3117",0,0,1,0,0,1,1,0,0,
43040,I6e7f09892687b8896c9b295a94fb473857ec212f,http://review.couchbase.org/#/c/43040,2,25d3e3bab4b8a687dbac551f8f8c62d141729d46,d3d3fa1b21f3d5a08a4fbe0eaa6c1fccc7116123,1,10/11/14,10/11/14,10,SPY-178: KetamaNodeLocator#getReadonlyCopy uses unsafe operations.,"SPY-178: KetamaNodeLocator#getReadonlyCopy uses unsafe operations.

Motivation
----------
Users reported java.lang.UnsupportedOperationException when using the
KetamaNodeLocator#getReadonlyCopy() method. It turns out the error
only shows up when the JVM is run with the -XX:+AggressiveOpts flag.

Modifications
-------------
Changing the iterator to properly update the TreeMap while iterating
fixes the problem.

Result
------
Correct behavior for KetamaNodeLocator#getReadonlyCopy(), even when
the -XX:+AggressiveOpts flag is enabled.

Change-Id: I6e7f09892687b8896c9b295a94fb473857ec212f",0,0,0,0,0,1,1,0,0,
44144,I9ae2d71ae7d3fe899bce8ec8200e215aa987400d,http://review.couchbase.org/#/c/44144,4,12c4d522e5d358b05645b55ec6f4ed3a2288c43b,777fb49022cb8e801ed6477fbf92256b007c3a8a,1,09/12/14,10/12/14,34,The Spring factory bean was marked as a singleton but was creating a new instance with every call to getObject(). I created an instance holder so the same reference is returned every time. This also allows the class to expose a shutdown method to appropriately shut down the client when the spring context is destroyed.,"The Spring factory bean was marked as a singleton but was creating a new instance with every call to getObject(). I created an instance holder so the same reference is returned every time. This also allows the class to expose a shutdown method to appropriately shut down the client when the spring context is destroyed.

Change-Id: I9ae2d71ae7d3fe899bce8ec8200e215aa987400d",0,1,0,1,0,0,1,0,0,
44565,I49b3efc741ab4fe5780bf74ad5f99b839c9ceb7d,http://review.couchbase.org/#/c/44565,3,3474b83b90eedf93770e3b64490d8a18b8b60cdf,de31bc0cdb1ca9d96bfcbcd09edc70a632c6a7d6,1,21/12/14,09/01/15,34,MemcachedNodeROImpl public such as custom NodeLocator can use it. BaseGetOpImpl becomes public. Extra abstraction in BaseGetOpImpl::initialization to ease reuse of the class.,"MemcachedNodeROImpl public such as custom NodeLocator can use it.
BaseGetOpImpl becomes public.
Extra abstraction in BaseGetOpImpl::initialization to ease reuse of the class.

Change-Id: I49b3efc741ab4fe5780bf74ad5f99b839c9ceb7d",0,0,0,1,0,0,1,0,0,
45129,I7f4fdad62af71a42cc203b2a4b7e72f2002a286d,http://review.couchbase.org/#/c/45129,2,681773dc9d63ab3000a2122bb48876b7c66a73f7,6f93ec028a40253fca2938504bd7c0219e16febd,1,09/01/15,09/01/15,23,SPY-181: GetAndLock needs to be cloneable like any other keyed op.,"SPY-181: GetAndLock needs to be cloneable like any other keyed op.

Motivation
----------
In case a getAndLock operation needs to be rescheduled, it needs to
be cloneable (like any other keyed operation).

Modifications
-------------
Apply the same clone logic as with any other keyed operation. Also
added getter methods to the operations so that the expiration time
can be extracted on cloning.

Result
------
Correct behavior when a getAndLock op needs to be cloned.

Change-Id: I7f4fdad62af71a42cc203b2a4b7e72f2002a286d",0,0,0,0,0,1,1,0,0,
45131,I3643d5e0bfc7474889279d0f8362f287624b89a3,http://review.couchbase.org/#/c/45131,2,fcefd983525e520a5ba0b62a888fadf6012855e6,3428829af6989254330fa287a76cfa3cada3ac75,1,09/01/15,09/01/15,9,SPY-182: Avoid WARN logging when handling node not set.,"SPY-182: Avoid WARN logging when handling node not set.

Motivation
----------
The main purpose of setting a continous timeout on a node is to
properly reconnect when the threshold is reached. Now if auth
has not happened yet, it could be that ops do not have a handling
node set yet.

In those cases, it doesn't make any sense to increase the counter,
so it should be ignored. This also has the side effect of not logging
warnings to the user which have no impact for him.

Modifications
-------------
Ignore the operation when its handling node is not set.

Result
------
No unnecessary warnings printed to the user.

Change-Id: I3643d5e0bfc7474889279d0f8362f287624b89a3",0,0,0,0,0,1,1,0,0,
45554,I483c045451f90ff3ed01d00db7e912e7d2484b64,http://review.couchbase.org/#/c/45554,2,2449b132a5d91c65dacb5cc945fefed7baca5a9f,a6170cff5d7fea21c87ab85a181ec6eb18c409e0,1,19/01/15,19/01/15,2,Fix spring unit tests.,"Fix spring unit tests.

Motivation
----------
afterPropertiesSet() needs to be called on the factory to actually
create the client so that it does not result in a NPE.

Change-Id: I483c045451f90ff3ed01d00db7e912e7d2484b64",0,0,0,0,0,0,0,0,0,
47624,I0263b9afc513f9a135d5d17318b3fe6bd4593437,http://review.couchbase.org/#/c/47624,7,a6170cff5d7fea21c87ab85a181ec6eb18c409e0,bbb772a66ec23c1ee7cffce8f65a366e54883422,1,03/03/15,19/05/15,923,Support Libmemcached ketama weighted,"Support Libmemcached ketama weighted

- Add support for alternative Ketama Node key format

  Libmemcached uses the format for `[hostname or ip][port unless
  default]-[repetition]` while spymemcached has been using
  `[hostname]/[ip]:[port]-[repetition]` the added `KetamaNodeKeyFormat`
  allows to choose either format while retaining the caching
  optimization.

- Add support for weighted ketama
  Straight port of the weighting based on Libmemcached, configured via
  passing a map of node socketaddress to weight to the configuration.
  This code is only active if the weight is actually configured
  otherwise the old ketama code is used.

Change-Id: I0263b9afc513f9a135d5d17318b3fe6bd4593437",0,1,0,0,1,0,1,2,1,
48076,Iad343b4dbdcd5dfd4d9ec53bf5335dcf4775f9c9,http://review.couchbase.org/#/c/48076,2,02044d4ea5113d97b3beb9f23a92458376ce26bc,8799c71ba99f90127f97f4f65d52b1e82c837f30,1,11/03/15,11/03/15,86,SPY-183: Allow touch operations to be cloned.,"SPY-183: Allow touch operations to be cloned.

Motivation
----------
In case a touch  operation needs to be rescheduled, it needs to
be cloneable (like any other keyed operation).

Modifications
-------------
Apply the same clone logic as with any other keyed operation. Also
added getter methods to the operations so that the expiration time
can be extracted on cloning.

Result
------
Correct behavior when a touch op needs to be cloned.

Change-Id: Iad343b4dbdcd5dfd4d9ec53bf5335dcf4775f9c9",0,0,0,0,0,1,1,0,0,
51546,I81932da64d4492512dcf1a11fe1161203fa70c5e,http://review.couchbase.org/#/c/51546,3,7f4be454c02ca115cee510e65dfba0f772dddd13,bb27f0015c7701c37c2e57ca09d8bf3bd0fd30fd,1,29/05/15,11/06/15,79,Expose a few more attributes of MemcachedClient,"Expose a few more attributes of MemcachedClient

Motivation
----------
Extending MemcachedClient to access some of its protected attributes is
not always desirable as it makes harder writing mocks for unit testing.

Modifications
-------------
MemcachedClient and its main interface now expose operationTimeout,
mconn, tcService and executorService.

Result
------
One does not have to extend MemcachedClient any more to write custom
commands.

Change-Id: I81932da64d4492512dcf1a11fe1161203fa70c5e",0,0,0,0,0,0,0,0,0,
58266,Iaf63f8a246c45e9ed9ebfe9c4239043cbe9e2039,http://review.couchbase.org/#/c/58266,3,bb27f0015c7701c37c2e57ca09d8bf3bd0fd30fd,bbdf6944633ef59081e68f556f7789568be45704,1,05/01/16,13/01/16,8,Remove the no-operation isInterrupted() call. Document interruption policy.,"Remove the no-operation isInterrupted() call. Document interruption policy.

Change-Id: Iaf63f8a246c45e9ed9ebfe9c4239043cbe9e2039",0,0,1,1,0,0,1,0,0,
61927,Idf392d146d30b2e96dc198a93a3cc6598dae3fc6,http://review.couchbase.org/#/c/61927,3,bbdf6944633ef59081e68f556f7789568be45704,fc64085e78efb661a3c23775163c22e28ee2560d,1,24/03/16,04/04/16,24,SPY-191: Don't force reconnect on E2BIG with binary protocol.,"SPY-191: Don't force reconnect on E2BIG with binary protocol.

Motivation
----------
In the current codebase, a socket is forcefully reset when the server
returns an E2BIG response, that is when the document is larger than the
possible value size.

Modifications
-------------
While this needs to be done on the ASCII protocol, doing so is not needed
with binary protocol and can be considered a bug/leftover.

The code is modified so that E2BIG just translates into a non-success response
like any other error and the proper error code identifies the cause.

The test cases have been modified for binary to reflect the change.

Result
------
Do not force reconnect / treat the issue as a server error on the binary
protocol - the ASCII protocol is unaffected.

Change-Id: Idf392d146d30b2e96dc198a93a3cc6598dae3fc6",0,0,0,0,0,1,1,0,0,
69938,I86452ef8dcddcf2c4acfc065fd9db94510665ac3,http://review.couchbase.org/#/c/69938,4,c8a2a24eeca0324524757f56abcb5cf4bd4fd24b,0a455eff7a97d6f1ea23fed209dbb90215d84a5c,1,16/11/16,07/04/17,25,SPY-XXX: Allow to optionally bound retry queue,"SPY-XXX: Allow to optionally bound retry queue

Change-Id: I86452ef8dcddcf2c4acfc065fd9db94510665ac3",0,1,0,1,0,0,1,0,0,
72270,Ic0db65f9c7ccc3a7b9738aaff0e3c7e60d7f25c2,http://review.couchbase.org/#/c/72270,3,ff4a79f4e899b18db94dbc7ed7bb96a368d66b4d,d337fef7747cfcbb8f385b3a02a614deda074c5c,1,20/01/17,01/02/17,17,Ensure connection key is valid before checking if writable,"Ensure connection key is valid before checking if writable

Change-Id: Ic0db65f9c7ccc3a7b9738aaff0e3c7e60d7f25c2",0,0,0,1,0,0,1,0,0,
75116,If1273cb560d49ea2c9c42b7c7b70c84fd9aeebdc,http://review.couchbase.org/#/c/75116,2,d337fef7747cfcbb8f385b3a02a614deda074c5c,a817c364929f9f1fe72b53e92d92a3ad7ecf712e,1,14/03/17,14/03/17,4,SPY-193: Allow to override wakeupDelay,"SPY-193: Allow to override wakeupDelay

Motivation
----------
As part of SPY-172, a new wakeupDelay setting has been introduced,
but as part of a mistake it has never been used to actually set
the wakeup time, which is still hardcoded to 1000.

Modifications
-------------
This simple change modifies the code so it accepts the wakeupDelay
setting, still having the default at 1000 but making it possible
to override it through the system property.

Result
------
The wakeupDelay can now be configured via a system property.

Change-Id: If1273cb560d49ea2c9c42b7c7b70c84fd9aeebdc",0,0,0,0,0,1,1,0,0,
76567,I3c8bb70cfaa9f47eb790f2eb150bacca2ce839b6,http://review.couchbase.org/#/c/76567,3,3444d710bff90a2297a02322d4c92b095ee88ba1,ff4405bc43762b37ed3fb029ae99674288fc85e8,1,10/04/17,10/04/17,4,SPY-195: Defer String Concat in handleEmptySelects(),"SPY-195: Defer String Concat in handleEmptySelects()

MemcachedConnection.handleEmptySelects() has a debug level log
statement that doesn't correctly defer the concatentation of
the argument until it has determined that the level is enabled.

Change-Id: I3c8bb70cfaa9f47eb790f2eb150bacca2ce839b6",1,0,0,0,0,0,1,0,0,
81810,Ic561f87fe262782a607e86ac8b2e0efb69d2c46e,http://review.couchbase.org/#/c/81810,2,ff4405bc43762b37ed3fb029ae99674288fc85e8,f3678f92b0ded014c333f6779d482fd05e66e6cc,1,03/08/17,03/08/17,38,Add support for turning on tcp keep alive.,"Add support for turning on tcp keep alive.

Change-Id: Ic561f87fe262782a607e86ac8b2e0efb69d2c46e",1,0,0,1,0,0,1,0,0,